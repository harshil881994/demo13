2023-11-16 08:59:47.054 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, with SITE_IDS as(select unnest('{63635,69853,74937589}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[1100997] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:47.055 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 39ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:47.055 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 1100997
2023-11-16 08:59:47.098 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_248170
2023-11-16 08:59:47.098 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_248170
2023-11-16 08:59:47.098 DEBUG 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.124  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 158224
2023-11-16 08:59:47.124  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:639]: No Data found for Sending Supplier Impact Notification for event_details_id : 99446
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_158224] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158224, Took : 4s
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 200401 
2023-11-16 08:59:47.125  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:47.127 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 1ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:47.130 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, with SITEID as( select * from ( select unnest(array[7122092,7143028]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:47.130 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 32ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:47.134 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_248170
2023-11-16 08:59:47.134 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 35ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_248170
2023-11-16 08:59:47.140 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_1210151
2023-11-16 08:59:47.140 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_1210151
2023-11-16 08:59:47.140 DEBUG 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.144 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_248170
2023-11-16 08:59:47.144 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 10ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:47.144 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 248170 
2023-11-16 08:59:47.144  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 248170
2023-11-16 08:59:47.186 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, with SITEID as( select * from ( select unnest(array[87258003,87258183,87258005,87258212,87257753,87258248,87257983]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:47.187 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 46ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:47.190 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1210151
2023-11-16 08:59:47.190 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 49ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1210151
2023-11-16 08:59:47.198 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_1210151
2023-11-16 08:59:47.199 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 8ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:47.199 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 1210151 
2023-11-16 08:59:47.199  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 1210151
2023-11-16 08:59:47.218 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:?] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 248170 
2023-11-16 08:59:47.223 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:47.223 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 248170 
2023-11-16 08:59:47.232 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 248170
2023-11-16 08:59:47.265 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 138ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:47.265 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.266 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 1210151 
2023-11-16 08:59:47.271 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:47.271 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 1210151 
2023-11-16 08:59:47.280 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 1210151
2023-11-16 08:59:47.286 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [20, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 200401 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 200401), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =200401 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{1162834}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 200401 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:47.288 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 22ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:47.288 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 200401 
2023-11-16 08:59:47.288 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.309 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_1100997
2023-11-16 08:59:47.309 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 5ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_1100997
2023-11-16 08:59:47.309 DEBUG 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.312 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [23, with SITE_IDS as ( select unnest('{1162834}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 200401 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:47.314 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [?:?] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 200401
2023-11-16 08:59:47.314 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 25ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:47.336 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [26, with SITEID as( select * from ( select unnest(array[74937589,63635,69853]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:47.336 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 27ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:47.340 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1100997
2023-11-16 08:59:47.340 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 31ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1100997
2023-11-16 08:59:47.352 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_1100997
2023-11-16 08:59:47.352 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 11ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:47.352 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 1100997 
2023-11-16 08:59:47.352  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 1100997
2023-11-16 08:59:47.410 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 1100997 
2023-11-16 08:59:47.416 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:47.416 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 1100997 
2023-11-16 08:59:47.427 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 1100997
2023-11-16 08:59:47.435 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 200401, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:47.435 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868338 and EventDetID : 99446 
2023-11-16 08:59:47.435 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 200401
2023-11-16 08:59:47.435 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868338
2023-11-16 08:59:47.435 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:47.436 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868338 and Event_Details ID : 99446 
2023-11-16 08:59:47.436 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:47.436 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:47.436 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:47.440 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 200401 -- Resulted rows -- [1]
2023-11-16 08:59:47.440 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:47.440 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 200401 : false : false : 19868338 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:47.443 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 200401
2023-11-16 08:59:47.443 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:47.443 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 200401
2023-11-16 08:59:47.444 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 200401
2023-11-16 08:59:47.444  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 200401
2023-11-16 08:59:47.444 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 200401 
2023-11-16 08:59:47.444 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 200401 
2023-11-16 08:59:47.444 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.477 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (200401,553693) and event_details_id = 99446] 
2023-11-16 08:59:47.480 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_200401
2023-11-16 08:59:47.480 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 200401
2023-11-16 08:59:47.480 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 36ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:47.480  INFO 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [200401]
2023-11-16 08:59:47.482  INFO 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [200401]
2023-11-16 08:59:47.482 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 200401 
2023-11-16 08:59:47.482 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 200401 
2023-11-16 08:59:47.482 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.519 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 200401 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (1162834)] 
2023-11-16 08:59:47.521 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 200401
2023-11-16 08:59:47.521 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 38ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:47.573 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.612 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, WITH SITE_IDS AS( SELECT UNNEST('{1162834}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[200401] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 200401 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:47.613 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 39ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:47.613 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 200401 
2023-11-16 08:59:47.649 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 248170
2023-11-16 08:59:47.651  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 248170
2023-11-16 08:59:47.651 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 248170 
2023-11-16 08:59:47.651 DEBUG 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.671 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [19, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 248170 and es.event_id = 19868336 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:47.671 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 20ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:47.675 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_248170
2023-11-16 08:59:47.675 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_248170
2023-11-16 08:59:47.678 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:47.679 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 248170 
2023-11-16 08:59:47.736 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 200401
2023-11-16 08:59:47.736 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 122ms : for accumlator : {}
2023-11-16 08:59:47.736 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 200401 
2023-11-16 08:59:47.741 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_200401
2023-11-16 08:59:47.741 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_200401
2023-11-16 08:59:47.741 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.744  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 248170
2023-11-16 08:59:47.744 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 248170 
2023-11-16 08:59:47.752 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 248170 
2023-11-16 08:59:47.752  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:47.752 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 248170 
2023-11-16 08:59:47.752 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 248170
2023-11-16 08:59:47.754 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [?:?] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 1210151
2023-11-16 08:59:47.754  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 1210151
2023-11-16 08:59:47.754 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 1210151 
2023-11-16 08:59:47.754 DEBUG 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.765 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [24, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 200401 and total_cpns != '{}' and site_private_id = any('{25288735}')] 
2023-11-16 08:59:47.770 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_200401
2023-11-16 08:59:47.771 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 29ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:47.771 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.796 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[114304, 160645, 140357, 135732, 114303, 114302, 224514, 160901]
2023-11-16 08:59:47.796 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 44ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:47.797 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 8 for customer 248170
2023-11-16 08:59:47.797 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[114304, 160645, 140357, 135732, 114303, 114302, 224514, 160901]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}248170
2023-11-16 08:59:47.804 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[114304, 160645, 140357, 135732, 114303, 114302, 224514, 160901]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}248170
2023-11-16 08:59:47.804 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 7ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:47.804 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 248170 99446 user with No pref [114304, 160645, 140357, 135732, 114303, 114302, 224514, 160901]
2023-11-16 08:59:47.806 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:47.806 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 248170 99446 [107352, 114301, 114305, 114307, 196370, 204769, 204770]
2023-11-16 08:59:47.806 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  248170 99446 
2023-11-16 08:59:47.806 DEBUG 1 --- [     Thread-395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 248170 99446 [107352, 114301, 114305, 114307, 196370, 204769, 204770]
2023-11-16 08:59:47.807 DEBUG 1 --- [     Thread-395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 248170 99446 [107352, 114301, 114305, 114307, 196370, 204769, 204770]
2023-11-16 08:59:47.808 DEBUG 1 --- [     Thread-395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 1ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:47.808 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  248170 99446 
2023-11-16 08:59:47.808 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:47.808 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 248170 99446 [114305, 196370, 204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.810 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [55, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 1210151 and es.event_id = 19868337 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:47.810 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 248170 99446 [114305, 196370, 204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.810 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 1ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:47.810 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 55ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:47.810 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 248170 99446 [114305, 196370, 204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.814 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 248170 99446 [204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.814 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 3ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:47.814 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 248170 99446 [204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.814 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 248170 99446 [204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.814 DEBUG 1 --- [     Thread-394] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:47.815 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 248170 and eventId 99446 and userIds [204770, 114307, 204769, 107352, 114301]
2023-11-16 08:59:47.815 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 248170 and eventId : 99446 
2023-11-16 08:59:47.815 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:47.815 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_1210151
2023-11-16 08:59:47.815 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 4ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_1210151
2023-11-16 08:59:47.819 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [?:?] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:47.819 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 1210151 
2023-11-16 08:59:47.820 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 5
2023-11-16 08:59:47.820 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 5ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:47.820 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 248170 99446
2023-11-16 08:59:47.821 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 248170
2023-11-16 08:59:47.821  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 248170
2023-11-16 08:59:47.821 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:47.821 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [248170] 
2023-11-16 08:59:47.823 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:47.823 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [52, with SITEID as( select * from ( select unnest(array[25288735]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:47.823 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:47.823  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 248170, isUpdateAlert : true
2023-11-16 08:59:47.823  INFO 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:47.823 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 52ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:47.824 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [?:?] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:47.824  INFO 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:47.825 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"2579a7a6-06d3-49f1-ad65-77f6bdb0dc92","eventId":19868336,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:47.827  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868336, tenantId : 248170
2023-11-16 08:59:47.827 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"2579a7a6-06d3-49f1-ad65-77f6bdb0dc92","eventId":19868336,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41788
2023-11-16 08:59:47.827  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:47.827  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [6090, 249470] 
2023-11-16 08:59:47.827 DEBUG 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.828 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_200401
2023-11-16 08:59:47.828 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 57ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_200401
2023-11-16 08:59:47.841 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_200401
2023-11-16 08:59:47.841 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 12ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:47.841 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 200401
2023-11-16 08:59:47.850 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 200401 
2023-11-16 08:59:47.850 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 200401 
2023-11-16 08:59:47.850 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 200401 
2023-11-16 08:59:47.850 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.869 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (6090,249470)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:47.869 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 42ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:47.886  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 1210151
2023-11-16 08:59:47.887 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1210151 
2023-11-16 08:59:47.894 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1210151 
2023-11-16 08:59:47.894  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:47.894 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 1210151 
2023-11-16 08:59:47.894 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 1210151
2023-11-16 08:59:47.897 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868338 and tenant_id = 200401] 
2023-11-16 08:59:47.898 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 47ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:47.911 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[262755, 289392, 289403, 231459, 205317, 289396, 296195, 289406, 232970, 296411, 289394, 296409, 237057, 288713, 296410, 288712, 292821, 196426, 289400, 289398, 289399, 289405, 292822, 280592, 288714, 289395, 289393, 289387, 289397, 289388, 231458, 289386, 289402, 301283, 289391, 301104, 194152, 289401]
2023-11-16 08:59:47.911 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 16ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:47.911 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 38 for customer 1210151
2023-11-16 08:59:47.911 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[262755, 289392, 289403, 231459, 205317, 289396, 296195, 289406, 232970, 296411, 289394, 296409, 237057, 288713, 296410, 288712, 292821, 196426, 289400, 289398, 289399, 289405, 292822, 280592, 288714, 289395, 289393, 289387, 289397, 289388, 231458, 289386, 289402, 301283, 289391, 301104, 194152, 289401]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1210151
2023-11-16 08:59:47.935 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[262755, 289392, 289403, 231459, 205317, 289396, 296195, 289406, 232970, 296411, 289394, 296409, 237057, 288713, 296410, 288712, 292821, 196426, 289400, 289398, 289399, 289405, 292822, 280592, 288714, 289395, 289393, 289387, 289397, 289388, 231458, 289386, 289402, 301283, 289391, 301104, 194152, 289401]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1210151
2023-11-16 08:59:47.936 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 24ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:47.936 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 1210151 99446 user with No pref [262755, 289392, 289403, 231459, 205317, 289396, 296195, 289406, 232970, 296411, 289394, 296409, 237057, 288713, 296410, 288712, 292821, 196426, 289400, 289398, 289399, 289405, 292822, 280592, 288714, 289395, 289393, 289387, 289397, 289388, 231458, 289386, 289402, 301283, 289391, 301104, 194152, 289401]
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1008]: no user found with pref for this tenant Id 1210151 and eventId 99446
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 1210151 99446
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 1210151
2023-11-16 08:59:47.938  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 1210151
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:47.938 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1210151] 
2023-11-16 08:59:47.941 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:47.941 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:47.941  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 1210151, isUpdateAlert : true
2023-11-16 08:59:47.941  INFO 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:47.942 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:47.942  INFO 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:47.942 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"f26276bb-86b9-4b10-80aa-a0d29dda4b0c","eventId":19868337,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:47.945  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868337, tenantId : 1210151
2023-11-16 08:59:47.945 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"f26276bb-86b9-4b10-80aa-a0d29dda4b0c","eventId":19868337,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41789
2023-11-16 08:59:47.945  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:47.945  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [304, 342, 308] 
2023-11-16 08:59:47.945 DEBUG 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.953 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_200401
2023-11-16 08:59:47.953 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 6ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_200401
2023-11-16 08:59:47.959 DEBUG 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.976 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_200401
2023-11-16 08:59:47.976 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 22ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:47.979 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 1100997
2023-11-16 08:59:47.980  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 1100997
2023-11-16 08:59:47.980 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 1100997 
2023-11-16 08:59:47.980 DEBUG 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:47.981 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (304,342,308)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:47.982 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 36ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:47.989 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 13ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:47.990 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 200401 
2023-11-16 08:59:47.994 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [34, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (6090,249470)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:47.995 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 35ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:48.000 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_248170
2023-11-16 08:59:48.000 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 5ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_248170
2023-11-16 08:59:48.005 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_248170
2023-11-16 08:59:48.005 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_248170
2023-11-16 08:59:48.012 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 7ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:48.020 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 1100997 and es.event_id = 19868334 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:48.020 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [?:?] : [createECPNDsForUpdate:1743]: Time taken : 39ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:48.026 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_1100997
2023-11-16 08:59:48.026 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 5ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_1100997
2023-11-16 08:59:48.029 DEBUG 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.031 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 4ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:48.031 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 1100997 
2023-11-16 08:59:48.047 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [18, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (304,342,308)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:48.048 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 19ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:48.053 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1210151
2023-11-16 08:59:48.053 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1210151
2023-11-16 08:59:48.057 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1210151
2023-11-16 08:59:48.057 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 3ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1210151
2023-11-16 08:59:48.063 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 6ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:48.087  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 1100997
2023-11-16 08:59:48.087 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1100997 
2023-11-16 08:59:48.095 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1100997 
2023-11-16 08:59:48.095  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:48.095 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 1100997 
2023-11-16 08:59:48.095 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 1100997
2023-11-16 08:59:48.112 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[182265, 267433, 205317, 267432, 132982, 262755]
2023-11-16 08:59:48.112 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 16ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:48.112 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 6 for customer 1100997
2023-11-16 08:59:48.112 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[182265, 267433, 205317, 267432, 132982, 262755]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1100997
2023-11-16 08:59:48.123 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[182265, 267433, 205317, 267432, 132982, 262755]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1100997
2023-11-16 08:59:48.123 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 11ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:48.123 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 1100997 99446 user with No pref [182265, 267433, 205317, 267432, 132982, 262755]
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1008]: no user found with pref for this tenant Id 1100997 and eventId 99446
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 1100997 99446
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 1100997
2023-11-16 08:59:48.125  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 1100997
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:48.125 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1100997] 
2023-11-16 08:59:48.128 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:48.128 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:48.129  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 1100997, isUpdateAlert : true
2023-11-16 08:59:48.129  INFO 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:48.130 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:48.130  INFO 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:48.130 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"1dd114ec-141e-4177-8b55-62c9be0bbd12","eventId":19868334,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:48.133  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868334, tenantId : 1100997
2023-11-16 08:59:48.133 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"1dd114ec-141e-4177-8b55-62c9be0bbd12","eventId":19868334,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41790
2023-11-16 08:59:48.133  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:48.133  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [1123155] 
2023-11-16 08:59:48.133 DEBUG 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.152  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 248170
2023-11-16 08:59:48.152 DEBUG 1 --- [6_103335_248170] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.177 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (1123155)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:48.178 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 44ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:48.189 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (6090,249470) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:48.193 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_248170
2023-11-16 08:59:48.193 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 41ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:48.197 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:48.312  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 1210151
2023-11-16 08:59:48.312 DEBUG 1 --- [_103335_1210151] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.322 DEBUG 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.347 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [24, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (1123155)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:48.347 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 25ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:48.351 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1100997
2023-11-16 08:59:48.351 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1100997
2023-11-16 08:59:48.355 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1100997
2023-11-16 08:59:48.355 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1100997
2023-11-16 08:59:48.356 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (304,342,308) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:48.360 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:48.360 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_1210151
2023-11-16 08:59:48.360 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 47ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:48.363 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:48.560  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 1100997
2023-11-16 08:59:48.560 DEBUG 1 --- [_103335_1100997] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.598 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (1123155) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:48.602 DEBUG 1 --- [_103335_1100997] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_1100997
2023-11-16 08:59:48.602 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 42ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:48.605 DEBUG 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:48.622 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 173ms : for accumulator : {}
2023-11-16 08:59:48.622 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 248170
2023-11-16 08:59:48.641 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 200401
2023-11-16 08:59:48.656 DEBUG 1 --- [6_103335_248170] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 248170
2023-11-16 08:59:48.657 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 78ms : for accumulator : {}
2023-11-16 08:59:48.657 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 1210151
2023-11-16 08:59:48.657  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 248170
2023-11-16 08:59:48.658  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:48.658 DEBUG 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[6090],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:48.660  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [6090]
2023-11-16 08:59:48.660  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:48.660 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[6090],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22845
2023-11-16 08:59:48.660  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:48.660  INFO 1 --- [6_103335_248170] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 248170, Took : 4s
2023-11-16 08:59:48.660  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 16 
2023-11-16 08:59:48.660  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:48.661 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:48.701 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 200401
2023-11-16 08:59:48.702  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 200401
2023-11-16 08:59:48.702 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 200401 
2023-11-16 08:59:48.707 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:48.707 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 200401 
2023-11-16 08:59:48.707  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 200401
2023-11-16 08:59:48.707 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 200401 
2023-11-16 08:59:48.707 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 200401 
2023-11-16 08:59:48.707 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.712  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 1100997
2023-11-16 08:59:48.712  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:639]: No Data found for Sending Supplier Impact Notification for event_details_id : 99446
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1100997] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1100997, Took : 5s
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1106153 
2023-11-16 08:59:48.713  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:48.716 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 2ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:48.716 DEBUG 1 --- [_103335_1210151] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 1210151
2023-11-16 08:59:48.717  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 1210151
2023-11-16 08:59:48.718  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:48.718 DEBUG 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[342,304,308],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:48.720  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [342, 304, 308]
2023-11-16 08:59:48.720 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[342,304,308],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22846
2023-11-16 08:59:48.720  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:48.720  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:48.720  INFO 1 --- [_103335_1210151] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1210151, Took : 4s
2023-11-16 08:59:48.720  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 31 
2023-11-16 08:59:48.720  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:48.723 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 1ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:48.749 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with SITE_IDS as(select unnest('{25289034}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[200401] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:48.749 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 42ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:48.750 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 200401
2023-11-16 08:59:48.886 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 224ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:48.886 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.911 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [25, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 16 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 16), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =16 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{291017,322679,322705,322733,322735,322736,322737,322743,322746,447648,654012,654020,955188,1048038,1693403}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 16 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:48.913 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 27ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:48.913 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 16 
2023-11-16 08:59:48.913 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:48.936 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [22, with SITE_IDS as ( select unnest('{291017,322679,322705,322733,322735,322736,322737,322743,322746,447648,654012,654020,955188,1048038,1693403}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 16 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:48.937 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 16
2023-11-16 08:59:48.937 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 24ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:49.003 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_200401
2023-11-16 08:59:49.003 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_200401
2023-11-16 08:59:49.003 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.035 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, with SITEID as( select * from ( select unnest(array[25289034]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:49.036 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 32ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:49.042 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_200401
2023-11-16 08:59:49.043 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 39ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_200401
2023-11-16 08:59:49.055 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_200401
2023-11-16 08:59:49.055 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 12ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:49.055 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 200401 
2023-11-16 08:59:49.056  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 200401
2023-11-16 08:59:49.104 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 16, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:49.105 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868339 and EventDetID : 99446 
2023-11-16 08:59:49.105 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 16
2023-11-16 08:59:49.105 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868339
2023-11-16 08:59:49.105 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:49.106 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868339 and Event_Details ID : 99446 
2023-11-16 08:59:49.106 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:49.106 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:49.106 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:49.112 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 16 -- Resulted rows -- [1]
2023-11-16 08:59:49.112 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 5ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:49.112 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 16 : false : false : 19868339 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:49.116 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 16
2023-11-16 08:59:49.116 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:49.116 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 16
2023-11-16 08:59:49.116 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 16
2023-11-16 08:59:49.116  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 16
2023-11-16 08:59:49.116 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 16 
2023-11-16 08:59:49.117 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 16 
2023-11-16 08:59:49.117 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.122 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 200401 
2023-11-16 08:59:49.129 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 6ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:49.129 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 200401 
2023-11-16 08:59:49.139 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 200401
2023-11-16 08:59:49.156 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (16,1388,2177,324,96) and event_details_id = 99446] 
2023-11-16 08:59:49.161 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_16
2023-11-16 08:59:49.161 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 16
2023-11-16 08:59:49.161 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 44ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:49.161  INFO 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [16]
2023-11-16 08:59:49.162  INFO 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [16]
2023-11-16 08:59:49.162 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 16 
2023-11-16 08:59:49.162 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 16 
2023-11-16 08:59:49.162 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.194 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 16 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (291017,322735,322737,322743,322746,447648,1693403,955188,322736,654012,1048038,654020,322733)] 
2023-11-16 08:59:49.195 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 16
2023-11-16 08:59:49.195 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 32ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:49.248 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.289 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, WITH SITE_IDS AS( SELECT UNNEST('{291017,322733,322733,322735,322736,322736,322737,322743,322743,322746,447648,654012,654020,955188,1048038,1693403,1693403}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[16] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 16 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:49.290 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 41ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:49.290 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 16 
2023-11-16 08:59:49.353 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 636ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:49.353 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.392 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 1106153 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 1106153), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =1106153 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{1677,29048,37163,45989,46065,46086,46830,49301,300111,300113,300114,305062,322705,366560,534966,534974,534975,654391,654800,720815,721088,722040,732853,743408,1657571,1657954,2456340,2464018}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 1106153 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:49.394 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 41ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:49.395 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 1106153 
2023-11-16 08:59:49.395 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.427 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, with SITE_IDS as ( select unnest('{1677,29048,37163,45989,46065,46086,46830,49301,300111,300113,300114,305062,322705,366560,534966,534974,534975,654391,654800,720815,721088,722040,732853,743408,1657571,1657954,2456340,2464018}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 1106153 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:49.430 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 1106153
2023-11-16 08:59:49.430 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 34ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:49.496 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 16
2023-11-16 08:59:49.496 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 206ms : for accumlator : {}
2023-11-16 08:59:49.496 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 16 
2023-11-16 08:59:49.501 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_16
2023-11-16 08:59:49.501 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_16
2023-11-16 08:59:49.501 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.548 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [?:?] : Time taken(ms) for query: [46, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 16 and total_cpns != '{}' and site_private_id = any('{1372070,1372103,1372104,1372109,1372119,1372120,1650536,2375328,4727736,4727749,11406087,15246973,53377165}')] 
2023-11-16 08:59:49.552 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_16
2023-11-16 08:59:49.552 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 51ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:49.552 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.592 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with SITEID as( select * from ( select unnest(array[1372119,53377165,2375328,11406087,1372120,4727749,4727736,1650536,1372070,1372103,15246973,1372109,1372104]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:49.593 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 40ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:49.597 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_16
2023-11-16 08:59:49.597 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 44ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_16
2023-11-16 08:59:49.610 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_16
2023-11-16 08:59:49.611 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 13ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:49.611 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 16
2023-11-16 08:59:49.618 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 16 
2023-11-16 08:59:49.619 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 16 
2023-11-16 08:59:49.619 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 16 
2023-11-16 08:59:49.619 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1106153, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:49.619 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.619 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868341 and EventDetID : 99446 
2023-11-16 08:59:49.619 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1106153
2023-11-16 08:59:49.620 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868341
2023-11-16 08:59:49.620 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:49.620 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868341 and Event_Details ID : 99446 
2023-11-16 08:59:49.620 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:49.620 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:49.621 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:49.632 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1106153 -- Resulted rows -- [1]
2023-11-16 08:59:49.632 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 11ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:49.632 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1106153 : false : false : 19868341 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:49.634 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:49.634 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:49.634 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 1106153
2023-11-16 08:59:49.634 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1106153
2023-11-16 08:59:49.635  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1106153
2023-11-16 08:59:49.635 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 1106153 
2023-11-16 08:59:49.635 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 1106153 
2023-11-16 08:59:49.635 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.669 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [34, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (1106153,1375,1661,1404,1449,1465,1573,1388,1166,324,1369,1385,152724) and event_details_id = 99446] 
2023-11-16 08:59:49.673 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_1106153
2023-11-16 08:59:49.673 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 1106153
2023-11-16 08:59:49.674 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 38ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:49.674  INFO 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [1106153]
2023-11-16 08:59:49.675  INFO 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [1106153]
2023-11-16 08:59:49.675 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 1106153 
2023-11-16 08:59:49.675 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 1106153 
2023-11-16 08:59:49.675 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.679 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [59, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868339 and tenant_id = 16] 
2023-11-16 08:59:49.679 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 60ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:49.705 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 1106153 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (37163,45989,46086,46830,305062,654800,720815,721088,722040,1657571,1657954,2456340,2464018,1677,29048,46065,49301,300111,300113,300114,322705,366560,534966,534974,534975,654391,732853,743408)] 
2023-11-16 08:59:49.706 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 1106153
2023-11-16 08:59:49.706 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 31ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:49.720 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 200401
2023-11-16 08:59:49.721  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 200401
2023-11-16 08:59:49.721 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 200401 
2023-11-16 08:59:49.721 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.749 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_16
2023-11-16 08:59:49.749 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_16
2023-11-16 08:59:49.760 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 200401 and es.event_id = 19868338 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:49.760 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 39ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:49.761 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_16
2023-11-16 08:59:49.761 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 11ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:49.764 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_200401
2023-11-16 08:59:49.764 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_200401
2023-11-16 08:59:49.815 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.815 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 50ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:49.815 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 200401 
2023-11-16 08:59:49.821 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 59ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:49.822 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 16 
2023-11-16 08:59:49.854 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, WITH SITE_IDS AS( SELECT UNNEST('{1677,29048,37163,45989,46065,46086,46830,49301,300111,300113,300114,305062,322705,366560,534966,534974,534975,654391,654800,720815,721088,722040,732853,743408,1657571,1657954,2456340,2464018}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[1106153] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 1106153 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:49.855 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 40ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:49.855 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 1106153 
2023-11-16 08:59:49.875 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 2832ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:49.875 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.898  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 200401
2023-11-16 08:59:49.898 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 200401 
2023-11-16 08:59:49.901 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 200401 
2023-11-16 08:59:49.901  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:49.901 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 200401 
2023-11-16 08:59:49.902 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 200401
2023-11-16 08:59:49.912 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 176350 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 176350), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =176350 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{1301317,1313061,1318721,1318725,1318726,1318727,1318728,1318729,1318734,1340701,1636078,1636079,1636080,2400665,2400666,2400667}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 176350 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:49.914 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 38ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:49.914 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 176350 
2023-11-16 08:59:49.914 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:49.942 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, with SITE_IDS as ( select unnest('{1301317,1313061,1318721,1318725,1318726,1318727,1318728,1318729,1318734,1340701,1636078,1636079,1636080,2400665,2400666,2400667}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 176350 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:49.944 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 176350
2023-11-16 08:59:49.944 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 29ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:49.991 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 1106153
2023-11-16 08:59:49.991 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 135ms : for accumlator : {}
2023-11-16 08:59:49.991 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 1106153 
2023-11-16 08:59:49.996 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_1106153
2023-11-16 08:59:49.996 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_1106153
2023-11-16 08:59:49.996 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.045 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [48, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 1106153 and total_cpns != '{}' and site_private_id = any('{76022236,76022325,76022525,76022643,76022684,76022763,76110009,76110392,76110705,76111624,76111625,76111626,76111627,76111628,76111629,76112673,76112674,76112675,76112822,76113359,76113458,76113467,76114609,76116454,76116455,81963003,82294391,82294401}')] 
2023-11-16 08:59:50.050 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_1106153
2023-11-16 08:59:50.050 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 53ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:50.050 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.102 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [52, with SITEID as( select * from ( select unnest(array[76111625,76111624,76111627,76111626,76111629,76111628,76113359,82294391,76022236,76022684,81963003,76022763,82294401,76112673,76112675,76112674,76116455,76116454,76110009,76110392,76113467,76022525,76110705,76114609,76022643,76113458,76022325,76112822]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:50.103 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 52ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:50.107 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_1106153
2023-11-16 08:59:50.107 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 56ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_1106153
2023-11-16 08:59:50.119 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_1106153
2023-11-16 08:59:50.120 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 12ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:50.120 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 1106153
2023-11-16 08:59:50.128 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 1106153 
2023-11-16 08:59:50.128 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 1106153 
2023-11-16 08:59:50.128 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 1106153 
2023-11-16 08:59:50.128 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.184 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [55, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868341 and tenant_id = 1106153] 
2023-11-16 08:59:50.184 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 56ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:50.252 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 176350, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:50.252 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868340 and EventDetID : 99446 
2023-11-16 08:59:50.252 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 176350
2023-11-16 08:59:50.260 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868340
2023-11-16 08:59:50.260 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 7ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:50.260 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868340 and Event_Details ID : 99446 
2023-11-16 08:59:50.260 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:50.260 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:50.261 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:50.264 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 176350 -- Resulted rows -- [1]
2023-11-16 08:59:50.264 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:50.264 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 176350 : false : false : 19868340 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:50.266 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 176350
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 176350
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 176350
2023-11-16 08:59:50.267  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 176350
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 176350 
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 176350 
2023-11-16 08:59:50.267 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.311 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (176350,181948,185560,185267,196401,179658,139844,34143,2858,471990,837350,1111302,596028,263192) and event_details_id = 99446] 
2023-11-16 08:59:50.315 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_176350
2023-11-16 08:59:50.315 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 176350
2023-11-16 08:59:50.315 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 48ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:50.315  INFO 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [176350]
2023-11-16 08:59:50.321  INFO 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [176350]
2023-11-16 08:59:50.321 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 176350 
2023-11-16 08:59:50.321 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 176350 
2023-11-16 08:59:50.321 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.341 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_1106153
2023-11-16 08:59:50.341 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 3ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_1106153
2023-11-16 08:59:50.349 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [27, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 176350 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (1301317,1313061,1318721,1318725,1318726,1318727,1318728,1318729,1318734,1340701,1636078,1636079,1636080,2400665,2400666,2400667)] 
2023-11-16 08:59:50.350 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[213998, 105698, 88018, 103479, 103478, 105721]
2023-11-16 08:59:50.350 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 448ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:50.350 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 6 for customer 200401
2023-11-16 08:59:50.350 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[213998, 105698, 88018, 103479, 103478, 105721]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}200401
2023-11-16 08:59:50.351 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_1106153
2023-11-16 08:59:50.351 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 9ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:50.351 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 176350
2023-11-16 08:59:50.351 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 30ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:50.354 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[213998, 105698, 88018, 103479, 103478, 105721]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}200401
2023-11-16 08:59:50.354 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 3ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:50.355 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 200401 99446 user with No pref [213998, 105698, 88018, 103479, 103478, 105721]
2023-11-16 08:59:50.356 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:50.356 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 200401 99446 [105699, 105714, 105715, 105716, 105720, 135928, 160738, 160739, 160740, 160741, 160743, 160744, 160745, 160746, 160747, 160748, 160749, 161216, 161261, 178984, 178985, 178986, 178988, 178990, 185450, 185452, 187933, 192525, 196907, 214943, 215408, 220578, 224688, 231764, 295429, 300901]
2023-11-16 08:59:50.357 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [?:?] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  200401 99446 
2023-11-16 08:59:50.357 DEBUG 1 --- [     Thread-397] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 200401 99446 [105699, 105714, 105715, 105716, 105720, 135928, 160738, 160739, 160740, 160741, 160743, 160744, 160745, 160746, 160747, 160748, 160749, 161216, 161261, 178984, 178985, 178986, 178988, 178990, 185450, 185452, 187933, 192525, 196907, 214943, 215408, 220578, 224688, 231764, 295429, 300901]
2023-11-16 08:59:50.360 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  200401 99446 
2023-11-16 08:59:50.360 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:50.360 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 185452, 160749, 161261, 105715, 105714, 215408, 224688, 105716, 105720, 135928]
2023-11-16 08:59:50.360 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 9ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:50.361 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 1106153 
2023-11-16 08:59:50.368 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 185452, 160749, 161261, 105715, 105714, 215408, 224688, 105716, 105720, 135928]
2023-11-16 08:59:50.368 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 8ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:50.368 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 185452, 160749, 161261, 105715, 105714, 215408, 224688, 105716, 105720, 135928]
2023-11-16 08:59:50.392 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.400 DEBUG 1 --- [     Thread-397] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 200401 99446 [105699, 105714, 105715, 105716, 105720, 135928, 160738, 160739, 160740, 160741, 160743, 160744, 160745, 160746, 160747, 160748, 160749, 161216, 161261, 178984, 178985, 178986, 178988, 178990, 185450, 185452, 187933, 192525, 196907, 214943, 215408, 220578, 224688, 231764, 295429, 300901]
2023-11-16 08:59:50.400 DEBUG 1 --- [     Thread-397] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 43ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:50.428 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, WITH SITE_IDS AS( SELECT UNNEST('{1301317,1313061,1318721,1318725,1318726,1318727,1318728,1318729,1318734,1340701,1636078,1636079,1636080,2400665,2400666,2400667}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[176350] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 176350 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:50.428 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 36ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:50.429 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 176350 
2023-11-16 08:59:50.437 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 160749, 105715, 105714, 215408, 224688, 135928]
2023-11-16 08:59:50.437 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 68ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:50.437 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 160749, 105715, 105714, 215408, 224688, 135928]
2023-11-16 08:59:50.438 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 200401 99446 [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 160749, 105715, 105714, 215408, 224688, 135928]
2023-11-16 08:59:50.438 DEBUG 1 --- [     Thread-396] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 1ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:50.439 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 200401 and eventId 99446 and userIds [295429, 161216, 192525, 231764, 214943, 187933, 160738, 160739, 220578, 300901, 105699, 160743, 160740, 160741, 160746, 178986, 185450, 196907, 160747, 160744, 178984, 160745, 178985, 178990, 160748, 178988, 160749, 105715, 105714, 215408, 224688, 135928]
2023-11-16 08:59:50.439 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 200401 and eventId : 99446 
2023-11-16 08:59:50.439 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:50.446 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 4
2023-11-16 08:59:50.446 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 7ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:50.447 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 200401 99446
2023-11-16 08:59:50.447 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 200401
2023-11-16 08:59:50.447  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 200401
2023-11-16 08:59:50.447 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:50.447 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [200401] 
2023-11-16 08:59:50.451 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:50.451 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 4ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:50.451  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 200401, isUpdateAlert : true
2023-11-16 08:59:50.451  INFO 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:50.452 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:50.452  INFO 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:50.452 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"a98fdf64-9804-49fa-851e-668757e3982a","eventId":19868338,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:50.454 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"a98fdf64-9804-49fa-851e-668757e3982a","eventId":19868338,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41791
2023-11-16 08:59:50.454  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868338, tenantId : 200401
2023-11-16 08:59:50.454  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:50.454  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [553693] 
2023-11-16 08:59:50.454 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.499 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (553693)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:50.499 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 45ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:50.558 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 1835ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:50.558 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.593 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 31 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 31), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =31 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{30144,45989,87938,300111,300113,300114,322705,443493,443494,443495,443496,532614,538237,722040,743408,924351,962222,963609,967439,967440,967441,969528,970034,971742,971743,971744,972076,972625,972665,972724,1070250,1189136,1638163,2018074,2018075,2018078,2018079,2018080,2018084,2018085,2018086,2018087,2018088,2018089,2018090,2018091,2018092,2018093,2018094,2018097,2018101,2064613,2064614,2288436,2301119,2301120,2346436,2346437,2367046,2367047,2367048,2367049,2396939,2444809,2444810}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 31 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:50.595 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 36ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:50.595 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 31 
2023-11-16 08:59:50.595 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.615 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [19, with SITE_IDS as ( select unnest('{30144,45989,87938,300111,300113,300114,322705,443493,443494,443495,443496,532614,538237,722040,743408,924351,962222,963609,967439,967440,967441,969528,970034,971742,971743,971744,972076,972625,972665,972724,1070250,1189136,1638163,2018074,2018075,2018078,2018079,2018080,2018084,2018085,2018086,2018087,2018088,2018089,2018090,2018091,2018092,2018093,2018094,2018097,2018101,2064613,2064614,2288436,2301119,2301120,2346436,2346437,2367046,2367047,2367048,2367049,2396939,2444809,2444810}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 31 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:50.617 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 31
2023-11-16 08:59:50.617 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 21ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:50.644 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 16
2023-11-16 08:59:50.667 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 176350
2023-11-16 08:59:50.668 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 238ms : for accumlator : {}
2023-11-16 08:59:50.668 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 176350 
2023-11-16 08:59:50.670 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.673 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_176350
2023-11-16 08:59:50.673 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 5ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_176350
2023-11-16 08:59:50.673 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.690 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [19, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (553693)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:50.690 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 19ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:50.693 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [19, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 176350 and total_cpns != '{}' and site_private_id = any('{33380796,33383714,33386601,33386602,33395633,33399770,33399771,33399772,33399773,33399776,51794926,51794932,51794934,77557810,77557824,77557825}')] 
2023-11-16 08:59:50.694 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_200401
2023-11-16 08:59:50.695 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_200401
2023-11-16 08:59:50.697 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_176350
2023-11-16 08:59:50.697 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 23ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:50.697 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.700 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_200401
2023-11-16 08:59:50.700 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_200401
2023-11-16 08:59:50.705 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 5ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:50.719 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [21, with SITEID as( select * from ( select unnest(array[33399773,51794934,33380796,33399772,51794932,33399771,33399770,33395633,77557810,33386601,33386602,51794926,33399776,77557825,33383714,77557824]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:50.719 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 21ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:50.722 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_176350
2023-11-16 08:59:50.723 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 25ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_176350
2023-11-16 08:59:50.734 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_176350
2023-11-16 08:59:50.734 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 11ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:50.734 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 176350
2023-11-16 08:59:50.741 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 176350 
2023-11-16 08:59:50.741 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 176350 
2023-11-16 08:59:50.741 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 176350 
2023-11-16 08:59:50.741 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.781 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868340 and tenant_id = 176350] 
2023-11-16 08:59:50.781 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 39ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:50.820 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 16
2023-11-16 08:59:50.821  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 16
2023-11-16 08:59:50.821 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 16 
2023-11-16 08:59:50.826 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:50.826 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 16 
2023-11-16 08:59:50.826  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 16
2023-11-16 08:59:50.826 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 16 
2023-11-16 08:59:50.826 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 16 
2023-11-16 08:59:50.827 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.851 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_176350
2023-11-16 08:59:50.851 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 5ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_176350
2023-11-16 08:59:50.863 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with SITE_IDS as(select unnest('{1204813,1371468,1371473,1371496,2375343,15214280,53377242}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[16] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:50.864 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 37ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:50.864 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 16
2023-11-16 08:59:50.865 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_176350
2023-11-16 08:59:50.866 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 14ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:50.879 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 13ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:50.882 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 176350 
2023-11-16 08:59:50.890  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 200401
2023-11-16 08:59:50.891 DEBUG 1 --- [6_103335_200401] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:50.933 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (553693) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:50.938 DEBUG 1 --- [6_103335_200401] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_200401
2023-11-16 08:59:50.939 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 48ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:50.942 DEBUG 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 200401
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:639]: No Data found for Sending Supplier Impact Notification for event_details_id : 99446
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_200401] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 200401, Took : 3s
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158309 
2023-11-16 08:59:51.010  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:51.011 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:51.036 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 24ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:51.036 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.059 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_16
2023-11-16 08:59:51.060 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_16
2023-11-16 08:59:51.060 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.078 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 158309 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 158309), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =158309 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{443171,443493,443494,443495,443496}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158309 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:51.080 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 43ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:51.080 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 158309 
2023-11-16 08:59:51.080 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.095 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, with SITEID as( select * from ( select unnest(array[15214280,53377242,1371473,1371468,2375343,1371496,1204813]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:51.095 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 35ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:51.099 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_16
2023-11-16 08:59:51.100 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 39ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_16
2023-11-16 08:59:51.110 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_16
2023-11-16 08:59:51.110 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 10ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:51.110 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 16 
2023-11-16 08:59:51.110  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 16
2023-11-16 08:59:51.113 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, with SITE_IDS as ( select unnest('{443171,443493,443494,443495,443496}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158309 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:51.115 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 158309
2023-11-16 08:59:51.115 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 34ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:51.204 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:51.229 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 16 
2023-11-16 08:59:51.234 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:51.234 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 16 
2023-11-16 08:59:51.243 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 16
2023-11-16 08:59:51.321 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 31, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:51.321 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868342 and EventDetID : 99446 
2023-11-16 08:59:51.321 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 31
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868342
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868342 and Event_Details ID : 99446 
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:51.323 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:51.326 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 31 -- Resulted rows -- [1]
2023-11-16 08:59:51.326 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:51.326 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 31 : false : false : 19868342 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 31
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 31
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 31
2023-11-16 08:59:51.328  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 31
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 31 
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 31 
2023-11-16 08:59:51.328 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.361 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (31,292,75792,111,270,152723,434095,434109,434160,434441,435035,435363,436348,436387,436391,436415,144203,75804,989842,434966,435729,435293,434883,990131,989253,989424,436382,435855,989389,990052,990739,75811,1028992,1038736,1063019,436219,433688,989609,989149,990409,1139788) and event_details_id = 99446] 
2023-11-16 08:59:51.365 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_31
2023-11-16 08:59:51.365 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 31
2023-11-16 08:59:51.365 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 36ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:51.365  INFO 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [31]
2023-11-16 08:59:51.371 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:51.372  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 1106153
2023-11-16 08:59:51.372 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 1106153 
2023-11-16 08:59:51.373  INFO 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [31]
2023-11-16 08:59:51.373 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 31 
2023-11-16 08:59:51.373 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 31 
2023-11-16 08:59:51.373 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.376 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:51.377 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 1106153 
2023-11-16 08:59:51.377  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 1106153
2023-11-16 08:59:51.377 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 1106153 
2023-11-16 08:59:51.377 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 1106153 
2023-11-16 08:59:51.377 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.385 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158309, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:51.385 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868343 and EventDetID : 99446 
2023-11-16 08:59:51.385 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158309
2023-11-16 08:59:51.386 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868343
2023-11-16 08:59:51.386 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:51.386 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868343 and Event_Details ID : 99446 
2023-11-16 08:59:51.386 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:51.386 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:51.387 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:51.400 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158309 -- Resulted rows -- [1]
2023-11-16 08:59:51.400 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 12ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:51.400 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158309 : false : false : 19868343 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [?:?] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158309
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 158309
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158309
2023-11-16 08:59:51.403  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158309
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 158309 
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 158309 
2023-11-16 08:59:51.403 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.406 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 31 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (30144,443493,443494,443495,443496,532614,538237,924351,962222,963609,967439,967440,967441,969528,970034,971742,971743,971744,972076,972625,972665,972724,1189136,1638163,2018074,2018075,2018078,2018079,2018080,2018084,2018085,2018086,2018087,2018088,2018089,2018090,2018091,2018092,2018093,2018094,2018097,2018101,2064613,2064614,2288436,2301119,2301120,2346436,2346437,2367046,2367047,2367048,2367049,2396939,87938,2444809,2444810)] 
2023-11-16 08:59:51.409 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [?:?] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 31
2023-11-16 08:59:51.409 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 35ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:51.424 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, with SITE_IDS as(select unnest('{32749,48900,63589,69853,1233767,4728572,5368841,5369115,5370067,52395825,52396211,81963094,82294443}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[1106153] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:51.425 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [?:?] : [createPartnerAnchorIdDs:1571]: Time taken : 48ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:51.425 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 1106153
2023-11-16 08:59:51.434 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [30, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (158309,75792,75803) and event_details_id = 99446] 
2023-11-16 08:59:51.440 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_158309
2023-11-16 08:59:51.441 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 158309
2023-11-16 08:59:51.441 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 37ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:51.441  INFO 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [158309]
2023-11-16 08:59:51.441  INFO 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [158309]
2023-11-16 08:59:51.441 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158309 
2023-11-16 08:59:51.441 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158309 
2023-11-16 08:59:51.442 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.467 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.480 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 158309 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (443171,443493,443494,443495,443496)] 
2023-11-16 08:59:51.483 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158309
2023-11-16 08:59:51.483 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 41ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:51.503 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, WITH SITE_IDS AS( SELECT UNNEST('{30144,87938,443493,443493,443493,443493,443493,443494,443494,443494,443494,443494,443495,443495,443495,443495,443495,443496,443496,443496,443496,443496,532614,538237,924351,962222,962222,962222,962222,962222,962222,962222,963609,963609,963609,963609,967439,967439,967439,967439,967439,967440,967440,967440,967440,967440,967441,967441,967441,967441,967441,969528,969528,969528,969528,970034,970034,971742,971743,971744,972076,972076,972076,972076,972076,972076,972076,972076,972076,972625,972625,972625,972625,972625,972625,972625,972625,972625,972625,972625,972625,972625,972665,972665,972665,972665,972665,972665,972665,972665,972665,972665,972665,972665,972665,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,972724,1189136,1638163,2018074,2018074,2018074,2018074,2018074,2018074,2018074,2018075,2018075,2018078,2018078,2018078,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018079,2018080,2018080,2018080,2018080,2018080,2018084,2018084,2018084,2018084,2018084,2018084,2018084,2018084,2018084,2018084,2018084,2018085,2018085,2018085,2018085,2018085,2018085,2018085,2018085,2018085,2018085,2018085,2018086,2018086,2018086,2018086,2018086,2018086,2018086,2018086,2018086,2018086,2018086,2018087,2018087,2018087,2018087,2018087,2018087,2018087,2018087,2018087,2018087,2018087,2018088,2018088,2018088,2018088,2018088,2018088,2018088,2018088,2018088,2018088,2018088,2018089,2018089,2018089,2018089,2018089,2018089,2018089,2018089,2018089,2018089,2018089,2018090,2018090,2018090,2018090,2018090,2018090,2018090,2018090,2018090,2018090,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018091,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018092,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018093,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018094,2018097,2018097,2018097,2018097,2018097,2018101,2018101,2018101,2018101,2018101,2064613,2064614,2064614,2064614,2064614,2064614,2288436,2288436,2288436,2301119,2301119,2301120,2301120,2346436,2346436,2346436,2346436,2346436,2346436,2346436,2346436,2346436,2346437,2346437,2367046,2367047,2367048,2367048,2367048,2367049,2367049,2367049,2396939,2396939,2444809,2444810}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[31] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 31 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:51.504 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 37ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:51.504 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 31 
2023-11-16 08:59:51.547 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.591 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, WITH SITE_IDS AS( SELECT UNNEST('{443171,443171,443493,443493,443494,443494,443495,443495,443496,443496}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[158309] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 158309 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:51.592 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 45ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:51.592 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 158309 
2023-11-16 08:59:51.600 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_1106153
2023-11-16 08:59:51.600 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_1106153
2023-11-16 08:59:51.600 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.648 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, with SITEID as( select * from ( select unnest(array[5370067,48900,63589,5369115,52396211,82294443,32749,52395825,4728572,81963094,1233767,5368841,69853]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:51.648 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 48ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:51.651 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1106153
2023-11-16 08:59:51.651 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 51ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_1106153
2023-11-16 08:59:51.660 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_1106153
2023-11-16 08:59:51.660 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 8ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:51.660 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 1106153 
2023-11-16 08:59:51.661  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 1106153
2023-11-16 08:59:51.662 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 176350
2023-11-16 08:59:51.668 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 31
2023-11-16 08:59:51.668 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 163ms : for accumlator : {}
2023-11-16 08:59:51.668 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 31 
2023-11-16 08:59:51.672 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_31
2023-11-16 08:59:51.672 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 3ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_31
2023-11-16 08:59:51.672 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.693 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [21, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 31 and total_cpns != '{}' and site_private_id = any('{360122,10179470,23136841,23140919,28953601,28954552,62490764,62491722,62491959,62492110,62492150,62492602,62492603,62492604,62492752,62493080,62493081,62493082,62493083,62493084,62493085,62493178,62493310,62494182,62494886,62495008,62495408,62496287,62496354,62496386,62496493,62496525,62496686,62496933,64053139,64053140,64053141,64053142,64053143,64056998,64057701,65743596,66769025,66769026,69920232,69927665,73260913,73261342,73266049,73267179,73267244,73272651,73272652,73272653,76923638,79931737,79931738}')] 
2023-11-16 08:59:51.697 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_31
2023-11-16 08:59:51.697 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 25ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:51.697 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.707 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 176350
2023-11-16 08:59:51.708  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 176350
2023-11-16 08:59:51.708 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 176350 
2023-11-16 08:59:51.712 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 158309
2023-11-16 08:59:51.712 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 119ms : for accumlator : {}
2023-11-16 08:59:51.712 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 158309 
2023-11-16 08:59:51.713 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:51.713 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 176350 
2023-11-16 08:59:51.713  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 176350
2023-11-16 08:59:51.713 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 176350 
2023-11-16 08:59:51.713 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 176350 
2023-11-16 08:59:51.714 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.716 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_158309
2023-11-16 08:59:51.717 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_158309
2023-11-16 08:59:51.717 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.719 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 1106153 
2023-11-16 08:59:51.724 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:51.724 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [26, with SITEID as( select * from ( select unnest(array[28954552,62492603,62492602,62492604,65743596,62495408,62491959,73272652,73272653,10179470,73272651,62496686,62495008,79931738,79931737,62496933,62494886,62493081,62493080,62493083,62493082,62493085,62493084,62496287,23136841,73260913,62496525,64057701,62490764,73267179,28953601,62496386,360122,64053139,69920232,62493178,73261342,64053141,64053140,64053143,62493310,64053142,62492150,62496493,23140919,69927665,62496354,73266049,62494182,76923638,62492752,73267244,62491722,62492110,64056998,66769026,66769025]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:51.724 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 1106153 
2023-11-16 08:59:51.724 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 26ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:51.727 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_31
2023-11-16 08:59:51.727 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 30ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_31
2023-11-16 08:59:51.732 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:51.738 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_31
2023-11-16 08:59:51.738 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 10ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:51.738 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 31
2023-11-16 08:59:51.739 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [22, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 158309 and total_cpns != '{}' and site_private_id = any('{2315055,2315382,2315383,2315384,2315385}')] 
2023-11-16 08:59:51.743 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_158309
2023-11-16 08:59:51.743 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 16
2023-11-16 08:59:51.743 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 26ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:51.743 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.743  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 16
2023-11-16 08:59:51.743 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 16 
2023-11-16 08:59:51.744 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.746 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 31 
2023-11-16 08:59:51.746 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 31 
2023-11-16 08:59:51.746 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 31 
2023-11-16 08:59:51.746 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.751 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, with SITE_IDS as(select unnest('{33402925,33403113,33406170,33407328,33412020,33412355,33414505,33414592,33415435,33421155,51797668,51816084,51820972,77565782,77584943,77586391}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[176350] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:51.751 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 37ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:51.751 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 176350
2023-11-16 08:59:51.769 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [26, with SITEID as( select * from ( select unnest(array[2315383,2315382,2315385,2315384,2315055]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:51.770 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 26ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:51.773 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_158309
2023-11-16 08:59:51.773 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 29ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_158309
2023-11-16 08:59:51.783 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_158309
2023-11-16 08:59:51.784 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 10ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:51.784 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 158309
2023-11-16 08:59:51.784 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 16 and es.event_id = 19868339 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:51.784 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868342 and tenant_id = 31] 
2023-11-16 08:59:51.784 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 38ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:51.784 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 40ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:51.788 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_16
2023-11-16 08:59:51.788 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_16
2023-11-16 08:59:51.790 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158309 
2023-11-16 08:59:51.791 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 158309 
2023-11-16 08:59:51.791 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 158309 
2023-11-16 08:59:51.791 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:51.791 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:51.791 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 16 
2023-11-16 08:59:51.829 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868343 and tenant_id = 158309] 
2023-11-16 08:59:51.829 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 38ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:51.852 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_31
2023-11-16 08:59:51.852 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 3ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_31
2023-11-16 08:59:51.861 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_31
2023-11-16 08:59:51.861 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 9ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:51.870 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 8ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:51.871  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 16
2023-11-16 08:59:51.871 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 16 
2023-11-16 08:59:51.872 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 31 
2023-11-16 08:59:51.875 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 16 
2023-11-16 08:59:51.875  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): false, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:51.875 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 16 
2023-11-16 08:59:51.875 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 16
2023-11-16 08:59:51.897 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_158309
2023-11-16 08:59:51.897 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 3ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_158309
2023-11-16 08:59:51.907 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_158309
2023-11-16 08:59:51.907 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 9ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:51.916 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 9ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:51.919 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 158309 
2023-11-16 08:59:51.972 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_176350
2023-11-16 08:59:51.972 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_176350
2023-11-16 08:59:51.972 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:52.000 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [27, with SITEID as( select * from ( select unnest(array[51816084,33406170,77586391,33412020,77565782,33402925,77584943,51797668,33403113,33414505,33415435,51820972,33407328,33414592,33412355,33421155]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:52.000 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 28ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:52.004 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_176350
2023-11-16 08:59:52.004 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 31ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_176350
2023-11-16 08:59:52.013 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_176350
2023-11-16 08:59:52.014 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:52.014 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 176350 
2023-11-16 08:59:52.014  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 176350
2023-11-16 08:59:52.052 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[153020, 224514, 302299, 99644, 135740, 280592, 112564, 147456, 112045, 132982, 157418, 238475, 150009, 230907, 160916, 212971, 150008, 112046, 151513, 234013, 287564]
2023-11-16 08:59:52.052 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 176ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:52.052 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 21 for customer 16
2023-11-16 08:59:52.053 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[153020, 224514, 302299, 99644, 135740, 280592, 112564, 147456, 112045, 132982, 157418, 238475, 150009, 230907, 160916, 212971, 150008, 112046, 151513, 234013, 287564]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}16
2023-11-16 08:59:52.059 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[153020, 224514, 302299, 99644, 135740, 280592, 112564, 147456, 112045, 132982, 157418, 238475, 150009, 230907, 160916, 212971, 150008, 112046, 151513, 234013, 287564]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}16
2023-11-16 08:59:52.059 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 6ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:52.059 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 16 99446 user with No pref [153020, 224514, 302299, 99644, 135740, 280592, 112564, 147456, 112045, 132982, 157418, 238475, 150009, 230907, 160916, 212971, 150008, 112046, 151513, 234013, 287564]
2023-11-16 08:59:52.062 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 3ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:52.063 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 16 99446 [148519]
2023-11-16 08:59:52.063 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  16 99446 
2023-11-16 08:59:52.063 DEBUG 1 --- [     Thread-399] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 16 99446 [148519]
2023-11-16 08:59:52.066 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  16 99446 
2023-11-16 08:59:52.066 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:52.066 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 16 99446 [148519]
2023-11-16 08:59:52.067 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 16 99446 [148519]
2023-11-16 08:59:52.067 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 1ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:52.067 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 16 99446 [148519]
2023-11-16 08:59:52.068 DEBUG 1 --- [     Thread-399] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 16 99446 [148519]
2023-11-16 08:59:52.068 DEBUG 1 --- [     Thread-399] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 4ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:52.068 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 16 99446 [148519]
2023-11-16 08:59:52.068 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 0ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:52.068 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 16 99446 [148519]
2023-11-16 08:59:52.069 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 16 99446 [148519]
2023-11-16 08:59:52.069 DEBUG 1 --- [     Thread-398] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:52.069 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 16 and eventId 99446 and userIds [148519]
2023-11-16 08:59:52.069 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 16 and eventId : 99446 
2023-11-16 08:59:52.069 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 1
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 4ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 16 99446
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 16
2023-11-16 08:59:52.073  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 16
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:52.073 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [16] 
2023-11-16 08:59:52.076 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:52.076 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:52.076  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 16, isUpdateAlert : true
2023-11-16 08:59:52.076  INFO 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:52.077 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:52.077  INFO 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:52.078 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"d64e561b-77dd-4a0f-b485-3a6bcdfaf054","eventId":19868339,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:52.079  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868339, tenantId : 16
2023-11-16 08:59:52.079 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"d64e561b-77dd-4a0f-b485-3a6bcdfaf054","eventId":19868339,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41792
2023-11-16 08:59:52.080  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:52.080  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [96] 
2023-11-16 08:59:52.080 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:52.113 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (96)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:52.113 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 33ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:52.271 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 176350 
2023-11-16 08:59:52.273 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:52.277 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:52.277 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 176350 
2023-11-16 08:59:52.289 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 176350
2023-11-16 08:59:52.302 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (96)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:52.302 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 29ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:52.308 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_16
2023-11-16 08:59:52.308 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 5ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_16
2023-11-16 08:59:52.313 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_16
2023-11-16 08:59:52.313 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_16
2023-11-16 08:59:52.320 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 6ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:52.631 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:52.632  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 1106153
2023-11-16 08:59:52.632 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 1106153 
2023-11-16 08:59:52.632 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:52.666 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 1106153 and es.event_id = 19868341 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:52.666 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 34ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:52.670 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_1106153
2023-11-16 08:59:52.670 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_1106153
2023-11-16 08:59:52.673 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:52.675 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [?:?] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 1106153 
2023-11-16 08:59:52.894  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 1106153
2023-11-16 08:59:52.894 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1106153 
2023-11-16 08:59:52.899 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1106153 
2023-11-16 08:59:52.899  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): false, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:52.899 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 1106153 
2023-11-16 08:59:52.899 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 1106153
2023-11-16 08:59:52.963 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[286088, 266453, 266451, 268309, 286083, 275599, 285222, 266449, 280888, 286090, 92382, 199802, 285219, 285221, 285213]
2023-11-16 08:59:52.964 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 64ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:52.964 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 15 for customer 1106153
2023-11-16 08:59:52.964 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[286088, 266453, 266451, 268309, 286083, 275599, 285222, 266449, 280888, 286090, 92382, 199802, 285219, 285221, 285213]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1106153
2023-11-16 08:59:52.968 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[286088, 266453, 266451, 268309, 286083, 275599, 285222, 266449, 280888, 286090, 92382, 199802, 285219, 285221, 285213]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1106153
2023-11-16 08:59:52.968 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 3ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:52.968 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 1106153 99446 user with No pref [286088, 266453, 266451, 268309, 286083, 275599, 285222, 266449, 280888, 286090, 92382, 199802, 285219, 285221, 285213]
2023-11-16 08:59:52.970 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:52.970 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 1106153 99446 [205500, 285203, 285204, 285205, 285206, 285208, 285212, 285214, 285215, 285218, 285220, 285223, 285224]
2023-11-16 08:59:52.971 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [?:?] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  1106153 99446 
2023-11-16 08:59:52.971 DEBUG 1 --- [     Thread-401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 1106153 99446 [205500, 285203, 285204, 285205, 285206, 285208, 285212, 285214, 285215, 285218, 285220, 285223, 285224]
2023-11-16 08:59:52.974 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  1106153 99446 
2023-11-16 08:59:52.974 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 3ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:52.974 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 1106153 99446 [285204, 285205, 285223, 285218, 285203, 285212, 285215, 285208, 285224]
2023-11-16 08:59:52.975 DEBUG 1 --- [     Thread-401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 1106153 99446 [205500, 285203, 285204, 285205, 285206, 285208, 285212, 285214, 285215, 285218, 285220, 285223, 285224]
2023-11-16 08:59:52.975 DEBUG 1 --- [     Thread-401] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 3ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:52.976 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 1106153 99446 [285204, 285205, 285223, 285218, 285203, 285212, 285215]
2023-11-16 08:59:52.976 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 2ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:52.976 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 1106153 99446 [285204, 285205, 285223, 285218, 285203, 285212, 285215]
2023-11-16 08:59:52.984 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 1106153 99446 [285218, 285212]
2023-11-16 08:59:52.984 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 7ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:52.984 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 1106153 99446 [285218, 285212]
2023-11-16 08:59:52.987 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 1106153 99446 [285218, 285212]
2023-11-16 08:59:52.987 DEBUG 1 --- [     Thread-400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 3ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:52.987 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 1106153 and eventId 99446 and userIds [285218, 285212]
2023-11-16 08:59:52.988 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 1106153 and eventId : 99446 
2023-11-16 08:59:52.988 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 2
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 3ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 1106153 99446
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 1106153
2023-11-16 08:59:52.991  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 1106153
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:52.991 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1106153] 
2023-11-16 08:59:52.994 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:52.994 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:52.994  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 1106153, isUpdateAlert : true
2023-11-16 08:59:52.994  INFO 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:52.995 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:52.995  INFO 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:52.996 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"3e10c742-023f-48c2-b407-b8bebe06c2db","eventId":19868341,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:52.998  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868341, tenantId : 1106153
2023-11-16 08:59:52.998 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"3e10c742-023f-48c2-b407-b8bebe06c2db","eventId":19868341,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41793
2023-11-16 08:59:52.998  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:52.999  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [1465] 
2023-11-16 08:59:52.999 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.037 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (1465)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:53.037 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 38ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:53.108 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.121 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 31
2023-11-16 08:59:53.159 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [51, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (1465)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:53.160 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 51ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:53.163 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1106153
2023-11-16 08:59:53.164 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_1106153
2023-11-16 08:59:53.167 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1106153
2023-11-16 08:59:53.167 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 3ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_1106153
2023-11-16 08:59:53.168  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 16
2023-11-16 08:59:53.168 DEBUG 1 --- [99446_103335_16] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.172 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:53.172 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 31
2023-11-16 08:59:53.174  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 31
2023-11-16 08:59:53.174 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 31 
2023-11-16 08:59:53.179 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:53.179 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 31 
2023-11-16 08:59:53.180  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 31
2023-11-16 08:59:53.180 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 31 
2023-11-16 08:59:53.180 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 31 
2023-11-16 08:59:53.180 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.199 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 158309
2023-11-16 08:59:53.205 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (96) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:53.210 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_16
2023-11-16 08:59:53.210 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 41ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:53.213 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [?:?] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:53.246 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 176350
2023-11-16 08:59:53.247 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [?:?] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 158309
2023-11-16 08:59:53.247  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 176350
2023-11-16 08:59:53.247 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 176350 
2023-11-16 08:59:53.247 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.248  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 158309
2023-11-16 08:59:53.248 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 158309 
2023-11-16 08:59:53.251 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [71, with SITE_IDS as(select unnest('{63635,2288360,2288361,2288362,2288363,3611810,3616947,10182907,11937219,11937285,11937587,11937588,11937589,11938794,11940943,11942360,11942361,11942362,11946784,11947098,11947179,11947423,26110573,52062549,62497274,62497445,62497663,62498475,62498922,62499181,62499966,62500495,62501467,62501630,62501754,62501853,62501964,62502331,62502365,62502829,62503342,62503535,64063001,64063721,65757356,66770684,66771371,69934552,69936954,73277536,73279124,73282487,73287516,76932865}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[31] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:53.252 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 71ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:53.252 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 31
2023-11-16 08:59:53.254 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:53.254 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 158309 
2023-11-16 08:59:53.254  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 158309
2023-11-16 08:59:53.254 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 158309 
2023-11-16 08:59:53.254 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 158309 
2023-11-16 08:59:53.254 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.300 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [45, with SITE_IDS as(select unnest('{2288360,2288361,2288362,2288363,2288409}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[158309] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:53.300 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 46ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:53.300 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 158309
2023-11-16 08:59:53.305 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [57, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 176350 and es.event_id = 19868340 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:53.305 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 58ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:53.310 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_176350
2023-11-16 08:59:53.310 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 4ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_176350
2023-11-16 08:59:53.314 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:53.314 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 176350 
2023-11-16 08:59:53.327  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 1106153
2023-11-16 08:59:53.327 DEBUG 1 --- [_103335_1106153] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.372 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (1465) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:53.375 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_1106153
2023-11-16 08:59:53.375 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 47ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:53.378 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:53.388  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:?] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 176350
2023-11-16 08:59:53.388 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 176350 
2023-11-16 08:59:53.392 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 176350 
2023-11-16 08:59:53.392  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:53.392 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 176350 
2023-11-16 08:59:53.392 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 176350
2023-11-16 08:59:53.524 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 112ms : for accumulator : {}
2023-11-16 08:59:53.524 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 16
2023-11-16 08:59:53.549 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_158309
2023-11-16 08:59:53.549 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 3ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_158309
2023-11-16 08:59:53.549 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.572 DEBUG 1 --- [99446_103335_16] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 16
2023-11-16 08:59:53.573  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 16
2023-11-16 08:59:53.573  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:53.574 DEBUG 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[96],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:53.575  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [96]
2023-11-16 08:59:53.575 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[96],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22847
2023-11-16 08:59:53.575  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:53.575  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:53.576  INFO 1 --- [99446_103335_16] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 16, Took : 4s
2023-11-16 08:59:53.576  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 779990 
2023-11-16 08:59:53.576  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:53.577 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:53.578 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, with SITEID as( select * from ( select unnest(array[2288362,2288363,2288360,2288361,2288409]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:53.579 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 29ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:53.582 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158309
2023-11-16 08:59:53.582 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 32ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158309
2023-11-16 08:59:53.585 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_31
2023-11-16 08:59:53.585 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 3ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_31
2023-11-16 08:59:53.585 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:53.591 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_158309
2023-11-16 08:59:53.591 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:53.591 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 158309 
2023-11-16 08:59:53.591  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 158309
2023-11-16 08:59:53.615 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [30, with SITEID as( select * from ( select unnest(array[11937588,62502331,73287516,11937589,3616947,11937587,66770684,69936954,62498475,63635,62502829,76932865,3611810,11946784,62503342,62497445,11947179,11947423,11937285,62500495,64063721,73277536,62497274,62501754,62497663,62499966,62501630,65757356,2288362,64063001,2288363,2288360,73279124,2288361,52062549,66771371,62498922,62499181,62503535,11938794,10182907,62501467,26110573,62501853,62502365,73282487,11942362,11947098,11942360,11942361,69934552,11937219,62501964,11940943]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:53.615 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 30ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:53.618 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_31
2023-11-16 08:59:53.619 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 33ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_31
2023-11-16 08:59:53.622 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 106ms : for accumulator : {}
2023-11-16 08:59:53.623 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:53.628 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_31
2023-11-16 08:59:53.628 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:53.628 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 31 
2023-11-16 08:59:53.628  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 31
2023-11-16 08:59:53.652 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 158309 
2023-11-16 08:59:53.657 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:53.657 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 158309 
2023-11-16 08:59:53.665 DEBUG 1 --- [_103335_1106153] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 1106153
2023-11-16 08:59:53.666  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 1106153
2023-11-16 08:59:53.666  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:53.667 DEBUG 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[1465],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:53.667 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 158309
2023-11-16 08:59:53.668  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [1465]
2023-11-16 08:59:53.668 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[1465],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22848
2023-11-16 08:59:53.668  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:53.668  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:53.669  INFO 1 --- [_103335_1106153] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1106153, Took : 4s
2023-11-16 08:59:53.669  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 475791 
2023-11-16 08:59:53.669  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:53.670 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:53.696 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 31 
2023-11-16 08:59:53.701 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:53.701 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 31 
2023-11-16 08:59:53.709 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 31
2023-11-16 08:59:54.092 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 158309
2023-11-16 08:59:54.093  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 158309
2023-11-16 08:59:54.093 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 158309 
2023-11-16 08:59:54.094 DEBUG 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.130 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[240050, 100479, 100493, 100466, 100505, 100540, 100421, 204651, 100446, 100472, 100539, 215638, 147360, 177756, 101825, 262864, 269201, 180138, 100429, 100526, 258886, 88191, 114812, 100499, 285226, 100415, 103304, 102463, 103992, 100488, 173274, 175856, 100340, 173216, 101665, 175858, 204650, 235795, 100502, 268120, 175855, 175853, 269202, 175857, 157070, 106118, 100520, 131819, 133883, 100513, 96292, 100525, 100426, 101702, 100494, 100477, 100534, 224826, 96291, 100257, 100528, 213727, 188865, 100514, 112561]
2023-11-16 08:59:54.131 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 738ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:54.131 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 65 for customer 176350
2023-11-16 08:59:54.131 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[240050, 100479, 100493, 100466, 100505, 100540, 100421, 204651, 100446, 100472, 100539, 215638, 147360, 177756, 101825, 262864, 269201, 180138, 100429, 100526, 258886, 88191, 114812, 100499, 285226, 100415, 103304, 102463, 103992, 100488, 173274, 175856, 100340, 173216, 101665, 175858, 204650, 235795, 100502, 268120, 175855, 175853, 269202, 175857, 157070, 106118, 100520, 131819, 133883, 100513, 96292, 100525, 100426, 101702, 100494, 100477, 100534, 224826, 96291, 100257, 100528, 213727, 188865, 100514, 112561]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}176350
2023-11-16 08:59:54.150 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [56, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 158309 and es.event_id = 19868343 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:54.150 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 56ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:54.154 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_158309
2023-11-16 08:59:54.154 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_158309
2023-11-16 08:59:54.157 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:54.157 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 158309 
2023-11-16 08:59:54.170 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[240050, 100479, 100493, 100466, 100505, 100540, 100421, 204651, 100446, 100472, 100539, 215638, 147360, 177756, 101825, 262864, 269201, 180138, 100429, 100526, 258886, 88191, 114812, 100499, 285226, 100415, 103304, 102463, 103992, 100488, 173274, 175856, 100340, 173216, 101665, 175858, 204650, 235795, 100502, 268120, 175855, 175853, 269202, 175857, 157070, 106118, 100520, 131819, 133883, 100513, 96292, 100525, 100426, 101702, 100494, 100477, 100534, 224826, 96291, 100257, 100528, 213727, 188865, 100514, 112561]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}176350
2023-11-16 08:59:54.171 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 39ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:54.171 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 176350 99446 user with No pref [240050, 100479, 100493, 100466, 100505, 100540, 100421, 204651, 100446, 100472, 100539, 215638, 147360, 177756, 101825, 262864, 269201, 180138, 100429, 100526, 258886, 88191, 114812, 100499, 285226, 100415, 103304, 102463, 103992, 100488, 173274, 175856, 100340, 173216, 101665, 175858, 204650, 235795, 100502, 268120, 175855, 175853, 269202, 175857, 157070, 106118, 100520, 131819, 133883, 100513, 96292, 100525, 100426, 101702, 100494, 100477, 100534, 224826, 96291, 100257, 100528, 213727, 188865, 100514, 112561]
2023-11-16 08:59:54.174 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 3ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:54.174 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 176350 99446 [100260, 100262, 100263, 100274, 100275, 100279, 100280, 100282, 100286, 100290, 100298, 100299, 100301, 100302, 100303, 100307, 100308, 100309, 100311, 100315, 100317, 100318, 100319, 100320, 100322, 100323, 100326, 100328, 100331, 100334, 100336, 100338, 100342, 100345, 100346, 100347, 100353, 100354, 100357, 100358, 100360, 100366, 100367, 100368, 100369, 100370, 100372, 100373, 100377, 100378, 100379, 100381, 100384, 100387, 100388, 100389, 100393, 100394, 100402, 100403, 100404, 100407, 100408, 100411, 100412, 100417, 100424, 100427, 100428, 100431, 100432, 100433, 100437, 100443, 100445, 100447, 100448, 100459, 100465, 100468, 100470, 100474, 100483, 100485, 100486, 100489, 100495, 100503, 100508, 100509, 100510, 100515, 100519, 100523, 100527, 100529, 100530, 100532, 100533, 100538, 100542, 101085, 101119, 101137, 101142, 103356, 106117, 112213, 112565, 112570, 114070, 132675, 132676, 133069, 135131, 146795, 153405, 153672, 154482, 155527, 157702, 160701, 160758, 166137, 166139, 169311, 169709, 170393, 170518, 172475, 172534, 172587, 173272, 175211, 179501, 180171, 180392, 185836, 185838, 188780, 192040, 193361, 193364, 194226, 196998, 199657, 204660, 204902, 204908, 205076, 205079, 205533, 212959, 213125, 215639, 219817, 224512, 224554, 224562, 224825, 230527, 230760, 231376, 231699, 235687, 235776, 235777, 241933, 249929, 249930, 249932, 249933, 249935, 249936, 250039, 252223, 257629, 262803, 267757, 267758, 267943, 267951, 269200, 269211, 292589, 292706]
2023-11-16 08:59:54.175 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  176350 99446 
2023-11-16 08:59:54.175 DEBUG 1 --- [     Thread-403] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 176350 99446 [100260, 100262, 100263, 100274, 100275, 100279, 100280, 100282, 100286, 100290, 100298, 100299, 100301, 100302, 100303, 100307, 100308, 100309, 100311, 100315, 100317, 100318, 100319, 100320, 100322, 100323, 100326, 100328, 100331, 100334, 100336, 100338, 100342, 100345, 100346, 100347, 100353, 100354, 100357, 100358, 100360, 100366, 100367, 100368, 100369, 100370, 100372, 100373, 100377, 100378, 100379, 100381, 100384, 100387, 100388, 100389, 100393, 100394, 100402, 100403, 100404, 100407, 100408, 100411, 100412, 100417, 100424, 100427, 100428, 100431, 100432, 100433, 100437, 100443, 100445, 100447, 100448, 100459, 100465, 100468, 100470, 100474, 100483, 100485, 100486, 100489, 100495, 100503, 100508, 100509, 100510, 100515, 100519, 100523, 100527, 100529, 100530, 100532, 100533, 100538, 100542, 101085, 101119, 101137, 101142, 103356, 106117, 112213, 112565, 112570, 114070, 132675, 132676, 133069, 135131, 146795, 153405, 153672, 154482, 155527, 157702, 160701, 160758, 166137, 166139, 169311, 169709, 170393, 170518, 172475, 172534, 172587, 173272, 175211, 179501, 180171, 180392, 185836, 185838, 188780, 192040, 193361, 193364, 194226, 196998, 199657, 204660, 204902, 204908, 205076, 205079, 205533, 212959, 213125, 215639, 219817, 224512, 224554, 224562, 224825, 230527, 230760, 231376, 231699, 235687, 235776, 235777, 241933, 249929, 249930, 249932, 249933, 249935, 249936, 250039, 252223, 257629, 262803, 267757, 267758, 267943, 267951, 269200, 269211, 292589, 292706]
2023-11-16 08:59:54.176 DEBUG 1 --- [     Thread-403] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 176350 99446 [100260, 100262, 100263, 100274, 100275, 100279, 100280, 100282, 100286, 100290, 100298, 100299, 100301, 100302, 100303, 100307, 100308, 100309, 100311, 100315, 100317, 100318, 100319, 100320, 100322, 100323, 100326, 100328, 100331, 100334, 100336, 100338, 100342, 100345, 100346, 100347, 100353, 100354, 100357, 100358, 100360, 100366, 100367, 100368, 100369, 100370, 100372, 100373, 100377, 100378, 100379, 100381, 100384, 100387, 100388, 100389, 100393, 100394, 100402, 100403, 100404, 100407, 100408, 100411, 100412, 100417, 100424, 100427, 100428, 100431, 100432, 100433, 100437, 100443, 100445, 100447, 100448, 100459, 100465, 100468, 100470, 100474, 100483, 100485, 100486, 100489, 100495, 100503, 100508, 100509, 100510, 100515, 100519, 100523, 100527, 100529, 100530, 100532, 100533, 100538, 100542, 101085, 101119, 101137, 101142, 103356, 106117, 112213, 112565, 112570, 114070, 132675, 132676, 133069, 135131, 146795, 153405, 153672, 154482, 155527, 157702, 160701, 160758, 166137, 166139, 169311, 169709, 170393, 170518, 172475, 172534, 172587, 173272, 175211, 179501, 180171, 180392, 185836, 185838, 188780, 192040, 193361, 193364, 194226, 196998, 199657, 204660, 204902, 204908, 205076, 205079, 205533, 212959, 213125, 215639, 219817, 224512, 224554, 224562, 224825, 230527, 230760, 231376, 231699, 235687, 235776, 235777, 241933, 249929, 249930, 249932, 249933, 249935, 249936, 250039, 252223, 257629, 262803, 267757, 267758, 267943, 267951, 269200, 269211, 292589, 292706]
2023-11-16 08:59:54.176 DEBUG 1 --- [     Thread-403] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 1ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:54.178 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  176350 99446 
2023-11-16 08:59:54.179 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 4ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:54.179 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 176350 99446 [100353, 235777, 100354, 224512, 235776, 100357, 157702, 100358, 100360, 100367, 241933, 100366, 100369, 101137, 100368, 100370, 100373, 170518, 205079, 100372, 101142, 205076, 100377, 100379, 100378, 100381, 100384, 100387, 100389, 100388, 100393, 192040, 100394, 179501, 100403, 100402, 100404, 100407, 100411, 224825, 252223, 100412, 153405, 100417, 132675, 132676, 100424, 249930, 100427, 153672, 249929, 249935, 100428, 100431, 249933, 249932, 100433, 100432, 193361, 100437, 112213, 215639, 193364, 100443, 100445, 169311, 100447, 257629, 100448, 204902, 292706, 146795, 100459, 230760, 188780, 204908, 100465, 154482, 100468, 100470, 204660, 100483, 100485, 106117, 155527, 196998, 213125, 100486, 100489, 100495, 269200, 100503, 114070, 262803, 100509, 100508, 100510, 269211, 100515, 267943, 235687, 100260, 100263, 100519, 100262, 100523, 180392, 219817, 267951, 100527, 100529, 194226, 100275, 100274, 100530, 100533, 112565, 250039, 100532, 100279, 100280, 172475, 100282, 100538, 112570, 103356, 100286, 100542, 160701, 100290, 180171, 100299, 100298, 100301, 100303, 100302, 133069, 100307, 231376, 100309, 100308, 100311, 135131, 100315, 173272, 100317, 101085, 100319, 205533, 100318, 100320, 100323, 100322, 100326, 100328, 267757, 292589, 100331, 199657, 267758, 185838, 185836, 100334, 169709, 100336, 100338, 160758, 100342, 100345, 166139, 100347, 100346, 101119]
2023-11-16 08:59:54.181 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 176350 99446 [100353, 235777, 100354, 224512, 235776, 100357, 157702, 100358, 100360, 100367, 241933, 100366, 100369, 101137, 100368, 100370, 100373, 170518, 205079, 100372, 101142, 205076, 100377, 100379, 100378, 100381, 100384, 100387, 100389, 100388, 100393, 192040, 100394, 179501, 100403, 100402, 100404, 100407, 100411, 224825, 252223, 100412, 153405, 100417, 132675, 132676, 100424, 249930, 100427, 153672, 249929, 249935, 100428, 100431, 249933, 249932, 100433, 100432, 193361, 100437, 112213, 215639, 193364, 100443, 100445, 169311, 100447, 257629, 100448, 204902, 292706, 146795, 100459, 230760, 188780, 204908, 100465, 154482, 100468, 100470, 204660, 100483, 100485, 106117, 155527, 196998, 213125, 100486, 100489, 100495, 269200, 100503, 114070, 262803, 100509, 100508, 100510, 269211, 100515, 267943, 235687, 100260, 100263, 100519, 100262, 100523, 180392, 219817, 267951, 100527, 100529, 194226, 100275, 100274, 100530, 100533, 112565, 250039, 100532, 100279, 100280, 172475, 100282, 100538, 112570, 103356, 100286, 100542, 160701, 100290, 180171, 100299, 100298, 100301, 100303, 100302, 133069, 100307, 231376, 100309, 100308, 100311, 135131, 100315, 173272, 100317, 101085, 100319, 205533, 100318, 100320, 100323, 100322, 100326, 100328, 267757, 292589, 100331, 199657, 267758, 185838, 185836, 100334, 169709, 100336, 100338, 160758, 100342, 100345, 166139, 100347, 100346, 101119]
2023-11-16 08:59:54.181 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 2ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:54.181 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 176350 99446 [100353, 235777, 100354, 224512, 235776, 100357, 157702, 100358, 100360, 100367, 241933, 100366, 100369, 101137, 100368, 100370, 100373, 170518, 205079, 100372, 101142, 205076, 100377, 100379, 100378, 100381, 100384, 100387, 100389, 100388, 100393, 192040, 100394, 179501, 100403, 100402, 100404, 100407, 100411, 224825, 252223, 100412, 153405, 100417, 132675, 132676, 100424, 249930, 100427, 153672, 249929, 249935, 100428, 100431, 249933, 249932, 100433, 100432, 193361, 100437, 112213, 215639, 193364, 100443, 100445, 169311, 100447, 257629, 100448, 204902, 292706, 146795, 100459, 230760, 188780, 204908, 100465, 154482, 100468, 100470, 204660, 100483, 100485, 106117, 155527, 196998, 213125, 100486, 100489, 100495, 269200, 100503, 114070, 262803, 100509, 100508, 100510, 269211, 100515, 267943, 235687, 100260, 100263, 100519, 100262, 100523, 180392, 219817, 267951, 100527, 100529, 194226, 100275, 100274, 100530, 100533, 112565, 250039, 100532, 100279, 100280, 172475, 100282, 100538, 112570, 103356, 100286, 100542, 160701, 100290, 180171, 100299, 100298, 100301, 100303, 100302, 133069, 100307, 231376, 100309, 100308, 100311, 135131, 100315, 173272, 100317, 101085, 100319, 205533, 100318, 100320, 100323, 100322, 100326, 100328, 267757, 292589, 100331, 199657, 267758, 185838, 185836, 100334, 169709, 100336, 100338, 160758, 100342, 100345, 166139, 100347, 100346, 101119]
2023-11-16 08:59:54.267 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 597ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:54.268 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.268  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 158309
2023-11-16 08:59:54.268 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158309 
2023-11-16 08:59:54.274 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158309 
2023-11-16 08:59:54.274  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:54.274 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 158309 
2023-11-16 08:59:54.274 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 158309
2023-11-16 08:59:54.284 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[5357]
2023-11-16 08:59:54.284 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 9ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:54.284 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 1 for customer 158309
2023-11-16 08:59:54.284 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158309
2023-11-16 08:59:54.293 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158309
2023-11-16 08:59:54.294 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 9ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:54.294 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 158309 99446 user with No pref [5357]
2023-11-16 08:59:54.295 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:54.295 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1008]: no user found with pref for this tenant Id 158309 and eventId 99446
2023-11-16 08:59:54.295 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 158309 99446
2023-11-16 08:59:54.295 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 158309
2023-11-16 08:59:54.296  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 158309
2023-11-16 08:59:54.296 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:54.296 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158309] 
2023-11-16 08:59:54.301 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 475791 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 475791), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =475791 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{37163,46086,49301,55741,96362,96474,96637,96949,97341,291017,300111,300113,300114,322705,426078,426484,492717,721088,722040,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 475791 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:54.302 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:54.302 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 6ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:54.302  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 158309, isUpdateAlert : true
2023-11-16 08:59:54.302  INFO 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:54.302 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 34ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:54.303 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 475791 
2023-11-16 08:59:54.303 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.303 DEBUG 1 --- [6_103335_158309] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:54.303  INFO 1 --- [6_103335_158309] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:54.304 DEBUG 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"ac7180cb-03d5-4319-bac3-aa3ad7bc73fd","eventId":19868343,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868343, tenantId : 158309
2023-11-16 08:59:54.306 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"ac7180cb-03d5-4319-bac3-aa3ad7bc73fd","eventId":19868343,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41794
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [] 
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158309] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158309, Took : 3s
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158270 
2023-11-16 08:59:54.306  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:54.307 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:54.328 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [25, with SITE_IDS as ( select unnest('{37163,46086,49301,55741,96362,96474,96637,96949,97341,291017,300111,300113,300114,322705,426078,426484,492717,721088,722040,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 475791 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:54.330 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 475791
2023-11-16 08:59:54.330 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 27ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:54.338 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 31ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:54.339 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.385 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 158270 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 158270), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =158270 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{443171,443493,443494,443495,443496}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158270 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:54.386 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 47ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:54.386 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 158270 
2023-11-16 08:59:54.386 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.410 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [23, with SITE_IDS as ( select unnest('{443171,443493,443494,443495,443496}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158270 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:54.411 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 158270
2023-11-16 08:59:54.411 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 24ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:54.524 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 31
2023-11-16 08:59:54.525  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 31
2023-11-16 08:59:54.525 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 31 
2023-11-16 08:59:54.526 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.530 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 475791, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:54.531 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868345 and EventDetID : 99446 
2023-11-16 08:59:54.531 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 475791
2023-11-16 08:59:54.531 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868345
2023-11-16 08:59:54.532 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.532 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868345 and Event_Details ID : 99446 
2023-11-16 08:59:54.532 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:54.532 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.532 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:54.534 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:?] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 475791 -- Resulted rows -- [1]
2023-11-16 08:59:54.534 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:54.534 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 475791 : false : false : 19868345 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:54.537 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 475791
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 475791
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 475791
2023-11-16 08:59:54.538  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 475791
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 475791 
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 475791 
2023-11-16 08:59:54.538 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.555 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158270, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:54.555 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868346 and EventDetID : 99446 
2023-11-16 08:59:54.555 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158270
2023-11-16 08:59:54.555 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868346
2023-11-16 08:59:54.556 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.556 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868346 and Event_Details ID : 99446 
2023-11-16 08:59:54.556 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:54.556 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.563 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:54.568 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158270 -- Resulted rows -- [1]
2023-11-16 08:59:54.568 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:54.568 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158270 : false : false : 19868346 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:54.570 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158270
2023-11-16 08:59:54.570 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:54.570 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 158270
2023-11-16 08:59:54.571 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158270
2023-11-16 08:59:54.571  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158270
2023-11-16 08:59:54.571 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 158270 
2023-11-16 08:59:54.571 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 158270 
2023-11-16 08:59:54.571 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.585 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (475791,75784,75804,3248,1375,7837,1449,75792,75811,1388,327,152724,1166,324,4473,451208,144203) and event_details_id = 99446] 
2023-11-16 08:59:54.589 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_475791
2023-11-16 08:59:54.589 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 475791
2023-11-16 08:59:54.589 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 51ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:54.589  INFO 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [475791]
2023-11-16 08:59:54.590  INFO 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [475791]
2023-11-16 08:59:54.590 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 475791 
2023-11-16 08:59:54.590 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 475791 
2023-11-16 08:59:54.590 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.597 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [71, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 31 and es.event_id = 19868342 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:54.597 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 71ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:54.601 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_31
2023-11-16 08:59:54.601 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_31
2023-11-16 08:59:54.604 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:54.604 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 31 
2023-11-16 08:59:54.614 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (158270,75792,75803) and event_details_id = 99446] 
2023-11-16 08:59:54.618 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_158270
2023-11-16 08:59:54.618 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 158270
2023-11-16 08:59:54.618 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 47ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:54.619  INFO 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [158270]
2023-11-16 08:59:54.619  INFO 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [158270]
2023-11-16 08:59:54.619 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158270 
2023-11-16 08:59:54.619 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158270 
2023-11-16 08:59:54.619 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.636 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 475791 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (37163,46086,49301,55741,96362,96474,96637,96949,97341,291017,300111,300113,300114,322705,426078,426484,492717,721088,722040,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136)] 
2023-11-16 08:59:54.638 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 475791
2023-11-16 08:59:54.638 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 47ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:54.658 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 1080ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:54.658 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.674  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 31
2023-11-16 08:59:54.674 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 31 
2023-11-16 08:59:54.677 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 31 
2023-11-16 08:59:54.677  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): false, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:54.677 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 31 
2023-11-16 08:59:54.677 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 31
2023-11-16 08:59:54.683 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [63, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 158270 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (443171,443493,443494,443495,443496)] 
2023-11-16 08:59:54.685 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158270
2023-11-16 08:59:54.685 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 65ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:54.699 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 779990 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 779990), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =779990 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{37163,46065,46086,46830,49301,96474,96637,96949,97341,291017,300111,300113,300114,322697,322705,366560,426078,426484,492717,534966,534974,534975,536498,654800,713557,721088,722040,723410,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136,1215175,1657144,1657571,1657954,1658551,1937757}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 779990 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:54.700 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 42ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:54.701 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 779990 
2023-11-16 08:59:54.701 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.721 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.740 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.748 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, with SITE_IDS as ( select unnest('{37163,46065,46086,46830,49301,96474,96637,96949,97341,291017,300111,300113,300114,322697,322705,366560,426078,426484,492717,534966,534974,534975,536498,654800,713557,721088,722040,723410,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136,1215175,1657144,1657571,1657954,1658551,1937757}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 779990 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:54.750 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 779990
2023-11-16 08:59:54.750 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 48ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:54.770 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [49, WITH SITE_IDS AS( SELECT UNNEST('{37163,37163,37163,37163,46086,46086,46086,49301,49301,49301,55741,96362,96474,96474,96474,96474,96474,96474,96474,96474,96637,96637,96637,96637,96637,96637,96637,96637,96949,97341,291017,291017,300111,300113,300114,322705,426078,426484,492717,492717,492717,492717,492717,492717,492717,721088,721088,721088,722040,722040,722040,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136,1189136}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[475791] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 475791 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:54.771 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 50ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:54.771 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 475791 
2023-11-16 08:59:54.773 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, WITH SITE_IDS AS( SELECT UNNEST('{443171,443171,443493,443493,443494,443494,443495,443495,443496,443496}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[158270] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 158270 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:54.773 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 33ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:54.774 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 158270 
2023-11-16 08:59:54.900 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 158270
2023-11-16 08:59:54.900 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 126ms : for accumlator : {}
2023-11-16 08:59:54.900 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 158270 
2023-11-16 08:59:54.906 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_158270
2023-11-16 08:59:54.906 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 5ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_158270
2023-11-16 08:59:54.906 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.912 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 475791
2023-11-16 08:59:54.913 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 141ms : for accumlator : {}
2023-11-16 08:59:54.913 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 475791 
2023-11-16 08:59:54.918 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_475791
2023-11-16 08:59:54.918 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 5ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_475791
2023-11-16 08:59:54.918 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.936 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 779990, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:54.936 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868344 and EventDetID : 99446 
2023-11-16 08:59:54.936 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 779990
2023-11-16 08:59:54.937 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868344
2023-11-16 08:59:54.937 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.937 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868344 and Event_Details ID : 99446 
2023-11-16 08:59:54.937 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:54.938 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:54.938 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:54.941 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 779990 -- Resulted rows -- [1]
2023-11-16 08:59:54.941 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:54.941 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 779990 : false : false : 19868344 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 779990
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 779990
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 779990
2023-11-16 08:59:54.943  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 779990
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 779990 
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 779990 
2023-11-16 08:59:54.943 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.953 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 158270 and total_cpns != '{}' and site_private_id = any('{2313063,2313390,2313391,2313392,2313393}')] 
2023-11-16 08:59:54.957 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 475791 and total_cpns != '{}' and site_private_id = any('{14773753,14773755,14773787,14775122,14776994,51984576,51984577,51984578,51984579,51984580,51984581,51986933,51986934,51988502,51988549,51988881,51989175,51989843,52199239,62865237,62865791,62866036,62867111,62867223,62867224,62867225,62867226}')] 
2023-11-16 08:59:54.958 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_158270
2023-11-16 08:59:54.958 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [?:?] : [createCustomerFinalView:1276]: Time taken : 52ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:54.958 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.965 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_475791
2023-11-16 08:59:54.968 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 49ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:54.968 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.981 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (779990,75804,3248,1375,1661,1449,75792,75811,11669,1388,327,2177,152724,1572,90,22682,1573,11243,1166,324,2156,4473,451208,144203,194315,11765,1369,1385,10202,1404) and event_details_id = 99446] 
2023-11-16 08:59:54.985 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_779990
2023-11-16 08:59:54.985 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 779990
2023-11-16 08:59:54.985 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 41ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:54.985  INFO 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [?:?] : Fetching Site Anchors Ids for tenantId - [779990]
2023-11-16 08:59:54.986  INFO 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [779990]
2023-11-16 08:59:54.986 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 779990 
2023-11-16 08:59:54.986 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 779990 
2023-11-16 08:59:54.987 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:54.998 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, with SITEID as( select * from ( select unnest(array[2313393,2313392,2313063,2313391,2313390]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:54.999 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 40ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:55.000 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, with SITEID as( select * from ( select unnest(array[62865791,14776994,51988881,51989843,62866036,51988502,14773753,51984577,62867111,51984576,14773755,51984579,51984578,52199239,51984581,51988549,51984580,62867226,62867225,62867224,62867223,62865237,51986933,51989175,51986934,14775122,14773787]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:55.000 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 32ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:55.003 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [?:?] : EVENT_SITE_ACTIVITY_SET_99446_475791
2023-11-16 08:59:55.003 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_158270
2023-11-16 08:59:55.003 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 44ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_158270
2023-11-16 08:59:55.003 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 35ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_475791
2023-11-16 08:59:55.017 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_158270
2023-11-16 08:59:55.017 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_475791
2023-11-16 08:59:55.017 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 14ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:55.017 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 14ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:55.018 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 475791
2023-11-16 08:59:55.018 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 158270
2023-11-16 08:59:55.020 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 779990 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (37163,46065,46086,46830,49301,96474,96637,96949,97341,291017,300111,300113,300114,322697,322705,366560,426078,426484,492717,534966,534974,534975,536498,654800,713557,721088,722040,723410,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136,1215175,1657144,1657571,1657954,1658551,1937757)] 
2023-11-16 08:59:55.022 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 779990
2023-11-16 08:59:55.022 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 35ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:55.025 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 475791 
2023-11-16 08:59:55.025 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 475791 
2023-11-16 08:59:55.025 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 475791 
2023-11-16 08:59:55.025 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.026 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158270 
2023-11-16 08:59:55.026 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 158270 
2023-11-16 08:59:55.026 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 158270 
2023-11-16 08:59:55.027 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.072 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [45, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868346 and tenant_id = 158270] 
2023-11-16 08:59:55.073 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 46ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:55.086 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.087 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [61, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868345 and tenant_id = 475791] 
2023-11-16 08:59:55.087 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 61ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:55.142 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_158270
2023-11-16 08:59:55.142 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_158270
2023-11-16 08:59:55.147 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [60, WITH SITE_IDS AS( SELECT UNNEST('{37163,37163,37163,37163,37163,37163,37163,37163,37163,37163,46065,46065,46065,46065,46086,46086,46086,46086,46086,46086,46086,46086,46086,46086,46086,46086,46086,46086,46830,46830,49301,49301,96474,96637,96949,97341,291017,291017,291017,291017,291017,291017,291017,291017,291017,291017,291017,291017,291017,291017,300111,300111,300111,300111,300111,300113,300113,300113,300113,300113,300114,300114,300114,300114,300114,322697,322697,322705,322705,322705,322705,322705,366560,366560,366560,366560,426078,426484,492717,534966,534966,534974,534974,534975,534975,536498,536498,654800,654800,654800,654800,654800,654800,654800,654800,713557,713557,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,721088,722040,722040,722040,722040,723410,723410,732853,732853,1019475,1019476,1019477,1019478,1019479,1019480,1189136,1189136,1215175,1215175,1657144,1657144,1657144,1657144,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657571,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1657954,1658551,1658551,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757,1937757}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[779990] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 779990 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:55.147 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 61ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:55.148 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 779990 
2023-11-16 08:59:55.153 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_158270
2023-11-16 08:59:55.154 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 11ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:55.164 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 9ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:55.164 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 158270 
2023-11-16 08:59:55.174 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_475791
2023-11-16 08:59:55.175 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 5ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_475791
2023-11-16 08:59:55.189 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_475791
2023-11-16 08:59:55.189 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 14ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:55.201 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 12ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:55.204 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 475791 
2023-11-16 08:59:55.326 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 779990
2023-11-16 08:59:55.326 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 178ms : for accumlator : {}
2023-11-16 08:59:55.326 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 779990 
2023-11-16 08:59:55.331 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_779990
2023-11-16 08:59:55.331 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_779990
2023-11-16 08:59:55.331 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.364 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 779990 and total_cpns != '{}' and site_private_id = any('{34534420,34534421,34534422,34534423,34534424,34534425,34536777,34536778,34537808,34537809,34537810,34537879,34538376,77838955,77839146,77839147,77839148,77839302,77840573,77840996,77841165,77842035,77842824,77843632,77843634,77843636,77843638,77844402,77844723,77844778,77844933,77846396,77846532,77846935,77848661,77849964,77849983,77850273,77851118,77852173,77852179,77852181}')] 
2023-11-16 08:59:55.370 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_779990
2023-11-16 08:59:55.370 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 38ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:55.370 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.392 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [21, with SITEID as( select * from ( select unnest(array[77850273,34536778,34536777,34538376,77840996,77838955,77839147,77839146,77844778,77851118,77839148,77849964,77842035,77844723,77843634,77844402,77843632,77843638,34534424,34534425,77843636,34534422,34537879,34534423,34534420,34534421,77849983,34537810,34537809,77840573,34537808,77846396,77839302,77844933,77846532,77842824,77841165,77852173,77852179,77846935,77848661,77852181]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:55.393 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 22ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:55.397 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_779990
2023-11-16 08:59:55.398 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 27ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_779990
2023-11-16 08:59:55.413 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_779990
2023-11-16 08:59:55.414 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 15ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:55.414 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 779990
2023-11-16 08:59:55.424 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 779990 
2023-11-16 08:59:55.424 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 779990 
2023-11-16 08:59:55.424 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 779990 
2023-11-16 08:59:55.424 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:55.472 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868344 and tenant_id = 779990] 
2023-11-16 08:59:55.472 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 47ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:55.879 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_779990
2023-11-16 08:59:55.879 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 5ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_779990
2023-11-16 08:59:55.891 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_779990
2023-11-16 08:59:55.891 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 12ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:55.905 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 13ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:55.907 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 779990 
2023-11-16 08:59:56.452 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 158270
2023-11-16 08:59:56.709 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 475791
2023-11-16 08:59:56.717 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 158270
2023-11-16 08:59:56.718  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 158270
2023-11-16 08:59:56.718 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 158270 
2023-11-16 08:59:56.723 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:56.723 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 158270 
2023-11-16 08:59:56.723  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 158270
2023-11-16 08:59:56.724 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 158270 
2023-11-16 08:59:56.724 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 158270 
2023-11-16 08:59:56.724 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:56.754 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 475791
2023-11-16 08:59:56.754  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 475791
2023-11-16 08:59:56.754 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 475791 
2023-11-16 08:59:56.759 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:56.759 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 475791 
2023-11-16 08:59:56.759  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 475791
2023-11-16 08:59:56.759 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 475791 
2023-11-16 08:59:56.759 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 475791 
2023-11-16 08:59:56.759 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:56.770 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, with SITE_IDS as(select unnest('{2288360,2288361,2288362,2288363,2288409}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[158270] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:56.770 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 46ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:56.770 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 158270
2023-11-16 08:59:56.811 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [51, with SITE_IDS as(select unnest('{14741,20145,24570,32749,44573,69853,80130,80261,108423,1204813,1233762,1233772,1233775,1857151,1857502,2917404,4727785,5369115,5370067,5690442,13887224,13887225,13887226,13887227,13887228,13887229,26110573}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[475791] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:56.811 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 51ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:56.811 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 475791
2023-11-16 08:59:57.018 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_158270
2023-11-16 08:59:57.018 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_158270
2023-11-16 08:59:57.018 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.064 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [45, with SITEID as( select * from ( select unnest(array[2288362,2288363,2288360,2288361,2288409]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:57.064 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 46ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:57.065 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 779990
2023-11-16 08:59:57.068 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158270
2023-11-16 08:59:57.068 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 49ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158270
2023-11-16 08:59:57.071 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_475791
2023-11-16 08:59:57.071 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_475791
2023-11-16 08:59:57.071 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.078 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_158270
2023-11-16 08:59:57.078 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:57.078 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 158270 
2023-11-16 08:59:57.078  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 158270
2023-11-16 08:59:57.110 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, with SITEID as( select * from ( select unnest(array[1857502,5370067,80130,80261,108423,5369115,14741,69853,5690442,44573,1204813,4727785,1857151,26110573,13887227,13887226,13887225,13887224,32749,13887229,13887228,1233762,2917404,20145,24570,1233775,1233772]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:57.111 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 39ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:57.114 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_475791
2023-11-16 08:59:57.114 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 42ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_475791
2023-11-16 08:59:57.122 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 779990
2023-11-16 08:59:57.123  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 779990
2023-11-16 08:59:57.123 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 779990 
2023-11-16 08:59:57.123 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_475791
2023-11-16 08:59:57.123 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:57.123 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 475791 
2023-11-16 08:59:57.123  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 475791
2023-11-16 08:59:57.127 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:57.127 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 779990 
2023-11-16 08:59:57.127  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 779990
2023-11-16 08:59:57.128 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 779990 
2023-11-16 08:59:57.128 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 779990 
2023-11-16 08:59:57.128 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.158 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 158270 
2023-11-16 08:59:57.162 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:57.163 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 158270 
2023-11-16 08:59:57.171 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 158270
2023-11-16 08:59:57.182 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 475791 
2023-11-16 08:59:57.187 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:57.187 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 475791 
2023-11-16 08:59:57.196 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [67, with SITE_IDS as(select unnest('{20145,24570,32749,48900,69853,80130,80261,89133,108423,1204813,1233762,1233772,1233775,1371403,1857151,1857502,2493241,2917404,3614160,3614168,3614169,3615692,4727785,4728572,5248775,5369115,5370067,5371434,5690442,13887224,13887225,13887226,13887227,13887228,13887229,26110573,27377105,52395395,52395825,52396211,52396809,60450749}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[779990] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 08:59:57.196 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 68ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 08:59:57.196 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 779990
2023-11-16 08:59:57.197 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 475791
2023-11-16 08:59:57.453 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_779990
2023-11-16 08:59:57.453 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_779990
2023-11-16 08:59:57.453 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.490 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with SITEID as( select * from ( select unnest(array[1857502,5370067,80130,48900,80261,108423,5369115,52396809,5248775,69853,5690442,52395395,1204813,1371403,2493241,4727785,1857151,26110573,3614160,60450749,13887227,13887226,13887225,13887224,89133,52396211,32749,3614169,13887229,52395825,3614168,13887228,1233762,2917404,27377105,20145,4728572,24570,3615692,5371434,1233775,1233772]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:57.490 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 36ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:57.493 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_779990
2023-11-16 08:59:57.493 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 39ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_779990
2023-11-16 08:59:57.502 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_779990
2023-11-16 08:59:57.502 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 8ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 08:59:57.502 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 779990 
2023-11-16 08:59:57.502  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 779990
2023-11-16 08:59:57.538 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 158270
2023-11-16 08:59:57.540  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 158270
2023-11-16 08:59:57.540 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 158270 
2023-11-16 08:59:57.540 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.591 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [51, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 158270 and es.event_id = 19868346 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:57.591 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 51ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:57.594 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 779990 
2023-11-16 08:59:57.595 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_158270
2023-11-16 08:59:57.595 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_158270
2023-11-16 08:59:57.598 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 2ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:57.598 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 3ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 08:59:57.598 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 779990 
2023-11-16 08:59:57.598 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 158270 
2023-11-16 08:59:57.607 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 779990
2023-11-16 08:59:57.629 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 475791
2023-11-16 08:59:57.630  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 475791
2023-11-16 08:59:57.630 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 475791 
2023-11-16 08:59:57.630 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.697 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [66, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 475791 and es.event_id = 19868345 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:57.697 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 66ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:57.700 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_475791
2023-11-16 08:59:57.700 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_475791
2023-11-16 08:59:57.703 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:57.704 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 475791 
2023-11-16 08:59:57.706  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 158270
2023-11-16 08:59:57.706 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158270 
2023-11-16 08:59:57.710 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158270 
2023-11-16 08:59:57.710  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:57.710 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 158270 
2023-11-16 08:59:57.710 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 158270
2023-11-16 08:59:57.730 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[5357]
2023-11-16 08:59:57.730 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 19ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:57.730 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 1 for customer 158270
2023-11-16 08:59:57.730 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158270
2023-11-16 08:59:57.737 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158270
2023-11-16 08:59:57.737 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 7ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:57.737 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 158270 99446 user with No pref [5357]
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1008]: no user found with pref for this tenant Id 158270 and eventId 99446
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 158270 99446
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 158270
2023-11-16 08:59:57.739  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 158270
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:57.739 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158270] 
2023-11-16 08:59:57.746 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:57.746 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 6ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:57.746  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 158270, isUpdateAlert : true
2023-11-16 08:59:57.746  INFO 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:57.746 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:57.747  INFO 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:57.747 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"6e9e16f6-5c00-4453-ac60-e6c6e7715235","eventId":19868346,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:57.749  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868346, tenantId : 158270
2023-11-16 08:59:57.749  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:57.749  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [75803] 
2023-11-16 08:59:57.749 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"6e9e16f6-5c00-4453-ac60-e6c6e7715235","eventId":19868346,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41795
2023-11-16 08:59:57.749 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.774  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 475791
2023-11-16 08:59:57.774 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 475791 
2023-11-16 08:59:57.778 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 475791 
2023-11-16 08:59:57.778  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:57.778 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 475791 
2023-11-16 08:59:57.778 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 475791
2023-11-16 08:59:57.807 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [57, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (75803)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:57.807 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 57ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:57.820 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[182265, 213456, 5357, 132982]
2023-11-16 08:59:57.820 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 41ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:57.820 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 4 for customer 475791
2023-11-16 08:59:57.820 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[182265, 213456, 5357, 132982]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}475791
2023-11-16 08:59:57.837 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[182265, 213456, 5357, 132982]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}475791
2023-11-16 08:59:57.837 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 16ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:57.837 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 475791 99446 user with No pref [182265, 213456, 5357, 132982]
2023-11-16 08:59:57.838 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:57.839 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 475791 99446 [101797, 240010, 240011, 240012, 240013, 240015, 240016, 240018, 240020, 240021, 240022, 240023, 240024, 240025, 240026, 240027, 240903, 253278, 253279, 253280]
2023-11-16 08:59:57.839 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  475791 99446 
2023-11-16 08:59:57.839 DEBUG 1 --- [     Thread-405] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 475791 99446 [101797, 240010, 240011, 240012, 240013, 240015, 240016, 240018, 240020, 240021, 240022, 240023, 240024, 240025, 240026, 240027, 240903, 253278, 253279, 253280]
2023-11-16 08:59:57.841 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  475791 99446 
2023-11-16 08:59:57.841 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:57.842 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279, 253278]
2023-11-16 08:59:57.845 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279, 253278]
2023-11-16 08:59:57.845 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 3ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:57.845 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279, 253278]
2023-11-16 08:59:57.848 DEBUG 1 --- [     Thread-405] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 475791 99446 [101797, 240010, 240011, 240012, 240013, 240015, 240016, 240018, 240020, 240021, 240022, 240023, 240024, 240025, 240026, 240027, 240903, 253278, 253279, 253280]
2023-11-16 08:59:57.848 DEBUG 1 --- [     Thread-405] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 9ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:57.877 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:57.913 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (75803)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:57.913 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 35ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:57.916 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_158270
2023-11-16 08:59:57.916 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_158270
2023-11-16 08:59:57.919 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_158270
2023-11-16 08:59:57.919 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 2ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_158270
2023-11-16 08:59:57.923 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 3ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:57.954 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279]
2023-11-16 08:59:57.955 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 109ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:57.955 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279]
2023-11-16 08:59:57.966 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 475791 99446 [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279]
2023-11-16 08:59:57.966 DEBUG 1 --- [     Thread-404] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 11ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:57.966 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 475791 and eventId 99446 and userIds [253280, 101797, 240903, 240011, 240010, 240015, 240013, 240012, 240018, 240016, 240023, 240021, 240020, 240027, 240026, 240025, 240024, 253279]
2023-11-16 08:59:57.966 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 475791 and eventId : 99446 
2023-11-16 08:59:57.966 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 18
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 13ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 475791 99446
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 475791
2023-11-16 08:59:57.980  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 475791
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:57.980 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [475791] 
2023-11-16 08:59:57.984 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:57.984 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:57.984  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 475791, isUpdateAlert : true
2023-11-16 08:59:57.984  INFO 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:57.985 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:57.985  INFO 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:57.985 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"1d2cb4f9-694d-4c69-80a5-6fe356ae5a1b","eventId":19868345,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:57.987  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868345, tenantId : 475791
2023-11-16 08:59:57.987 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"1d2cb4f9-694d-4c69-80a5-6fe356ae5a1b","eventId":19868345,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41796
2023-11-16 08:59:57.987  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:57.987  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [75784] 
2023-11-16 08:59:57.987 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.016 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (75784)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:58.016 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 29ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:58.049 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 779990
2023-11-16 08:59:58.050  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 779990
2023-11-16 08:59:58.050 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 779990 
2023-11-16 08:59:58.050 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.075  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 158270
2023-11-16 08:59:58.075 DEBUG 1 --- [6_103335_158270] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.092 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.093 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 779990 and es.event_id = 19868344 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 08:59:58.094 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 43ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 08:59:58.097 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_779990
2023-11-16 08:59:58.097 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_779990
2023-11-16 08:59:58.100 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 08:59:58.100 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 779990 
2023-11-16 08:59:58.118 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (75803) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:58.122 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_158270
2023-11-16 08:59:58.122 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 46ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:58.124 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:58.125 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (75784)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:58.126 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 33ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:58.129 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_475791
2023-11-16 08:59:58.129 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_475791
2023-11-16 08:59:58.132 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_475791
2023-11-16 08:59:58.133 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 3ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_475791
2023-11-16 08:59:58.137 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:58.178  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 779990
2023-11-16 08:59:58.178 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 779990 
2023-11-16 08:59:58.183 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 779990 
2023-11-16 08:59:58.183  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:58.183 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 779990 
2023-11-16 08:59:58.183 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 779990
2023-11-16 08:59:58.287  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 475791
2023-11-16 08:59:58.287 DEBUG 1 --- [6_103335_475791] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.296 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[213456, 5357, 101797, 106799, 269964]
2023-11-16 08:59:58.296 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 113ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:58.297 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 5 for customer 779990
2023-11-16 08:59:58.297 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[213456, 5357, 101797, 106799, 269964]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}779990
2023-11-16 08:59:58.306 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[213456, 5357, 101797, 106799, 269964]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}779990
2023-11-16 08:59:58.306 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 8ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:58.306 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 779990 99446 user with No pref [213456, 5357, 101797, 106799, 269964]
2023-11-16 08:59:58.307 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:58.307 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 779990 99446 [182265, 269965, 269966, 272797, 273847, 273849]
2023-11-16 08:59:58.308 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  779990 99446 
2023-11-16 08:59:58.308 DEBUG 1 --- [     Thread-407] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 779990 99446 [182265, 269965, 269966, 272797, 273847, 273849]
2023-11-16 08:59:58.310 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  779990 99446 
2023-11-16 08:59:58.310 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:58.310 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 779990 99446 [273847, 269965, 272797, 269966, 182265, 273849]
2023-11-16 08:59:58.311 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 779990 99446 [273847, 269965, 272797, 269966, 182265, 273849]
2023-11-16 08:59:58.311 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 1ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:58.312 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 779990 99446 [273847, 269965, 272797, 269966, 182265, 273849]
2023-11-16 08:59:58.315 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 779990 99446 [273847, 269965, 272797, 273849]
2023-11-16 08:59:58.315 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 3ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:58.315 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 779990 99446 [273847, 269965, 272797, 273849]
2023-11-16 08:59:58.315 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 779990 99446 [273847, 269965, 272797, 273849]
2023-11-16 08:59:58.315 DEBUG 1 --- [     Thread-406] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 08:59:58.323 DEBUG 1 --- [     Thread-407] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 779990 99446 [182265, 269965, 269966, 272797, 273847, 273849]
2023-11-16 08:59:58.323 DEBUG 1 --- [     Thread-407] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 15ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:58.323 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 779990 and eventId 99446 and userIds [273847, 269965, 272797, 273849]
2023-11-16 08:59:58.323 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 779990 and eventId : 99446 
2023-11-16 08:59:58.323 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 08:59:58.329 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 4
2023-11-16 08:59:58.329 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 6ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 08:59:58.330 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 779990 99446
2023-11-16 08:59:58.330 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 779990
2023-11-16 08:59:58.330  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 779990
2023-11-16 08:59:58.330 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 08:59:58.330 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [779990] 
2023-11-16 08:59:58.333 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:58.333 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:58.333  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 779990, isUpdateAlert : true
2023-11-16 08:59:58.333  INFO 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:58.334 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 08:59:58.334  INFO 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 08:59:58.335 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"a5a05403-e4db-4406-9b57-34bd21ccd9d7","eventId":19868344,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 08:59:58.336  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868344, tenantId : 779990
2023-11-16 08:59:58.336 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"a5a05403-e4db-4406-9b57-34bd21ccd9d7","eventId":19868344,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41797
2023-11-16 08:59:58.337  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 08:59:58.337  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [3248, 1661, 327, 1572, 1573, 11243, 1166, 324, 2156, 4473, 194315, 11765, 1385, 10202] 
2023-11-16 08:59:58.337 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.351 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [63, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (75784) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:58.354 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_475791
2023-11-16 08:59:58.355 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 67ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:58.357 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:58.380 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (3248,1661,327,1572,1573,11243,1166,324,2156,4473,194315,11765,1385,10202)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 08:59:58.381 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 109ms : for accumulator : {}
2023-11-16 08:59:58.381 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 158270
2023-11-16 08:59:58.381 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 44ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 08:59:58.393 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[244090, 243523, 6145, 169627, 88018, 7273, 286338, 302338, 72703, 225448, 87151, 217572, 262864, 91747, 154800, 185254, 106799, 249036, 177642, 88191, 275991, 197257, 302298, 219960, 217277, 266496, 277909, 224843, 272723, 6743, 6021, 258300, 6356, 220492, 135732, 166105, 173604, 266498, 185834, 91259, 92642, 269258, 274259, 196739, 286170, 112746, 280592, 153841, 81060, 192764, 294029, 270271, 237084, 213959, 242, 7173, 174263, 214246, 192505, 266497, 302317, 214999, 101797, 216411, 241750, 279921, 182265]
2023-11-16 08:59:58.394 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 3716ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 08:59:58.394 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 67 for customer 31
2023-11-16 08:59:58.394 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[244090, 243523, 6145, 169627, 88018, 7273, 286338, 302338, 72703, 225448, 87151, 217572, 262864, 91747, 154800, 185254, 106799, 249036, 177642, 88191, 275991, 197257, 302298, 219960, 217277, 266496, 277909, 224843, 272723, 6743, 6021, 258300, 6356, 220492, 135732, 166105, 173604, 266498, 185834, 91259, 92642, 269258, 274259, 196739, 286170, 112746, 280592, 153841, 81060, 192764, 294029, 270271, 237084, 213959, 242, 7173, 174263, 214246, 192505, 266497, 302317, 214999, 101797, 216411, 241750, 279921, 182265]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}31
2023-11-16 08:59:58.414 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[244090, 243523, 6145, 169627, 88018, 7273, 286338, 302338, 72703, 225448, 87151, 217572, 262864, 91747, 154800, 185254, 106799, 249036, 177642, 88191, 275991, 197257, 302298, 219960, 217277, 266496, 277909, 224843, 272723, 6743, 6021, 258300, 6356, 220492, 135732, 166105, 173604, 266498, 185834, 91259, 92642, 269258, 274259, 196739, 286170, 112746, 280592, 153841, 81060, 192764, 294029, 270271, 237084, 213959, 242, 7173, 174263, 214246, 192505, 266497, 302317, 214999, 101797, 216411, 241750, 279921, 182265]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}31
2023-11-16 08:59:58.414 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 20ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 08:59:58.414 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 31 99446 user with No pref [244090, 243523, 6145, 169627, 88018, 7273, 286338, 302338, 72703, 225448, 87151, 217572, 262864, 91747, 154800, 185254, 106799, 249036, 177642, 88191, 275991, 197257, 302298, 219960, 217277, 266496, 277909, 224843, 272723, 6743, 6021, 258300, 6356, 220492, 135732, 166105, 173604, 266498, 185834, 91259, 92642, 269258, 274259, 196739, 286170, 112746, 280592, 153841, 81060, 192764, 294029, 270271, 237084, 213959, 242, 7173, 174263, 214246, 192505, 266497, 302317, 214999, 101797, 216411, 241750, 279921, 182265]
2023-11-16 08:59:58.416 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 2ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 08:59:58.416 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 31 99446 [453, 5357, 6249, 71631, 112046, 132982, 134954, 153875, 154990, 169629, 178873, 188701, 192878, 199695, 204477, 206011, 213456, 215343, 216469, 217276, 224835, 251828, 253350, 294028, 302296, 302487]
2023-11-16 08:59:58.417 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  31 99446 
2023-11-16 08:59:58.417 DEBUG 1 --- [     Thread-409] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 31 99446 [453, 5357, 6249, 71631, 112046, 132982, 134954, 153875, 154990, 169629, 178873, 188701, 192878, 199695, 204477, 206011, 213456, 215343, 216469, 217276, 224835, 251828, 253350, 294028, 302296, 302487]
2023-11-16 08:59:58.417 DEBUG 1 --- [6_103335_158270] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 158270
2023-11-16 08:59:58.418  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 158270
2023-11-16 08:59:58.418  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:58.419 DEBUG 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[75803],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:58.420 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  31 99446 
2023-11-16 08:59:58.420 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 08:59:58.420 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 31 99446 [224835, 453, 253350, 134954, 294028, 6249, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 251828, 206011, 178873, 302296, 204477, 188701, 217276]
2023-11-16 08:59:58.420  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [75803]
2023-11-16 08:59:58.420 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[75803],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22849
2023-11-16 08:59:58.420  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:58.420  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:58.420  INFO 1 --- [6_103335_158270] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158270, Took : 4s
2023-11-16 08:59:58.420  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1239562 
2023-11-16 08:59:58.420  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.421 DEBUG 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:58.426 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 31 99446 [224835, 453, 253350, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 204477, 188701, 217276]
2023-11-16 08:59:58.426 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 6ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 08:59:58.426 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 31 99446 [224835, 453, 253350, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 204477, 188701, 217276]
2023-11-16 08:59:58.436 DEBUG 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 14ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 08:59:58.436 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1239562, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 08:59:58.436 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 08:59:58.436 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1239562
2023-11-16 08:59:58.437 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868347
2023-11-16 08:59:58.437 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.437 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 08:59:58.437 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:58.437 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.438 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:58.439 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.440 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1239562 -- Resulted rows -- [1]
2023-11-16 08:59:58.440 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 08:59:58.440 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1239562 : null : null : 19868347 : Update published
2023-11-16 08:59:58.446 DEBUG 1 --- [     Thread-409] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 31 99446 [453, 5357, 6249, 71631, 112046, 132982, 134954, 153875, 154990, 169629, 178873, 188701, 192878, 199695, 204477, 206011, 213456, 215343, 216469, 217276, 224835, 251828, 253350, 294028, 302296, 302487]
2023-11-16 08:59:58.446 DEBUG 1 --- [     Thread-409] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 28ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 08:59:58.447 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1239562
2023-11-16 08:59:58.447 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 7ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:58.448 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1239562
2023-11-16 08:59:58.448  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1239562
2023-11-16 08:59:58.448  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1239562 
2023-11-16 08:59:58.448 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 08:59:58.448 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1239562] 
2023-11-16 08:59:58.450 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:58.450 DEBUG 1 --- [_103335_1239562] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:58.450 DEBUG 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1239562 
2023-11-16 08:59:58.450 DEBUG 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1239562 
2023-11-16 08:59:58.450  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.450  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:58.450  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:58.450  INFO 1 --- [_103335_1239562] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1239562, Took : 0s
2023-11-16 08:59:58.450  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 130478 
2023-11-16 08:59:58.450  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.451 DEBUG 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:58.479 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (3248,1661,327,1572,1573,11243,1166,324,2156,4473,194315,11765,1385,10202)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 08:59:58.479 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 40ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 08:59:58.483 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_779990
2023-11-16 08:59:58.483 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_779990
2023-11-16 08:59:58.486 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_779990
2023-11-16 08:59:58.486 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 3ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_779990
2023-11-16 08:59:58.491 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 08:59:58.505 DEBUG 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 53ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 08:59:58.505 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 130478, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 08:59:58.505 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 08:59:58.505 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 130478
2023-11-16 08:59:58.511 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868348
2023-11-16 08:59:58.512 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 6ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.512 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 08:59:58.512 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:58.512 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.512 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:58.515 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 130478 -- Resulted rows -- [1]
2023-11-16 08:59:58.515 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 08:59:58.515 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 130478 : null : null : 19868348 : Update published
2023-11-16 08:59:58.517 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 130478
2023-11-16 08:59:58.517 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:58.517 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 130478
2023-11-16 08:59:58.517  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 130478
2023-11-16 08:59:58.517  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 130478 
2023-11-16 08:59:58.517 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 08:59:58.517 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [130478] 
2023-11-16 08:59:58.519 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:58.519 DEBUG 1 --- [6_103335_130478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:58.519 DEBUG 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 130478 
2023-11-16 08:59:58.519 DEBUG 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 130478 
2023-11-16 08:59:58.519  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.520  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:58.520  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:58.520  INFO 1 --- [6_103335_130478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 130478, Took : 0s
2023-11-16 08:59:58.520  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 940989 
2023-11-16 08:59:58.520  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.521 DEBUG 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:58.547 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 65ms : for accumulator : {}
2023-11-16 08:59:58.547 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 475791
2023-11-16 08:59:58.588 DEBUG 1 --- [6_103335_475791] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 475791
2023-11-16 08:59:58.589  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 475791
2023-11-16 08:59:58.589  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:58.589 DEBUG 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[75784],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [75784]
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:58.591 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[75784],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22850
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_475791] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 475791, Took : 4s
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158314 
2023-11-16 08:59:58.591  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:58.593 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 1ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:58.607 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 14ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:58.607 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.610 DEBUG 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 89ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:58.610 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 940989, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 08:59:58.610 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868349 and EventDetID : 99446 
2023-11-16 08:59:58.610 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 940989
2023-11-16 08:59:58.611 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868349
2023-11-16 08:59:58.611 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.611 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868349 and Event_Details ID : 99446 
2023-11-16 08:59:58.611 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:58.611 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.612 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:58.615 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 940989 -- Resulted rows -- [1]
2023-11-16 08:59:58.615 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 08:59:58.615 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 940989 : null : null : 19868349 : Update published
2023-11-16 08:59:58.617 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 940989
2023-11-16 08:59:58.617 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:58.617 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 940989
2023-11-16 08:59:58.617  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 940989
2023-11-16 08:59:58.617  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 940989 
2023-11-16 08:59:58.617 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 08:59:58.617 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [940989] 
2023-11-16 08:59:58.620 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 08:59:58.620 DEBUG 1 --- [6_103335_940989] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 08:59:58.620 DEBUG 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 940989 
2023-11-16 08:59:58.620 DEBUG 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 940989 
2023-11-16 08:59:58.620  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 08:59:58.620  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:58.620  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:58.620  INFO 1 --- [6_103335_940989] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 940989, Took : 0s
2023-11-16 08:59:58.620  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 129783 
2023-11-16 08:59:58.621  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:58.622 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:58.635 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 158314 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 158314), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =158314 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{29048,46065,46086,722040}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158314 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:58.638 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 30ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:58.638 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 158314 
2023-11-16 08:59:58.638 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.649  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 779990
2023-11-16 08:59:58.650 DEBUG 1 --- [6_103335_779990] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.663 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [25, with SITE_IDS as ( select unnest('{29048,46065,46086,722040}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 158314 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:58.665 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 158314
2023-11-16 08:59:58.665 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 26ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:58.686 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (3248,1661,327,1572,1573,11243,1166,324,2156,4473,194315,11765,1385,10202) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 08:59:58.690 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_779990
2023-11-16 08:59:58.690 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 40ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 08:59:58.694 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 3ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 08:59:58.755 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:?] : [getSiteAnchorsForUpdate:853]: Time taken : 132ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:58.755 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.792 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 129783 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 129783), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =129783 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{321268,321503,321727,321728,321729,321730,321731,321912}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 129783 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:58.793 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 38ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:58.793 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 129783 
2023-11-16 08:59:58.793 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.820 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158314, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868350 and EventDetID : 99446 
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158314
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868350
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868350 and Event_Details ID : 99446 
2023-11-16 08:59:58.821 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:58.822 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.822 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:58.832 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, with SITE_IDS as ( select unnest('{321268,321503,321727,321728,321729,321730,321731,321912}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 129783 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:58.833 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 129783
2023-11-16 08:59:58.833 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 39ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 08:59:58.837 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158314 -- Resulted rows -- [1]
2023-11-16 08:59:58.837 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 15ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:58.837 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158314 : false : false : 19868350 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:58.841 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158314
2023-11-16 08:59:58.841 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:58.841 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 158314
2023-11-16 08:59:58.841 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158314
2023-11-16 08:59:58.841  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158314
2023-11-16 08:59:58.842 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 158314 
2023-11-16 08:59:58.842 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 158314 
2023-11-16 08:59:58.842 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.874 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (158314,11669) and event_details_id = 99446] 
2023-11-16 08:59:58.877 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_158314
2023-11-16 08:59:58.877 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 158314
2023-11-16 08:59:58.877 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 35ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:58.877  INFO 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [158314]
2023-11-16 08:59:58.878  INFO 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [158314]
2023-11-16 08:59:58.878 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158314 
2023-11-16 08:59:58.878 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158314 
2023-11-16 08:59:58.878 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.915 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 158314 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (46065)] 
2023-11-16 08:59:58.917 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 158314
2023-11-16 08:59:58.917 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 38ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:58.982 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:58.990 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 129783, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 08:59:58.990 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868351 and EventDetID : 99446 
2023-11-16 08:59:58.990 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 129783
2023-11-16 08:59:58.990 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868351
2023-11-16 08:59:58.991 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.991 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868351 and Event_Details ID : 99446 
2023-11-16 08:59:58.991 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 08:59:58.991 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 08:59:58.992 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 08:59:58.995 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 129783 -- Resulted rows -- [1]
2023-11-16 08:59:58.995 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 08:59:58.995 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 129783 : false : false : 19868351 : WarRoom Updated : New Regions/Sites added
2023-11-16 08:59:58.997 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 129783
2023-11-16 08:59:58.997 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 08:59:58.998 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 129783
2023-11-16 08:59:58.998 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 129783
2023-11-16 08:59:58.998  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 129783
2023-11-16 08:59:58.998 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 129783 
2023-11-16 08:59:58.998 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 129783 
2023-11-16 08:59:58.998 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.042 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (129783,130572,130555,130576,130575) and event_details_id = 99446] 
2023-11-16 08:59:59.043 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [60, WITH SITE_IDS AS( SELECT UNNEST('{46065}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[158314] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 158314 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:59.043 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 61ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:59.044 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 158314 
2023-11-16 08:59:59.046 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_129783
2023-11-16 08:59:59.046 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 129783
2023-11-16 08:59:59.047 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 48ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 08:59:59.047  INFO 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [129783]
2023-11-16 08:59:59.048  INFO 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [129783]
2023-11-16 08:59:59.048 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 129783 
2023-11-16 08:59:59.048 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 129783 
2023-11-16 08:59:59.048 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.103 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [54, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 129783 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (321268,321503,321727,321728,321729,321730,321731,321912)] 
2023-11-16 08:59:59.104 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 129783
2023-11-16 08:59:59.104 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 56ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 08:59:59.152 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.164 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 158314
2023-11-16 08:59:59.164 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 119ms : for accumlator : {}
2023-11-16 08:59:59.164 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 158314 
2023-11-16 08:59:59.168 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_158314
2023-11-16 08:59:59.168 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 3ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_158314
2023-11-16 08:59:59.168 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.178 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 97ms : for accumulator : {}
2023-11-16 08:59:59.178 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 779990
2023-11-16 08:59:59.201 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 158314 and total_cpns != '{}' and site_private_id = any('{74356663}')] 
2023-11-16 08:59:59.205 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_158314
2023-11-16 08:59:59.205 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 37ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:59.205 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.230 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [77, WITH SITE_IDS AS( SELECT UNNEST('{321268,321503,321727,321727,321727,321727,321727,321728,321728,321728,321728,321728,321729,321729,321729,321729,321729,321730,321730,321730,321730,321730,321731,321731,321731,321731,321731,321912}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[129783] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 129783 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 08:59:59.231 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 78ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 08:59:59.231 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 129783 
2023-11-16 08:59:59.242 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with SITEID as( select * from ( select unnest(array[74356663]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:59.242 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 36ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:59.246 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_158314
2023-11-16 08:59:59.246 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 40ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_158314
2023-11-16 08:59:59.258 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_158314
2023-11-16 08:59:59.258 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 11ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:59.258 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 158314
2023-11-16 08:59:59.265 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 158314 
2023-11-16 08:59:59.265 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 158314 
2023-11-16 08:59:59.265 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 158314 
2023-11-16 08:59:59.265 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.308 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868350 and tenant_id = 158314] 
2023-11-16 08:59:59.309 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 43ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:59.368 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 129783
2023-11-16 08:59:59.368 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 137ms : for accumlator : {}
2023-11-16 08:59:59.368 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 129783 
2023-11-16 08:59:59.372 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_129783
2023-11-16 08:59:59.372 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_129783
2023-11-16 08:59:59.373 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.374 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_158314
2023-11-16 08:59:59.375 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_158314
2023-11-16 08:59:59.389 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_158314
2023-11-16 08:59:59.389 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 14ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:59.401 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 12ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:59.402 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 158314 
2023-11-16 08:59:59.413 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 129783 and total_cpns != '{}' and site_private_id = any('{1368815,1368816,1368817,1368818,1368819,1368820,1368821,1368822}')] 
2023-11-16 08:59:59.418 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_129783
2023-11-16 08:59:59.418 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 45ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 08:59:59.419 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.462 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, with SITEID as( select * from ( select unnest(array[1368820,1368821,1368822,1368816,1368817,1368818,1368819,1368815]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 08:59:59.463 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 44ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 08:59:59.466 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_129783
2023-11-16 08:59:59.466 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 47ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_129783
2023-11-16 08:59:59.479 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_129783
2023-11-16 08:59:59.479 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 12ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 08:59:59.479 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 129783
2023-11-16 08:59:59.488 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 129783 
2023-11-16 08:59:59.488 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 129783 
2023-11-16 08:59:59.488 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 129783 
2023-11-16 08:59:59.489 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.492 DEBUG 1 --- [6_103335_779990] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 779990
2023-11-16 08:59:59.494  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 779990
2023-11-16 08:59:59.494  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 08:59:59.495 DEBUG 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[11243,4473,194315,324,1572,1166,327,1661,10202,1573,1385,11765,2156,3248],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 08:59:59.496  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [11243, 4473, 194315, 324, 1572, 1166, 327, 1661, 10202, 1573, 1385, 11765, 2156, 3248]
2023-11-16 08:59:59.496 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[11243,4473,194315,324,1572,1166,327,1661,10202,1573,1385,11765,2156,3248],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22851
2023-11-16 08:59:59.496  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 08:59:59.496  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 08:59:59.496  INFO 1 --- [6_103335_779990] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 779990, Took : 5s
2023-11-16 08:59:59.497  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 200919 
2023-11-16 08:59:59.497  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 08:59:59.499 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 08:59:59.557 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [68, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868351 and tenant_id = 129783] 
2023-11-16 08:59:59.557 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 68ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 08:59:59.617 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_129783
2023-11-16 08:59:59.617 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_129783
2023-11-16 08:59:59.628 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_129783
2023-11-16 08:59:59.628 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 10ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 08:59:59.637 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 9ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 08:59:59.640 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 129783 
2023-11-16 08:59:59.853 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 354ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 08:59:59.853 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.915 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [61, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 200919 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 200919), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =200919 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{637451,637452,637655,637658,638268,638620,638772,639085,639086,639297,639874,640351,640777,640778,641657,641744,644449,644450,645110,645112,645113,645114,645751,645905,647184,647565,647873,648302,648383,648596,648677,648684,648687,648688,648693,648695,648696,648702,769742,769811,974043,974076,974483,974484,974515,975311,1017067,1017072,1050775,1050776,1050777,1050778,1050779,1050780}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 200919 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 08:59:59.917 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 63ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 08:59:59.917 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 200919 
2023-11-16 08:59:59.917 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 08:59:59.952 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, with SITE_IDS as ( select unnest('{637451,637452,637655,637658,638268,638620,638772,639085,639086,639297,639874,640351,640777,640778,641657,641744,644449,644450,645110,645112,645113,645114,645751,645905,647184,647565,647873,648302,648383,648596,648677,648684,648687,648688,648693,648695,648696,648702,769742,769811,974043,974076,974483,974484,974515,975311,1017067,1017072,1050775,1050776,1050777,1050778,1050779,1050780}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 200919 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 08:59:59.954 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 200919
2023-11-16 08:59:59.954 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 36ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:00.234 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 158314
2023-11-16 09:00:00.464 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 158314
2023-11-16 09:00:00.465  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 158314
2023-11-16 09:00:00.465 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 158314 
2023-11-16 09:00:00.470 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:00.470 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 158314 
2023-11-16 09:00:00.470  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 158314
2023-11-16 09:00:00.470 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 158314 
2023-11-16 09:00:00.470 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 158314 
2023-11-16 09:00:00.470 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:00.541 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [70, with SITE_IDS as(select unnest('{89133}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[158314] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:00.541 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 70ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:00.541 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 158314
2023-11-16 09:00:00.542 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 200919, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:00.542 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868353 and EventDetID : 99446 
2023-11-16 09:00:00.542 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 200919
2023-11-16 09:00:00.549 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868353
2023-11-16 09:00:00.549 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 7ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:00.550 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868353 and Event_Details ID : 99446 
2023-11-16 09:00:00.550 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:00.553 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 3ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:00.556 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:00.563 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 200919 -- Resulted rows -- [1]
2023-11-16 09:00:00.563 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 6ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:00.563 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 200919 : false : false : 19868353 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:00.568 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 200919
2023-11-16 09:00:00.568 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:00.568 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 200919
2023-11-16 09:00:00.568 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 200919
2023-11-16 09:00:00.568  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 200919
2023-11-16 09:00:00.569 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 200919 
2023-11-16 09:00:00.569 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 200919 
2023-11-16 09:00:00.569 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:00.618 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [49, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (200919,13786,10910,1569,131911,1432,2200,179083,5028,8014,180680,202372,2270,201572,11879,202371,2177,160448,1449,129257,182734,1446,311,140726,1366,1388,12438,10624,1375,42360,770,45992,176922,202393,127954,128989,148401,239673,442359,476544) and event_details_id = 99446] 
2023-11-16 09:00:00.621 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_200919
2023-11-16 09:00:00.621 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 200919
2023-11-16 09:00:00.622 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 52ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:00.622  INFO 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [200919]
2023-11-16 09:00:00.630  INFO 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [200919]
2023-11-16 09:00:00.630 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 200919 
2023-11-16 09:00:00.630 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 200919 
2023-11-16 09:00:00.631 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:00.682 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [51, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 200919 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (637451,637452,637655,637658,638268,638620,638772,639085,639086,639297,639874,640351,640777,640778,641657,641744,644449,644450,645110,645112,645113,645114,645751,645905,647184,647565,647873,648302,648383,648596,648677,648684,648687,648688,648693,648695,648696,648702,769742,769811,974043,974076,974483,974484,974515,975311,1017067,1017072,1050775,1050776,1050777,1050778,1050779,1050780)] 
2023-11-16 09:00:00.684 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 200919
2023-11-16 09:00:00.684 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 53ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:00.754 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:00.823 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_158314
2023-11-16 09:00:00.823 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 55ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_158314
2023-11-16 09:00:00.823 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:00.845 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [90, WITH SITE_IDS AS( SELECT UNNEST('{637451,637452,637655,637658,638268,638620,638772,639085,639086,639297,639874,640351,640777,640778,641657,641744,644449,644450,645110,645112,645113,645114,645751,645905,647184,647565,647873,648302,648383,648596,648677,648684,648687,648688,648693,648695,648696,648702,769742,769811,974043,974076,974483,974484,974515,975311,1017067,1017072,1050775,1050776,1050777,1050778,1050779,1050780}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[200919] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 200919 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:00.846 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 91ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:00.846 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 200919 
2023-11-16 09:00:00.870 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, with SITEID as( select * from ( select unnest(array[89133]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:00.870 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 46ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:00.874 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158314
2023-11-16 09:00:00.874 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 51ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_158314
2023-11-16 09:00:00.885 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_158314
2023-11-16 09:00:00.885 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 10ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:00.885 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 158314 
2023-11-16 09:00:00.885  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 158314
2023-11-16 09:00:00.982 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 158314 
2023-11-16 09:00:00.987 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 129783
2023-11-16 09:00:00.990 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 7ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:00.990 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 158314 
2023-11-16 09:00:00.996 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 200919
2023-11-16 09:00:00.996 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 149ms : for accumlator : {}
2023-11-16 09:00:00.996 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 200919 
2023-11-16 09:00:01.000 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_200919
2023-11-16 09:00:01.001 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_200919
2023-11-16 09:00:01.001 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.003 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 158314
2023-11-16 09:00:01.062 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 129783
2023-11-16 09:00:01.063  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 129783
2023-11-16 09:00:01.063 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 129783 
2023-11-16 09:00:01.068 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:01.068 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 129783 
2023-11-16 09:00:01.068  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 129783
2023-11-16 09:00:01.068 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 129783 
2023-11-16 09:00:01.068 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 129783 
2023-11-16 09:00:01.068 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.074 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [72, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 200919 and total_cpns != '{}' and site_private_id = any('{4531195,4531196,4531447,4531450,4532138,4532508,4532668,4532997,4532998,4533221,4533879,4534385,4534832,4534833,4535801,4535892,4538881,4538882,4539594,4539596,4539597,4539598,4540274,4540434,4541855,4542327,4542665,4543159,4543252,4543486,4543578,4543585,4543588,4543589,4543594,4543596,4543597,4543603,6954754,6954894,12019423,12019498,12020517,12020518,12020569,12022453,13744978,13745823,22597842,22597844,22599348,22599349,22599350,22599351}')] 
2023-11-16 09:00:01.077 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_200919
2023-11-16 09:00:01.078 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 76ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:01.078 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.102 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [23, with SITEID as( select * from ( select unnest(array[12022453,13744978,4539597,4539596,22597842,4539598,4542665,22597844,4539594,4535892,12020518,12020517,12019498,4543578,4533221,4543589,4543588,4543585,4543597,4543596,4543594,4531447,4533879,4542327,4534385,4543603,4540274,4531196,4543486,4535801,4531195,4531450,4532997,4532998,4538881,4538882,13745823,4543252,4540434,4532508,4541855,6954894,6954754,12019423,22599348,22599349,12020569,22599350,4532138,22599351,4543159,4534833,4534832,4532668]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:01.102 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 24ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:01.105 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_200919
2023-11-16 09:00:01.105 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 27ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_200919
2023-11-16 09:00:01.116 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_200919
2023-11-16 09:00:01.116 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 10ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:01.117 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 200919
2023-11-16 09:00:01.124 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 200919 
2023-11-16 09:00:01.124 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 200919 
2023-11-16 09:00:01.124 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 200919 
2023-11-16 09:00:01.124 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.135 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [66, with SITE_IDS as(select unnest('{1370182,1370183,1370184,1370185,1370186,1370187,1370188,1370189}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[129783] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:01.135 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 67ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:01.135 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 129783
2023-11-16 09:00:01.205 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [80, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868353 and tenant_id = 200919] 
2023-11-16 09:00:01.205 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 81ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:01.392 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_200919
2023-11-16 09:00:01.392 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_200919
2023-11-16 09:00:01.403 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_200919
2023-11-16 09:00:01.403 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 11ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:01.414 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 10ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:01.416 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 200919 
2023-11-16 09:00:01.418 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 158314
2023-11-16 09:00:01.418  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 158314
2023-11-16 09:00:01.418 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 158314 
2023-11-16 09:00:01.418 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.456 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_129783
2023-11-16 09:00:01.456 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 3ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_129783
2023-11-16 09:00:01.456 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.483 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [65, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 158314 and es.event_id = 19868350 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:01.484 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 65ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:01.487 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_158314
2023-11-16 09:00:01.487 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_158314
2023-11-16 09:00:01.490 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 2ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:01.491 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 158314 
2023-11-16 09:00:01.509 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [53, with SITEID as( select * from ( select unnest(array[1370182,1370183,1370188,1370189,1370184,1370185,1370186,1370187]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:01.510 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 54ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:01.513 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_129783
2023-11-16 09:00:01.513 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 57ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_129783
2023-11-16 09:00:01.522 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_129783
2023-11-16 09:00:01.523 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:01.523 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 129783 
2023-11-16 09:00:01.523  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 129783
2023-11-16 09:00:01.568  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:?] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 158314
2023-11-16 09:00:01.568 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158314 
2023-11-16 09:00:01.572 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158314 
2023-11-16 09:00:01.572  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:01.572 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 158314 
2023-11-16 09:00:01.572 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 158314
2023-11-16 09:00:01.580 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[5357, 106799, 258875, 199695, 258880]
2023-11-16 09:00:01.580 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 8ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:01.581 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 5 for customer 158314
2023-11-16 09:00:01.581 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357, 106799, 258875, 199695, 258880]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158314
2023-11-16 09:00:01.585 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[5357, 106799, 258875, 199695, 258880]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}158314
2023-11-16 09:00:01.585 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 3ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:01.585 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 158314 99446 user with No pref [5357, 106799, 258875, 199695, 258880]
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 6ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1008]: no user found with pref for this tenant Id 158314 and eventId 99446
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 158314 99446
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 158314
2023-11-16 09:00:01.591  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 158314
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:01.591 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158314] 
2023-11-16 09:00:01.595 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:01.595 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:01.595  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 158314, isUpdateAlert : true
2023-11-16 09:00:01.595  INFO 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:01.596 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:01.596  INFO 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:01.596 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"a139b8f5-bf92-4265-aeba-24fa2a0b3ffc","eventId":19868350,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:01.598  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868350, tenantId : 158314
2023-11-16 09:00:01.598 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"a139b8f5-bf92-4265-aeba-24fa2a0b3ffc","eventId":19868350,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41798
2023-11-16 09:00:01.598  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:01.599  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [11669] 
2023-11-16 09:00:01.599 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.604 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 129783 
2023-11-16 09:00:01.609 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:01.609 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 129783 
2023-11-16 09:00:01.619 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 129783
2023-11-16 09:00:01.640 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (11669)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:01.640 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 41ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:01.944 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:01.982 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (11669)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:01.983 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 38ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:01.986 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_158314
2023-11-16 09:00:01.986 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_158314
2023-11-16 09:00:01.991 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_158314
2023-11-16 09:00:01.991 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_158314
2023-11-16 09:00:01.996 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:02.194 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 200919
2023-11-16 09:00:02.212  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 158314
2023-11-16 09:00:02.212 DEBUG 1 --- [6_103335_158314] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.244 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 129783
2023-11-16 09:00:02.245  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 129783
2023-11-16 09:00:02.245 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 129783 
2023-11-16 09:00:02.245 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.247 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 200919
2023-11-16 09:00:02.248  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 200919
2023-11-16 09:00:02.248 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 200919 
2023-11-16 09:00:02.250 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (11669) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:02.253 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:02.253 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 200919 
2023-11-16 09:00:02.253  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 200919
2023-11-16 09:00:02.253 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 200919 
2023-11-16 09:00:02.253 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 200919 
2023-11-16 09:00:02.253 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.254 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_158314
2023-11-16 09:00:02.254 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 42ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:02.257 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:02.282 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, with SITE_IDS as(select unnest('{4544221,4544289,4544471,4544789,4545056,4545126,4545321,4545457,4545612,4546565,4546573,4546631,4546707,4547638,4547962,4548597,4549661,4550463,4551334,4551672,4551842,4552123,4552596,4552838,4553157,4553555,4554126,4554141,4554352,4554498,4555136,4555443,4555658,4555818,4556120,4556512,4556910,4556920,6957271,6959282,12023033,12024223,12024224,12026033,12026478,12026848,13747606,13750500,22602988,22602990,22603114,22603841,22603866,22603888}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[200919] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:02.282 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 28ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:02.282 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 200919
2023-11-16 09:00:02.287 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 129783 and es.event_id = 19868351 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:02.288 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 42ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:02.292 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_129783
2023-11-16 09:00:02.292 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 4ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_129783
2023-11-16 09:00:02.297 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 4ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:02.297 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 129783 
2023-11-16 09:00:02.349  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 129783
2023-11-16 09:00:02.350 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 129783 
2023-11-16 09:00:02.353 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 129783 
2023-11-16 09:00:02.353  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:02.353 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 129783 
2023-11-16 09:00:02.353 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 129783
2023-11-16 09:00:02.484 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 112ms : for accumulator : {}
2023-11-16 09:00:02.484 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 158314
2023-11-16 09:00:02.517 DEBUG 1 --- [6_103335_158314] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 158314
2023-11-16 09:00:02.518  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 158314
2023-11-16 09:00:02.518  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:02.518 DEBUG 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[11669],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [11669]
2023-11-16 09:00:02.520 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[11669],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22852
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_158314] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158314, Took : 3s
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 832215 
2023-11-16 09:00:02.520  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:02.521 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:02.572 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_200919
2023-11-16 09:00:02.572 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 5ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_200919
2023-11-16 09:00:02.572 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.619 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, with SITEID as( select * from ( select unnest(array[4553157,4546631,22603866,12026033,4545612,4544471,4553555,12024224,4544221,22603841,4556120,4545126,4556512,12024223,22603888,4556910,4548597,22603114,22602988,4554352,13750500,22602990,4551672,4556920,6957271,4547962,4546565,4552838,4555136,4554498,13747606,4546573,4554126,12023033,4555658,4544789,4552596,4546707,12026848,4549661,4554141,6959282,12026478,4551334,4544289,4545056,4551842,4545321,4555818,4547638,4545457,4555443,4550463,4552123]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:02.619 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 46ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:02.623 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_200919
2023-11-16 09:00:02.623 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 51ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_200919
2023-11-16 09:00:02.633 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_200919
2023-11-16 09:00:02.634 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 10ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:02.634 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 200919 
2023-11-16 09:00:02.634  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 200919
2023-11-16 09:00:02.652 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 130ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:02.652 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.700 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 200919 
2023-11-16 09:00:02.702 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [50, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 832215 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 832215), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =832215 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{424296,426078,426484,776301,1015224}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 832215 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:02.703 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 51ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:02.704 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 832215 
2023-11-16 09:00:02.704 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.705 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:02.705 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 200919 
2023-11-16 09:00:02.713 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 200919
2023-11-16 09:00:02.745 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with SITE_IDS as ( select unnest('{424296,426078,426484,776301,1015224}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 832215 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:02.746 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 832215
2023-11-16 09:00:02.746 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 42ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:02.863 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 832215, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:02.863 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868352 and EventDetID : 99446 
2023-11-16 09:00:02.863 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 832215
2023-11-16 09:00:02.864 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868352
2023-11-16 09:00:02.864 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:02.864 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868352 and Event_Details ID : 99446 
2023-11-16 09:00:02.864 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:02.864 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:02.865 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:02.866 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 832215 -- Resulted rows -- [1]
2023-11-16 09:00:02.867 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:02.867 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 832215 : false : false : 19868352 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:02.868 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 832215
2023-11-16 09:00:02.868 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:02.869 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 832215
2023-11-16 09:00:02.869 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 832215
2023-11-16 09:00:02.869  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 832215
2023-11-16 09:00:02.869 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 832215 
2023-11-16 09:00:02.869 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 832215 
2023-11-16 09:00:02.869 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.911 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (832215,152723,152724,140726) and event_details_id = 99446] 
2023-11-16 09:00:02.914 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_832215
2023-11-16 09:00:02.915 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 832215
2023-11-16 09:00:02.915 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 45ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:02.915  INFO 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [832215]
2023-11-16 09:00:02.915  INFO 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [832215]
2023-11-16 09:00:02.916 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 832215 
2023-11-16 09:00:02.916 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 832215 
2023-11-16 09:00:02.916 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:02.938 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [22, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 832215 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (424296,426078,426484,776301,1015224)] 
2023-11-16 09:00:02.939 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 832215
2023-11-16 09:00:02.940 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 23ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:02.999 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:03.056 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [57, WITH SITE_IDS AS( SELECT UNNEST('{424296,426078,426484,776301,776301,1015224}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[832215] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 832215 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:03.057 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 57ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:03.057 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 832215 
2023-11-16 09:00:03.205 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 832215
2023-11-16 09:00:03.206 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 148ms : for accumlator : {}
2023-11-16 09:00:03.206 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 832215 
2023-11-16 09:00:03.210 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_832215
2023-11-16 09:00:03.210 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_832215
2023-11-16 09:00:03.210 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:03.254 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 832215 and total_cpns != '{}' and site_private_id = any('{76403155,76403156,76403679,76403680,76404133}')] 
2023-11-16 09:00:03.258 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_832215
2023-11-16 09:00:03.258 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 47ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:03.258 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:03.293 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, with SITEID as( select * from ( select unnest(array[76403679,76404133,76403156,76403680,76403155]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:03.293 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 35ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:03.297 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_832215
2023-11-16 09:00:03.297 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 39ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_832215
2023-11-16 09:00:03.308 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_832215
2023-11-16 09:00:03.309 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 11ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:03.309 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 832215
2023-11-16 09:00:03.318 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 832215 
2023-11-16 09:00:03.319 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 832215 
2023-11-16 09:00:03.319 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 832215 
2023-11-16 09:00:03.319 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:03.375 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [56, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868352 and tenant_id = 832215] 
2023-11-16 09:00:03.375 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 56ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:03.402 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 200919
2023-11-16 09:00:03.403  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 200919
2023-11-16 09:00:03.403 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 200919 
2023-11-16 09:00:03.403 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:03.453 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [49, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 200919 and es.event_id = 19868353 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:03.453 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 50ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:03.459 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_200919
2023-11-16 09:00:03.459 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 5ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_200919
2023-11-16 09:00:03.464 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 5ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:03.464 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 200919 
2023-11-16 09:00:03.466 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_832215
2023-11-16 09:00:03.466 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_832215
2023-11-16 09:00:03.478 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_832215
2023-11-16 09:00:03.478 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 11ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:03.487 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 8ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:03.488 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 832215 
2023-11-16 09:00:03.556  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 200919
2023-11-16 09:00:03.556 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 200919 
2023-11-16 09:00:03.562 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 200919 
2023-11-16 09:00:03.562  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:03.562 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 200919 
2023-11-16 09:00:03.562 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 200919
2023-11-16 09:00:03.706 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[151014, 133202, 140461, 112327, 136578, 266329, 115079, 115080, 115124, 115068, 135723, 104746, 168965, 136585, 168254, 106485, 131688, 168556, 180838, 153509, 175710, 115087, 106488, 145469, 168964, 204211, 115084, 104021, 115108, 150348, 151815, 115051, 115100, 115126, 136592, 115085, 115101, 150352, 151882, 140342, 106476, 115093, 136584, 112646, 168749, 217651, 114724, 101775, 175708, 115056, 112307, 168966, 168970, 269800, 180708, 231740, 148036, 204768, 104755, 160565, 104748, 224416, 106450, 115128, 112017, 115114, 136586, 175711, 175717, 115054, 197237, 106449, 160976, 106451, 106463, 115064, 206320, 101774, 168972, 248102, 115078, 112332, 115074, 266745, 136571, 168559, 112779, 115070, 160977, 112647, 115055, 115121, 88191, 136577, 249012, 115109, 185245, 268460, 160978, 175718, 168558, 106475, 145735, 153510, 106480, 151813, 115088, 140409, 145694, 177715, 168968, 115075, 133302, 140398, 115052, 136579, 267302, 154774, 115116, 136576, 115065, 150347, 177716, 153804, 115098, 151917, 104744, 151013, 115071, 151816, 205319, 115061, 150349, 217401, 115072, 177462, 268459, 168952, 106479, 140391, 153683, 268461, 145246, 115118, 180837, 115092, 154835, 115063, 154305, 104757, 115053, 151880, 151881, 106454, 248278, 115122, 140408, 151814, 180485, 115103, 115110, 115102, 136598, 160979, 112030, 188679, 112503, 115050, 104753, 115113, 147327, 115089, 101777, 131497, 252227, 101776, 112207, 168957, 112137, 168959, 160980, 140445, 213914, 253349, 136595, 168991, 106483, 133201, 104022, 205986, 115104, 107877, 175713, 115091, 94011, 168961, 115057, 101781, 168967, 111464, 104756, 115107, 106462, 115127, 150350, 115058, 175709, 115120, 107760, 112329, 115090, 115119, 140462, 106486, 154642, 115115, 115094, 94008, 115096, 140400, 115111, 115076, 115097, 115073, 115066, 150353, 150345, 149548, 233374, 175712, 249175, 115069, 217406, 115062, 136572, 136575, 168748, 112505, 111915, 115081, 168971, 115067, 134411, 153475, 140456, 115112, 111489, 107757, 115077, 106491, 115125, 136580, 136597, 115095, 150351, 249176, 112330, 147994, 265976, 115083, 147653, 213913, 115082, 169753, 101778, 147326, 168969, 112319, 217402, 181639, 106455, 196366, 168557, 105982, 115117, 168634, 204172, 213906, 168953, 136599, 136574, 197255, 145671, 192505, 115059, 115105, 205383, 204435, 136591, 150354, 151817, 255861, 147022]
2023-11-16 09:00:03.707 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 144ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:03.707 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 293 for customer 200919
2023-11-16 09:00:03.707 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[151014, 133202, 140461, 112327, 136578, 266329, 115079, 115080, 115124, 115068, 135723, 104746, 168965, 136585, 168254, 106485, 131688, 168556, 180838, 153509, 175710, 115087, 106488, 145469, 168964, 204211, 115084, 104021, 115108, 150348, 151815, 115051, 115100, 115126, 136592, 115085, 115101, 150352, 151882, 140342, 106476, 115093, 136584, 112646, 168749, 217651, 114724, 101775, 175708, 115056, 112307, 168966, 168970, 269800, 180708, 231740, 148036, 204768, 104755, 160565, 104748, 224416, 106450, 115128, 112017, 115114, 136586, 175711, 175717, 115054, 197237, 106449, 160976, 106451, 106463, 115064, 206320, 101774, 168972, 248102, 115078, 112332, 115074, 266745, 136571, 168559, 112779, 115070, 160977, 112647, 115055, 115121, 88191, 136577, 249012, 115109, 185245, 268460, 160978, 175718, 168558, 106475, 145735, 153510, 106480, 151813, 115088, 140409, 145694, 177715, 168968, 115075, 133302, 140398, 115052, 136579, 267302, 154774, 115116, 136576, 115065, 150347, 177716, 153804, 115098, 151917, 104744, 151013, 115071, 151816, 205319, 115061, 150349, 217401, 115072, 177462, 268459, 168952, 106479, 140391, 153683, 268461, 145246, 115118, 180837, 115092, 154835, 115063, 154305, 104757, 115053, 151880, 151881, 106454, 248278, 115122, 140408, 151814, 180485, 115103, 115110, 115102, 136598, 160979, 112030, 188679, 112503, 115050, 104753, 115113, 147327, 115089, 101777, 131497, 252227, 101776, 112207, 168957, 112137, 168959, 160980, 140445, 213914, 253349, 136595, 168991, 106483, 133201, 104022, 205986, 115104, 107877, 175713, 115091, 94011, 168961, 115057, 101781, 168967, 111464, 104756, 115107, 106462, 115127, 150350, 115058, 175709, 115120, 107760, 112329, 115090, 115119, 140462, 106486, 154642, 115115, 115094, 94008, 115096, 140400, 115111, 115076, 115097, 115073, 115066, 150353, 150345, 149548, 233374, 175712, 249175, 115069, 217406, 115062, 136572, 136575, 168748, 112505, 111915, 115081, 168971, 115067, 134411, 153475, 140456, 115112, 111489, 107757, 115077, 106491, 115125, 136580, 136597, 115095, 150351, 249176, 112330, 147994, 265976, 115083, 147653, 213913, 115082, 169753, 101778, 147326, 168969, 112319, 217402, 181639, 106455, 196366, 168557, 105982, 115117, 168634, 204172, 213906, 168953, 136599, 136574, 197255, 145671, 192505, 115059, 115105, 205383, 204435, 136591, 150354, 151817, 255861, 147022]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}200919
2023-11-16 09:00:03.796 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[151014, 133202, 140461, 112327, 136578, 266329, 115079, 115080, 115124, 115068, 135723, 104746, 168965, 136585, 168254, 106485, 131688, 168556, 180838, 153509, 175710, 115087, 106488, 145469, 168964, 204211, 115084, 104021, 115108, 150348, 151815, 115051, 115100, 115126, 136592, 115085, 115101, 150352, 151882, 140342, 106476, 115093, 136584, 112646, 168749, 217651, 114724, 101775, 175708, 115056, 112307, 168966, 168970, 269800, 180708, 231740, 148036, 204768, 104755, 160565, 104748, 224416, 106450, 115128, 112017, 115114, 136586, 175711, 175717, 115054, 197237, 106449, 160976, 106451, 106463, 115064, 206320, 101774, 168972, 248102, 115078, 112332, 115074, 266745, 136571, 168559, 112779, 115070, 160977, 112647, 115055, 115121, 88191, 136577, 249012, 115109, 185245, 268460, 160978, 175718, 168558, 106475, 145735, 153510, 106480, 151813, 115088, 140409, 145694, 177715, 168968, 115075, 133302, 140398, 115052, 136579, 267302, 154774, 115116, 136576, 115065, 150347, 177716, 153804, 115098, 151917, 104744, 151013, 115071, 151816, 205319, 115061, 150349, 217401, 115072, 177462, 268459, 168952, 106479, 140391, 153683, 268461, 145246, 115118, 180837, 115092, 154835, 115063, 154305, 104757, 115053, 151880, 151881, 106454, 248278, 115122, 140408, 151814, 180485, 115103, 115110, 115102, 136598, 160979, 112030, 188679, 112503, 115050, 104753, 115113, 147327, 115089, 101777, 131497, 252227, 101776, 112207, 168957, 112137, 168959, 160980, 140445, 213914, 253349, 136595, 168991, 106483, 133201, 104022, 205986, 115104, 107877, 175713, 115091, 94011, 168961, 115057, 101781, 168967, 111464, 104756, 115107, 106462, 115127, 150350, 115058, 175709, 115120, 107760, 112329, 115090, 115119, 140462, 106486, 154642, 115115, 115094, 94008, 115096, 140400, 115111, 115076, 115097, 115073, 115066, 150353, 150345, 149548, 233374, 175712, 249175, 115069, 217406, 115062, 136572, 136575, 168748, 112505, 111915, 115081, 168971, 115067, 134411, 153475, 140456, 115112, 111489, 107757, 115077, 106491, 115125, 136580, 136597, 115095, 150351, 249176, 112330, 147994, 265976, 115083, 147653, 213913, 115082, 169753, 101778, 147326, 168969, 112319, 217402, 181639, 106455, 196366, 168557, 105982, 115117, 168634, 204172, 213906, 168953, 136599, 136574, 197255, 145671, 192505, 115059, 115105, 205383, 204435, 136591, 150354, 151817, 255861, 147022]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}200919
2023-11-16 09:00:03.796 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 89ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:03.796 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 200919 99446 user with No pref [151014, 133202, 140461, 112327, 136578, 266329, 115079, 115080, 115124, 115068, 135723, 104746, 168965, 136585, 168254, 106485, 131688, 168556, 180838, 153509, 175710, 115087, 106488, 145469, 168964, 204211, 115084, 104021, 115108, 150348, 151815, 115051, 115100, 115126, 136592, 115085, 115101, 150352, 151882, 140342, 106476, 115093, 136584, 112646, 168749, 217651, 114724, 101775, 175708, 115056, 112307, 168966, 168970, 269800, 180708, 231740, 148036, 204768, 104755, 160565, 104748, 224416, 106450, 115128, 112017, 115114, 136586, 175711, 175717, 115054, 197237, 106449, 160976, 106451, 106463, 115064, 206320, 101774, 168972, 248102, 115078, 112332, 115074, 266745, 136571, 168559, 112779, 115070, 160977, 112647, 115055, 115121, 88191, 136577, 249012, 115109, 185245, 268460, 160978, 175718, 168558, 106475, 145735, 153510, 106480, 151813, 115088, 140409, 145694, 177715, 168968, 115075, 133302, 140398, 115052, 136579, 267302, 154774, 115116, 136576, 115065, 150347, 177716, 153804, 115098, 151917, 104744, 151013, 115071, 151816, 205319, 115061, 150349, 217401, 115072, 177462, 268459, 168952, 106479, 140391, 153683, 268461, 145246, 115118, 180837, 115092, 154835, 115063, 154305, 104757, 115053, 151880, 151881, 106454, 248278, 115122, 140408, 151814, 180485, 115103, 115110, 115102, 136598, 160979, 112030, 188679, 112503, 115050, 104753, 115113, 147327, 115089, 101777, 131497, 252227, 101776, 112207, 168957, 112137, 168959, 160980, 140445, 213914, 253349, 136595, 168991, 106483, 133201, 104022, 205986, 115104, 107877, 175713, 115091, 94011, 168961, 115057, 101781, 168967, 111464, 104756, 115107, 106462, 115127, 150350, 115058, 175709, 115120, 107760, 112329, 115090, 115119, 140462, 106486, 154642, 115115, 115094, 94008, 115096, 140400, 115111, 115076, 115097, 115073, 115066, 150353, 150345, 149548, 233374, 175712, 249175, 115069, 217406, 115062, 136572, 136575, 168748, 112505, 111915, 115081, 168971, 115067, 134411, 153475, 140456, 115112, 111489, 107757, 115077, 106491, 115125, 136580, 136597, 115095, 150351, 249176, 112330, 147994, 265976, 115083, 147653, 213913, 115082, 169753, 101778, 147326, 168969, 112319, 217402, 181639, 106455, 196366, 168557, 105982, 115117, 168634, 204172, 213906, 168953, 136599, 136574, 197255, 145671, 192505, 115059, 115105, 205383, 204435, 136591, 150354, 151817, 255861, 147022]
2023-11-16 09:00:03.801 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 5ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:03.801 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 200919 99446 [112325, 112331, 112390, 114722, 115106, 132584, 133682, 136573, 136581, 136593, 136600, 145295, 145325, 154692, 204175, 204176]
2023-11-16 09:00:03.802 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  200919 99446 
2023-11-16 09:00:03.802 DEBUG 1 --- [     Thread-411] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 200919 99446 [112325, 112331, 112390, 114722, 115106, 132584, 133682, 136573, 136581, 136593, 136600, 145295, 145325, 154692, 204175, 204176]
2023-11-16 09:00:03.804 DEBUG 1 --- [     Thread-411] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 200919 99446 [112325, 112331, 112390, 114722, 115106, 132584, 133682, 136573, 136581, 136593, 136600, 145295, 145325, 154692, 204175, 204176]
2023-11-16 09:00:03.804 DEBUG 1 --- [     Thread-411] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 2ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:03.807 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  200919 99446 
2023-11-16 09:00:03.807 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 5ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:03.807 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 200919 99446 [133682, 114722, 115106, 154692, 112331, 145295]
2023-11-16 09:00:03.810 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 200919 99446 [133682, 114722, 154692, 112331, 145295]
2023-11-16 09:00:03.810 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 3ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:03.810 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 200919 99446 [133682, 114722, 154692, 112331, 145295]
2023-11-16 09:00:04.168 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 832215
2023-11-16 09:00:04.212 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 832215
2023-11-16 09:00:04.213  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 832215
2023-11-16 09:00:04.214 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 832215 
2023-11-16 09:00:04.218 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:04.218 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 832215 
2023-11-16 09:00:04.218  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 832215
2023-11-16 09:00:04.218 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 832215 
2023-11-16 09:00:04.218 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 832215 
2023-11-16 09:00:04.219 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:04.261 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, with SITE_IDS as(select unnest('{1854531,1857151,1857502,7146510,13615904}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[832215] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:04.261 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 42ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:04.261 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 832215
2023-11-16 09:00:04.556 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_832215
2023-11-16 09:00:04.556 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 5ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_832215
2023-11-16 09:00:04.556 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:04.594 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, with SITEID as( select * from ( select unnest(array[1857502,1857151,7146510,1854531,13615904]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:04.595 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 38ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:04.600 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_832215
2023-11-16 09:00:04.600 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 43ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_832215
2023-11-16 09:00:04.611 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_832215
2023-11-16 09:00:04.612 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 11ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:04.612 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 832215 
2023-11-16 09:00:04.612  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 832215
2023-11-16 09:00:04.698 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 832215 
2023-11-16 09:00:04.704 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:04.704 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 832215 
2023-11-16 09:00:04.714 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 832215
2023-11-16 09:00:05.026 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 832215
2023-11-16 09:00:05.027  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 832215
2023-11-16 09:00:05.028 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 832215 
2023-11-16 09:00:05.028 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.070 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 832215 and es.event_id = 19868352 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:05.070 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 42ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:05.074 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_832215
2023-11-16 09:00:05.074 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_832215
2023-11-16 09:00:05.077 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:05.077 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 832215 
2023-11-16 09:00:05.079 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 200919 99446 [133682, 114722, 154692, 112331]
2023-11-16 09:00:05.079 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 1268ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.079 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 200919 99446 [133682, 114722, 154692, 112331]
2023-11-16 09:00:05.100 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 200919 99446 [133682, 114722, 154692]
2023-11-16 09:00:05.100 DEBUG 1 --- [     Thread-410] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 21ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.100 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 200919 and eventId 99446 and userIds [133682, 114722, 154692]
2023-11-16 09:00:05.101 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 200919 and eventId : 99446 
2023-11-16 09:00:05.101 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:05.105 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 3
2023-11-16 09:00:05.105 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 4ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:05.105 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 200919 99446
2023-11-16 09:00:05.106 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 200919
2023-11-16 09:00:05.106  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 200919
2023-11-16 09:00:05.106 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:05.106 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [200919] 
2023-11-16 09:00:05.111 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:05.111 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 5ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:05.112  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 200919, isUpdateAlert : true
2023-11-16 09:00:05.112  INFO 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.112 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:05.112  INFO 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.113 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"7f1b593a-c5f3-462a-9ef6-0c2f0414c2cc","eventId":19868353,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:05.115  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868353, tenantId : 200919
2023-11-16 09:00:05.115 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"7f1b593a-c5f3-462a-9ef6-0c2f0414c2cc","eventId":19868353,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41799
2023-11-16 09:00:05.115  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:05.115  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [13786, 10910, 1569, 131911, 1432, 2200, 179083, 5028, 8014, 180680, 202372, 2270, 201572, 11879, 202371, 160448, 129257, 182734, 1446, 1366, 12438, 10624, 42360, 770, 45992, 176922, 202393, 127954, 128989, 239673, 442359, 476544] 
2023-11-16 09:00:05.115 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.145  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 832215
2023-11-16 09:00:05.145 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 832215 
2023-11-16 09:00:05.148 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 832215 
2023-11-16 09:00:05.148  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:05.148 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 832215 
2023-11-16 09:00:05.148 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 832215
2023-11-16 09:00:05.155 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[205317, 135732, 87062, 71631, 6145, 154990, 5357, 169629, 279756, 185834, 88018, 7273, 105969, 92642, 269258, 274259, 287618, 92382, 106799, 302299, 88191, 275991, 219805, 90740, 7173, 235752, 101797, 6743, 185620, 286186, 302296, 111757, 6021, 224514, 241750, 213998, 182265]
2023-11-16 09:00:05.155 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 2802ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:05.156 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 37 for customer 129783
2023-11-16 09:00:05.156 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[205317, 135732, 87062, 71631, 6145, 154990, 5357, 169629, 279756, 185834, 88018, 7273, 105969, 92642, 269258, 274259, 287618, 92382, 106799, 302299, 88191, 275991, 219805, 90740, 7173, 235752, 101797, 6743, 185620, 286186, 302296, 111757, 6021, 224514, 241750, 213998, 182265]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}129783
2023-11-16 09:00:05.167 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[205317, 135732, 87062, 71631, 6145, 154990, 5357, 169629, 279756, 185834, 88018, 7273, 105969, 92642, 269258, 274259, 287618, 92382, 106799, 302299, 88191, 275991, 219805, 90740, 7173, 235752, 101797, 6743, 185620, 286186, 302296, 111757, 6021, 224514, 241750, 213998, 182265]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}129783
2023-11-16 09:00:05.167 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 11ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:05.167 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 129783 99446 user with No pref [205317, 135732, 87062, 71631, 6145, 154990, 5357, 169629, 279756, 185834, 88018, 7273, 105969, 92642, 269258, 274259, 287618, 92382, 106799, 302299, 88191, 275991, 219805, 90740, 7173, 235752, 101797, 6743, 185620, 286186, 302296, 111757, 6021, 224514, 241750, 213998, 182265]
2023-11-16 09:00:05.169 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 2ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:05.169 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 129783 99446 [1349, 6249, 7175, 81060, 87151, 91259, 91747, 111831, 112793, 123736, 132982, 134819, 166105, 166301, 168581, 188701, 188716, 192505, 192878, 196102, 197257, 199939, 204477, 217572, 225448, 237084, 249036, 262864, 277909, 280592, 280606]
2023-11-16 09:00:05.170 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  129783 99446 
2023-11-16 09:00:05.170 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [54, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (13786,10910,1569,131911,1432,2200,179083,5028,8014,180680,202372,2270,201572,11879,202371,160448,129257,182734,1446,1366,12438,10624,42360,770,45992,176922,202393,127954,128989,239673,442359,476544)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:05.170 DEBUG 1 --- [     Thread-413] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 129783 99446 [1349, 6249, 7175, 81060, 87151, 91259, 91747, 111831, 112793, 123736, 132982, 134819, 166105, 166301, 168581, 188701, 188716, 192505, 192878, 196102, 197257, 199939, 204477, 217572, 225448, 237084, 249036, 262864, 277909, 280592, 280606]
2023-11-16 09:00:05.170 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 55ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:05.175 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  129783 99446 
2023-11-16 09:00:05.175 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 5ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:05.175 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 129783 99446 [199939, 196102, 1349, 7175, 168581, 249036, 277909, 262864, 280592, 112793, 123736, 280606, 166301, 188701, 237084, 134819, 91747, 81060, 217572, 192878, 87151, 188716, 91259, 192505, 204477]
2023-11-16 09:00:05.179 DEBUG 1 --- [     Thread-413] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 129783 99446 [1349, 6249, 7175, 81060, 87151, 91259, 91747, 111831, 112793, 123736, 132982, 134819, 166105, 166301, 168581, 188701, 188716, 192505, 192878, 196102, 197257, 199939, 204477, 217572, 225448, 237084, 249036, 262864, 277909, 280592, 280606]
2023-11-16 09:00:05.179 DEBUG 1 --- [     Thread-413] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 9ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:05.183 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 129783 99446 [199939, 196102, 1349, 7175, 168581, 249036, 277909, 262864, 280592, 123736, 280606, 166301, 188701, 237084, 134819, 91747, 217572, 192878, 87151, 188716, 91259, 192505, 204477]
2023-11-16 09:00:05.184 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 8ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:05.184 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 129783 99446 [199939, 196102, 1349, 7175, 168581, 249036, 277909, 262864, 280592, 123736, 280606, 166301, 188701, 237084, 134819, 91747, 217572, 192878, 87151, 188716, 91259, 192505, 204477]
2023-11-16 09:00:05.195 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 129783 99446 [199939, 196102, 249036, 262864, 280592, 123736, 280606, 188701, 237084, 134819, 91747, 217572, 87151, 91259, 192505, 204477]
2023-11-16 09:00:05.195 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 11ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.195 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 129783 99446 [199939, 196102, 249036, 262864, 280592, 123736, 280606, 188701, 237084, 134819, 91747, 217572, 87151, 91259, 192505, 204477]
2023-11-16 09:00:05.207 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 129783 99446 [199939, 196102, 280592, 123736, 280606, 188701, 237084, 91747, 217572, 87151, 192505]
2023-11-16 09:00:05.208 DEBUG 1 --- [     Thread-412] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 12ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.208 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 129783 and eventId 99446 and userIds [199939, 196102, 280592, 123736, 280606, 188701, 237084, 91747, 217572, 87151, 192505]
2023-11-16 09:00:05.208 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 129783 and eventId : 99446 
2023-11-16 09:00:05.208 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 9
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 4ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 129783 99446
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 129783
2023-11-16 09:00:05.213  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 129783
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:05.213 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [129783] 
2023-11-16 09:00:05.221 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:05.221 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 8ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:05.221  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 129783, isUpdateAlert : true
2023-11-16 09:00:05.221  INFO 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.222 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:05.222  INFO 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.222 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"63a18b86-7901-4d57-9443-7a7ef555a176","eventId":19868351,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:05.224  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868351, tenantId : 129783
2023-11-16 09:00:05.224 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"63a18b86-7901-4d57-9443-7a7ef555a176","eventId":19868351,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41800
2023-11-16 09:00:05.224  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:05.224  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [130572, 130555, 130576, 130575] 
2023-11-16 09:00:05.224 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.249 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.273 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [48, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (130572,130555,130576,130575)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:05.274 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 49ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:05.291 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (13786,10910,1569,131911,1432,2200,179083,5028,8014,180680,202372,2270,201572,11879,202371,160448,129257,182734,1446,1366,12438,10624,42360,770,45992,176922,202393,127954,128989,239673,442359,476544)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:05.291 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 41ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:05.295 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_200919
2023-11-16 09:00:05.295 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_200919
2023-11-16 09:00:05.300 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_200919
2023-11-16 09:00:05.300 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_200919
2023-11-16 09:00:05.304 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:05.344 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.351 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[206100, 206092, 206098, 288611, 206095, 280554, 212944, 215006, 206083, 285900, 280556, 206068, 206105, 206080, 206097, 206090, 206101, 215011, 206108, 215023, 206070, 135732, 206084, 280557, 206016, 215014, 206086, 214993, 288610, 206077, 206109, 217572, 214985, 288609, 214995, 215004, 213218, 214978, 206099, 206067, 215008, 206102, 214980, 214982, 213791, 214981, 206015, 215015, 284927, 213217, 280558, 300719, 206071, 206107, 267571]
2023-11-16 09:00:05.352 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 203ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:05.352 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 55 for customer 832215
2023-11-16 09:00:05.352 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[206100, 206092, 206098, 288611, 206095, 280554, 212944, 215006, 206083, 285900, 280556, 206068, 206105, 206080, 206097, 206090, 206101, 215011, 206108, 215023, 206070, 135732, 206084, 280557, 206016, 215014, 206086, 214993, 288610, 206077, 206109, 217572, 214985, 288609, 214995, 215004, 213218, 214978, 206099, 206067, 215008, 206102, 214980, 214982, 213791, 214981, 206015, 215015, 284927, 213217, 280558, 300719, 206071, 206107, 267571]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}832215
2023-11-16 09:00:05.380 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[206100, 206092, 206098, 288611, 206095, 280554, 212944, 215006, 206083, 285900, 280556, 206068, 206105, 206080, 206097, 206090, 206101, 215011, 206108, 215023, 206070, 135732, 206084, 280557, 206016, 215014, 206086, 214993, 288610, 206077, 206109, 217572, 214985, 288609, 214995, 215004, 213218, 214978, 206099, 206067, 215008, 206102, 214980, 214982, 213791, 214981, 206015, 215015, 284927, 213217, 280558, 300719, 206071, 206107, 267571]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}832215
2023-11-16 09:00:05.380 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 27ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:05.380 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 832215 99446 user with No pref [206100, 206092, 206098, 288611, 206095, 280554, 212944, 215006, 206083, 285900, 280556, 206068, 206105, 206080, 206097, 206090, 206101, 215011, 206108, 215023, 206070, 135732, 206084, 280557, 206016, 215014, 206086, 214993, 288610, 206077, 206109, 217572, 214985, 288609, 214995, 215004, 213218, 214978, 206099, 206067, 215008, 206102, 214980, 214982, 213791, 214981, 206015, 215015, 284927, 213217, 280558, 300719, 206071, 206107, 267571]
2023-11-16 09:00:05.382 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:05.382 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 832215 99446 [115005, 177798, 206065, 206076, 206089, 206104, 217170]
2023-11-16 09:00:05.382 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  832215 99446 
2023-11-16 09:00:05.382 DEBUG 1 --- [     Thread-415] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 832215 99446 [115005, 177798, 206065, 206076, 206089, 206104, 217170]
2023-11-16 09:00:05.383 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (130572,130555,130576,130575)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:05.383 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 39ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:05.385 DEBUG 1 --- [     Thread-415] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 832215 99446 [115005, 177798, 206065, 206076, 206089, 206104, 217170]
2023-11-16 09:00:05.385 DEBUG 1 --- [     Thread-415] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 2ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:05.385 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  832215 99446 
2023-11-16 09:00:05.385 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 3ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:05.385 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 832215 99446 [217170, 206065, 206089, 206104, 115005]
2023-11-16 09:00:05.387 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 832215 99446 [206065, 206089, 206104, 115005]
2023-11-16 09:00:05.388 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 2ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:05.388 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 832215 99446 [206065, 206089, 206104, 115005]
2023-11-16 09:00:05.388 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_129783
2023-11-16 09:00:05.388 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_129783
2023-11-16 09:00:05.393 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_129783
2023-11-16 09:00:05.393 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_129783
2023-11-16 09:00:05.394 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 832215 99446 [206089, 115005]
2023-11-16 09:00:05.394 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 6ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.395 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 832215 99446 [206089, 115005]
2023-11-16 09:00:05.395 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 832215 99446 [206089, 115005]
2023-11-16 09:00:05.396 DEBUG 1 --- [     Thread-414] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 1ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:05.396 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 832215 and eventId 99446 and userIds [206089, 115005]
2023-11-16 09:00:05.396 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 832215 and eventId : 99446 
2023-11-16 09:00:05.396 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:05.400 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 2
2023-11-16 09:00:05.400 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 6ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:05.400 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 4ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:05.401 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 832215 99446
2023-11-16 09:00:05.401 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 832215
2023-11-16 09:00:05.401  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 832215
2023-11-16 09:00:05.401 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:05.401 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [832215] 
2023-11-16 09:00:05.404 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:05.404 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:05.404  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 832215, isUpdateAlert : true
2023-11-16 09:00:05.405  INFO 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.405 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:05.405  INFO 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:05.406 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"cfd271a1-860e-4a76-9bff-568ab46ed20a","eventId":19868352,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:05.408 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"cfd271a1-860e-4a76-9bff-568ab46ed20a","eventId":19868352,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41801
2023-11-16 09:00:05.408  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868352, tenantId : 832215
2023-11-16 09:00:05.409  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:05.409  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [140726] 
2023-11-16 09:00:05.409 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.457 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [48, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (140726)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:05.458 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 48ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:05.486  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 200919
2023-11-16 09:00:05.487 DEBUG 1 --- [6_103335_200919] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.502 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.518 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (13786,10910,1569,131911,1432,2200,179083,5028,8014,180680,202372,2270,201572,11879,202371,160448,129257,182734,1446,1366,12438,10624,42360,770,45992,176922,202393,127954,128989,239673,442359,476544) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:05.527 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_200919
2023-11-16 09:00:05.527 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 40ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:05.532 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 5ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:05.538 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (140726)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:05.539 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 36ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:05.544 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_832215
2023-11-16 09:00:05.544 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 5ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_832215
2023-11-16 09:00:05.549 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_832215
2023-11-16 09:00:05.549 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_832215
2023-11-16 09:00:05.553 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:05.606  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 129783
2023-11-16 09:00:05.606 DEBUG 1 --- [6_103335_129783] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.648 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (130572,130555,130576,130575) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:05.651 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_129783
2023-11-16 09:00:05.652 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 45ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:05.654 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:05.699  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 832215
2023-11-16 09:00:05.699 DEBUG 1 --- [6_103335_832215] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:05.754 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [55, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (140726) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:05.757 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_832215
2023-11-16 09:00:05.758 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 58ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:05.761 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:05.858 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 67ms : for accumulator : {}
2023-11-16 09:00:05.858 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 129783
2023-11-16 09:00:05.888 DEBUG 1 --- [6_103335_129783] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 129783
2023-11-16 09:00:05.889  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 129783
2023-11-16 09:00:05.889  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:05.889 DEBUG 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[130575,130555,130572,130576],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [130575, 130555, 130572, 130576]
2023-11-16 09:00:05.890 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[130575,130555,130572,130576],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22853
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_129783] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 129783, Took : 7s
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 480334 
2023-11-16 09:00:05.890  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:05.905 DEBUG 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 11ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:05.922 DEBUG 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 16ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:05.922 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 480334, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:05.922 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:05.922 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 480334
2023-11-16 09:00:05.923 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868354
2023-11-16 09:00:05.923 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:05.923 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:05.923 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:05.923 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:05.924 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:05.926 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 480334 -- Resulted rows -- [1]
2023-11-16 09:00:05.926 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:05.926 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 480334 : null : null : 19868354 : Update published
2023-11-16 09:00:05.928 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 480334
2023-11-16 09:00:05.928 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:05.928 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 480334
2023-11-16 09:00:05.928  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 480334
2023-11-16 09:00:05.928  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 480334 
2023-11-16 09:00:05.928 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:05.928 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [480334] 
2023-11-16 09:00:05.930 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:05.930 DEBUG 1 --- [6_103335_480334] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:05.930 DEBUG 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 480334 
2023-11-16 09:00:05.930 DEBUG 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 480334 
2023-11-16 09:00:05.930  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:05.930  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:05.930  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:05.931  INFO 1 --- [6_103335_480334] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 480334, Took : 0s
2023-11-16 09:00:05.931  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 173042 
2023-11-16 09:00:05.931  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:05.931 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:05.969 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 107ms : for accumulator : {}
2023-11-16 09:00:05.969 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 200919
2023-11-16 09:00:05.980 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 87ms : for accumulator : {}
2023-11-16 09:00:05.980 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 832215
2023-11-16 09:00:06.009 DEBUG 1 --- [6_103335_832215] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 832215
2023-11-16 09:00:06.010  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 832215
2023-11-16 09:00:06.010  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:06.011 DEBUG 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[140726],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [140726]
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:06.012 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[140726],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22854
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_832215] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 832215, Took : 3s
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 433508 
2023-11-16 09:00:06.012  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:06.013 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:06.052 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 120ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:06.052 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.098 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [45, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 173042 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 173042), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =173042 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{325680,938641,1013674,1013747,1014985,1014989,1014990}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 173042 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:06.099 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 46ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:06.099 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 173042 
2023-11-16 09:00:06.099 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.137 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, with SITE_IDS as ( select unnest('{325680,938641,1013674,1013747,1014985,1014989,1014990}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 173042 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:06.139 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 173042
2023-11-16 09:00:06.139 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 39ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:06.317 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 173042, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:06.317 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868355 and EventDetID : 99446 
2023-11-16 09:00:06.318 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 173042
2023-11-16 09:00:06.318 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868355
2023-11-16 09:00:06.318 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:06.318 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868355 and Event_Details ID : 99446 
2023-11-16 09:00:06.318 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:06.319 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:06.319 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:06.326 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 173042 -- Resulted rows -- [1]
2023-11-16 09:00:06.327 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 7ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:06.327 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 173042 : false : false : 19868355 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 173042
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 173042
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 173042
2023-11-16 09:00:06.330  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 173042
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 173042 
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 173042 
2023-11-16 09:00:06.330 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.339 DEBUG 1 --- [6_103335_200919] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 200919
2023-11-16 09:00:06.340  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 200919
2023-11-16 09:00:06.340  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:06.341 DEBUG 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[10624,2270,160448,1446,11879,13786,1569,42360,176922,1432,1366,2200,12438,182734,45992,5028,202393,8014,770],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [10624, 2270, 160448, 1446, 11879, 13786, 1569, 42360, 176922, 1432, 1366, 2200, 12438, 182734, 45992, 5028, 202393, 8014, 770]
2023-11-16 09:00:06.342 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[10624,2270,160448,1446,11879,13786,1569,42360,176922,1432,1366,2200,12438,182734,45992,5028,202393,8014,770],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22855
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_200919] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 200919, Took : 6s
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 548976 
2023-11-16 09:00:06.342  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:06.343 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:06.371 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (173042,1369,127984,7794,1375,3335) and event_details_id = 99446] 
2023-11-16 09:00:06.375 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_173042
2023-11-16 09:00:06.375 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 173042
2023-11-16 09:00:06.375 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 44ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:06.375  INFO 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [173042]
2023-11-16 09:00:06.376  INFO 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [173042]
2023-11-16 09:00:06.376 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 173042 
2023-11-16 09:00:06.376 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 173042 
2023-11-16 09:00:06.376 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.409 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 173042 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (325680,938641,1013674,1013747,1014989,1014990,1014985)] 
2023-11-16 09:00:06.411 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 173042
2023-11-16 09:00:06.411 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 34ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:06.486 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.566 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [79, WITH SITE_IDS AS( SELECT UNNEST('{325680,938641,1013674,1013747,1014985,1014985,1014989,1014990}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[173042] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 173042 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:06.566 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 80ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:06.566 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 173042 
2023-11-16 09:00:06.695 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 173042
2023-11-16 09:00:06.695 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 129ms : for accumlator : {}
2023-11-16 09:00:06.695 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 173042 
2023-11-16 09:00:06.699 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_173042
2023-11-16 09:00:06.699 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 3ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_173042
2023-11-16 09:00:06.699 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.733 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 173042 and total_cpns != '{}' and site_private_id = any('{10644331,13440096,13440370,13576667,13576675,13576676,14321779}')] 
2023-11-16 09:00:06.736 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_173042
2023-11-16 09:00:06.736 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 36ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:06.736 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.793 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [56, with SITEID as( select * from ( select unnest(array[13576667,10644331,14321779,13576676,13576675,13440096,13440370]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:06.793 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 57ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:06.797 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_173042
2023-11-16 09:00:06.797 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 60ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_173042
2023-11-16 09:00:06.808 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [?:?] : FINAL_CUSTOMER_VIEW_99446_173042
2023-11-16 09:00:06.808 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 11ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:06.808 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 173042
2023-11-16 09:00:06.815 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 173042 
2023-11-16 09:00:06.815 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 173042 
2023-11-16 09:00:06.815 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 173042 
2023-11-16 09:00:06.815 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:06.878 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [63, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868355 and tenant_id = 173042] 
2023-11-16 09:00:06.878 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 63ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:06.950 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_173042
2023-11-16 09:00:06.950 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 3ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_173042
2023-11-16 09:00:06.960 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_173042
2023-11-16 09:00:06.961 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 10ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:06.971 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 10ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:06.972 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 173042 
2023-11-16 09:00:07.545 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 1202ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:07.545 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.585 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 548976 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 548976), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =548976 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{1158539,1158540,1158541,1158542,1171384,1171385,1171391,1201214,1208201,1208202,1208206,1208207,1208208,1249454,1249455,1249456,1552145,1552146,1552147,1552148,1552149,1552150,1552151,1552152,1552153,1552154,1552155,1552156,1552157,1552158,1552159,1552160,1552161,1552162,2401247,2474096,2474325,2474326,2474327,2474328,2474329,2474330,2474331,2474333,2474334}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 548976 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:07.587 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 41ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:07.587 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 548976 
2023-11-16 09:00:07.587 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.630 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [42, with SITE_IDS as ( select unnest('{1158539,1158540,1158541,1158542,1171384,1171385,1171391,1201214,1208201,1208202,1208206,1208207,1208208,1249454,1249455,1249456,1552145,1552146,1552147,1552148,1552149,1552150,1552151,1552152,1552153,1552154,1552155,1552156,1552157,1552158,1552159,1552160,1552161,1552162,2401247,2474096,2474325,2474326,2474327,2474328,2474329,2474330,2474331,2474333,2474334}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 548976 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:07.632 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 548976
2023-11-16 09:00:07.632 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 44ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:07.833 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 548976, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:07.833 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868358 and EventDetID : 99446 
2023-11-16 09:00:07.833 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 548976
2023-11-16 09:00:07.835 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868358
2023-11-16 09:00:07.835 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 2ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:07.836 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868358 and Event_Details ID : 99446 
2023-11-16 09:00:07.836 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:07.836 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:07.837 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:07.840 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 548976 -- Resulted rows -- [1]
2023-11-16 09:00:07.841 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:07.841 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 548976 : false : false : 19868358 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 548976
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 548976
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 548976
2023-11-16 09:00:07.843  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 548976
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 548976 
2023-11-16 09:00:07.843 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 548976 
2023-11-16 09:00:07.844 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.850 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 173042
2023-11-16 09:00:07.866 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 1852ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:07.866 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.873 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (548976,142062,535085,8089,33399,559589,559971,559150,440213,568216,567907,568399,567890,261215,208107,698,46268,482548,564687,559047,136135,559771,560010,559657,559136,33124,568096,564626,565265,228807,124499,568404,565027,559742,269,35622,256247,39042,1108833,1063207,32542,10337,1108649,1108665,277453) and event_details_id = 99446] 
2023-11-16 09:00:07.878 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_548976
2023-11-16 09:00:07.878 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 548976
2023-11-16 09:00:07.878 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 34ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:07.878  INFO 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [548976]
2023-11-16 09:00:07.884 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 173042
2023-11-16 09:00:07.885  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 173042
2023-11-16 09:00:07.885 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 173042 
2023-11-16 09:00:07.886  INFO 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [548976]
2023-11-16 09:00:07.886 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 548976 
2023-11-16 09:00:07.886 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 548976 
2023-11-16 09:00:07.886 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.890 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:07.890 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 173042 
2023-11-16 09:00:07.890  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 173042
2023-11-16 09:00:07.890 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 173042 
2023-11-16 09:00:07.890 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 173042 
2023-11-16 09:00:07.890 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.898 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 433508 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 433508), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =433508 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{30144,37163,46086,47422,47423,47424,55741,291017,322697,421747,426078,426484,428271,443659,448489,510569,510671,532614,532703,532955,532958,533644,533762,533973,534966,534974,534975,535868,536138,536498,536515,536586,536752,536856,551151,551416,551417,551760,700091,700092,991462,991463,991464,999561,1000880,1000881,1000882,1016690,1019475,1019476,1019477,1019478,1019479,1019480,1041025,1069190,1069191,1069192,1069193,1069194,1069195,1069196,1069197,1069198,1069199,1069201,1069202,1069203,1069204,1069205,1069206,1072143,1249112}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 433508 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:07.899 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 32ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:07.899 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 433508 
2023-11-16 09:00:07.899 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:07.924 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 548976 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (1158539,1158540,1158541,1158542,1171384,1171385,1171391,1201214,1208201,1208202,1208206,1208207,1208208,1249454,1249455,1249456,1552145,1552146,1552147,1552148,1552149,1552150,1552151,1552152,1552153,1552154,1552155,1552156,1552157,1552158,1552159,1552160,1552161,1552162,2401247,2474096,2474325,2474326,2474327,2474328,2474329,2474330,2474331,2474333,2474334)] 
2023-11-16 09:00:07.925 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 548976
2023-11-16 09:00:07.926 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 39ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:07.938 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, with SITE_IDS as ( select unnest('{30144,37163,46086,47422,47423,47424,55741,291017,322697,421747,426078,426484,428271,443659,448489,510569,510671,532614,532703,532955,532958,533644,533762,533973,534966,534974,534975,535868,536138,536498,536515,536586,536752,536856,551151,551416,551417,551760,700091,700092,991462,991463,991464,999561,1000880,1000881,1000882,1016690,1019475,1019476,1019477,1019478,1019479,1019480,1041025,1069190,1069191,1069192,1069193,1069194,1069195,1069196,1069197,1069198,1069199,1069201,1069202,1069203,1069204,1069205,1069206,1072143,1249112}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 433508 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:07.938 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [48, with SITE_IDS as(select unnest('{1424234,10644370,13440095,13440369,13576670,13576671}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[173042] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:07.939 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 48ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:07.939 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 173042
2023-11-16 09:00:07.940 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 433508
2023-11-16 09:00:07.940 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 40ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:07.991 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.039 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, WITH SITE_IDS AS( SELECT UNNEST('{1158539,1158540,1158541,1158542,1171384,1171385,1171391,1201214,1208201,1208202,1208206,1208207,1208208,1249454,1249455,1249456,1552145,1552146,1552147,1552148,1552149,1552150,1552151,1552152,1552153,1552154,1552155,1552156,1552157,1552158,1552159,1552160,1552161,1552162,2401247,2474096,2474325,2474326,2474327,2474328,2474329,2474330,2474331,2474333,2474334}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[548976] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 548976 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:08.039 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 48ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:08.039 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 548976 
2023-11-16 09:00:08.124 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 176350 99446 [100353, 235777, 100354, 224512, 235776, 100357, 157702, 100358, 100360, 100367, 100366, 100369, 101137, 100368, 100370, 100373, 170518, 205079, 100372, 101142, 205076, 100377, 100379, 100378, 100381, 100384, 100389, 100388, 100393, 192040, 100394, 179501, 100403, 100402, 100404, 100407, 100411, 224825, 252223, 100412, 100417, 132675, 132676, 100424, 249930, 100427, 153672, 249929, 100428, 100431, 249933, 249932, 100433, 100432, 193361, 100437, 112213, 215639, 193364, 100443, 100445, 169311, 100447, 257629, 100448, 204902, 292706, 146795, 100459, 230760, 188780, 204908, 100465, 154482, 100468, 100470, 204660, 100483, 100485, 106117, 155527, 196998, 213125, 100486, 100489, 100495, 269200, 114070, 262803, 100509, 100508, 100510, 269211, 100515, 267943, 235687, 100260, 100263, 100519, 100523, 180392, 219817, 267951, 100527, 100529, 194226, 100275, 100274, 100530, 100533, 250039, 100532, 100279, 100280, 100282, 100538, 112570, 103356, 100286, 100542, 160701, 100290, 180171, 100299, 100298, 100301, 100303, 100302, 133069, 100307, 231376, 100309, 100308, 100311, 100315, 173272, 100317, 101085, 100319, 100318, 100320, 100323, 100322, 100326, 100328, 267757, 292589, 100331, 267758, 185838, 100334, 169709, 100336, 100338, 160758, 100342, 100345, 166139, 100347, 100346, 101119]
2023-11-16 09:00:08.124 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 13942ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:08.124 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 176350 99446 [100353, 235777, 100354, 224512, 235776, 100357, 157702, 100358, 100360, 100367, 100366, 100369, 101137, 100368, 100370, 100373, 170518, 205079, 100372, 101142, 205076, 100377, 100379, 100378, 100381, 100384, 100389, 100388, 100393, 192040, 100394, 179501, 100403, 100402, 100404, 100407, 100411, 224825, 252223, 100412, 100417, 132675, 132676, 100424, 249930, 100427, 153672, 249929, 100428, 100431, 249933, 249932, 100433, 100432, 193361, 100437, 112213, 215639, 193364, 100443, 100445, 169311, 100447, 257629, 100448, 204902, 292706, 146795, 100459, 230760, 188780, 204908, 100465, 154482, 100468, 100470, 204660, 100483, 100485, 106117, 155527, 196998, 213125, 100486, 100489, 100495, 269200, 114070, 262803, 100509, 100508, 100510, 269211, 100515, 267943, 235687, 100260, 100263, 100519, 100523, 180392, 219817, 267951, 100527, 100529, 194226, 100275, 100274, 100530, 100533, 250039, 100532, 100279, 100280, 100282, 100538, 112570, 103356, 100286, 100542, 160701, 100290, 180171, 100299, 100298, 100301, 100303, 100302, 133069, 100307, 231376, 100309, 100308, 100311, 100315, 173272, 100317, 101085, 100319, 100318, 100320, 100323, 100322, 100326, 100328, 267757, 292589, 100331, 267758, 185838, 100334, 169709, 100336, 100338, 160758, 100342, 100345, 166139, 100347, 100346, 101119]
2023-11-16 09:00:08.147 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_173042
2023-11-16 09:00:08.147 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_173042
2023-11-16 09:00:08.147 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.181 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [34, with SITEID as( select * from ( select unnest(array[10644370,13576671,13576670,13440095,13440369,1424234]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:08.181 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 34ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:08.185 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_173042
2023-11-16 09:00:08.185 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 37ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_173042
2023-11-16 09:00:08.194 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_173042
2023-11-16 09:00:08.194 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:08.194 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 173042 
2023-11-16 09:00:08.194  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 173042
2023-11-16 09:00:08.196 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 548976
2023-11-16 09:00:08.196 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 156ms : for accumlator : {}
2023-11-16 09:00:08.196 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 548976 
2023-11-16 09:00:08.200 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_548976
2023-11-16 09:00:08.201 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_548976
2023-11-16 09:00:08.201 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.229 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 433508, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:08.230 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868356 and EventDetID : 99446 
2023-11-16 09:00:08.230 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 433508
2023-11-16 09:00:08.231 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868356
2023-11-16 09:00:08.231 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:08.231 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868356 and Event_Details ID : 99446 
2023-11-16 09:00:08.231 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:08.231 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:08.232 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:08.234 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 433508 -- Resulted rows -- [1]
2023-11-16 09:00:08.234 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:08.234 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 433508 : false : false : 19868356 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:08.236 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 433508
2023-11-16 09:00:08.236 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:08.236 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 433508
2023-11-16 09:00:08.236 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 433508
2023-11-16 09:00:08.236  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 433508
2023-11-16 09:00:08.236 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 433508 
2023-11-16 09:00:08.237 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 433508 
2023-11-16 09:00:08.237 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.246 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [45, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 548976 and total_cpns != '{}' and site_private_id = any('{25151064,25151107,25151264,25151836,25885985,25885986,25885990,26574144,26830839,26833576,26833579,26833580,26833581,31535818,31537172,31537236,46664026,46664289,46666225,46671541,46671542,46671545,46671546,46671547,46671549,46671550,46671551,46671552,46671553,46671555,46671556,46671558,46671559,46671563,77701961,83647578,83649447,83653116,83656718,83656720,83656721,83656722,83656723,83656725,83656726}')] 
2023-11-16 09:00:08.250 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_548976
2023-11-16 09:00:08.250 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 49ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:08.250 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.269 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [32, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (433508,1375,1099,7837,292,1449,1388,2177,8979,152724,273,293,1404,12844,151133,111,192034,192052,178827,150001,131459,90,192401,192448,22682,592,190972,190987,2281,192,37128,198844,231667,440511,440544,440740,5963,167553,442931,443521,2833,451208,5798,311,2956,156914,160425,237,150727,148401,440803,167672,5755) and event_details_id = 99446] 
2023-11-16 09:00:08.273 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_433508
2023-11-16 09:00:08.273 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 433508
2023-11-16 09:00:08.273 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 36ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:08.273  INFO 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [433508]
2023-11-16 09:00:08.277  INFO 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [433508]
2023-11-16 09:00:08.277 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 433508 
2023-11-16 09:00:08.277 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 433508 
2023-11-16 09:00:08.277 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.287 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 176350 99446 [101142, 100388, 100402, 100412, 100424, 100448, 100465, 106117, 103356, 100319]
2023-11-16 09:00:08.287 DEBUG 1 --- [     Thread-402] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 163ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:08.287 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 176350 and eventId 99446 and userIds [100260, 100263, 100275, 100279, 100280, 100282, 100286, 100290, 100298, 100299, 100301, 100303, 100307, 100308, 100309, 100311, 100315, 100317, 100318, 100320, 100322, 100326, 100328, 100331, 100334, 100336, 100342, 100345, 100346, 100347, 100353, 100354, 100357, 100358, 100360, 100366, 100367, 100368, 100372, 100373, 100377, 100378, 100379, 100384, 100389, 100393, 100403, 100404, 100407, 100411, 100417, 100427, 100428, 100431, 100432, 100433, 100445, 100447, 100459, 100468, 100470, 100483, 100485, 100486, 100489, 100495, 100508, 100509, 100515, 100519, 100523, 100527, 100529, 100532, 100538, 100542, 101085, 101119, 101137, 112213, 112570, 114070, 132675, 132676, 146795, 154482, 155527, 166139, 169311, 169709, 170518, 179501, 180171, 194226, 215639, 224825, 230760, 231376, 235687, 235776, 235777, 249929, 249932, 249933, 257629, 262803, 267757, 267758, 267943, 269211, 292706, 101142, 100388, 100402, 100412, 100424, 100448, 100465, 106117, 103356, 100319]
2023-11-16 09:00:08.288 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 176350 and eventId : 99446 
2023-11-16 09:00:08.288 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:08.290 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 173042 
2023-11-16 09:00:08.294 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:08.294 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 173042 
2023-11-16 09:00:08.303 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 173042
2023-11-16 09:00:08.303 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 31 99446 [453, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 204477, 188701]
2023-11-16 09:00:08.303 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 9877ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:08.303 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [53, with SITEID as( select * from ( select unnest(array[83653116,46671563,46671552,46671553,46671555,46671556,46671558,46671559,46664026,26574144,83649447,25151264,25151836,83647578,25151064,25885986,77701961,46664289,83656725,83656726,25885985,31535818,25885990,83656720,83656721,26830839,83656722,83656723,26833576,46671545,26833579,46671546,83656718,46671547,26833581,26833580,31537172,31537236,46671549,46671550,46671551,46666225,25151107,46671541,46671542]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:08.303 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 31 99446 [453, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 204477, 188701]
2023-11-16 09:00:08.304 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 53ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:08.307 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_548976
2023-11-16 09:00:08.307 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 57ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_548976
2023-11-16 09:00:08.315 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 433508 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (30144,37163,46086,47422,47423,47424,55741,291017,322697,421747,426078,426484,428271,443659,448489,510569,510671,532614,532703,532955,532958,533644,533762,533973,534966,534974,534975,535868,536138,536498,536515,536586,536752,536856,551151,551416,551417,551760,700091,700092,991462,991463,991464,999561,1000880,1000881,1000882,1016690,1019475,1019476,1019477,1019478,1019479,1019480,1041025,1069190,1069191,1069192,1069193,1069194,1069195,1069196,1069197,1069198,1069199,1069201,1069202,1069203,1069204,1069205,1069206,1072143,1249112)] 
2023-11-16 09:00:08.317 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 433508
2023-11-16 09:00:08.317 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 39ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:08.322 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_548976
2023-11-16 09:00:08.322 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 14ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:08.322 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 548976
2023-11-16 09:00:08.325 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 121
2023-11-16 09:00:08.325 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 37ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:08.325 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 176350 99446
2023-11-16 09:00:08.325 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 176350
2023-11-16 09:00:08.326  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 176350
2023-11-16 09:00:08.326 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:08.326 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [176350] 
2023-11-16 09:00:08.331 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 548976 
2023-11-16 09:00:08.331 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:08.332 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 548976 
2023-11-16 09:00:08.332 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 5ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:08.332 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 548976 
2023-11-16 09:00:08.332  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 176350, isUpdateAlert : true
2023-11-16 09:00:08.332 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.332  INFO 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:08.332 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:08.333  INFO 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:08.333 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"cccec88f-dde0-4e71-b98a-4784686f6f62","eventId":19868340,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:08.335  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868340, tenantId : 176350
2023-11-16 09:00:08.335  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:08.335 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"cccec88f-dde0-4e71-b98a-4784686f6f62","eventId":19868340,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41802
2023-11-16 09:00:08.335  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [181948, 185560, 185267, 196401, 179658, 139844, 34143, 2858, 471990, 837350, 1111302, 596028, 263192] 
2023-11-16 09:00:08.335 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.364 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (181948,185560,185267,196401,179658,139844,34143,2858,471990,837350,1111302,596028,263192)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:08.365 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 29ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:08.382 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [49, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868358 and tenant_id = 548976] 
2023-11-16 09:00:08.382 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 50ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:08.392 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 31 99446 [453, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 188701]
2023-11-16 09:00:08.392 DEBUG 1 --- [     Thread-408] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 88ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:08.392 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 31 and eventId 99446 and userIds [204477, 453, 134954, 294028, 154990, 192878, 199695, 5357, 71631, 112046, 153875, 213456, 302487, 132982, 216469, 206011, 178873, 302296, 188701]
2023-11-16 09:00:08.393 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 31 and eventId : 99446 
2023-11-16 09:00:08.393 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:08.395 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 19
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 29ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 31 99446
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 31
2023-11-16 09:00:08.422  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 31
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:08.422 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [31] 
2023-11-16 09:00:08.425 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.425 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:08.425 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:08.425  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 31, isUpdateAlert : true
2023-11-16 09:00:08.426  INFO 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:08.426 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:08.426  INFO 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:08.427 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"22f50e8c-304a-4d71-821a-4e4217a7d0a9","eventId":19868342,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:08.429  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868342, tenantId : 31
2023-11-16 09:00:08.429  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:08.429 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"22f50e8c-304a-4d71-821a-4e4217a7d0a9","eventId":19868342,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41803
2023-11-16 09:00:08.429  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [75792, 270, 152723, 434095, 434109, 434160, 434441, 435035, 435363, 436348, 436387, 436391, 436415, 144203, 75804, 989842, 434966, 435729, 435293, 434883, 990131, 989253, 989424, 436382, 435855, 989389, 990052, 990739, 75811, 1028992, 1038736, 1063019, 436219, 433688, 989609, 989149, 990409, 1139788] 
2023-11-16 09:00:08.429 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.450 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [54, WITH SITE_IDS AS( SELECT UNNEST('{30144,30144,30144,30144,30144,30144,30144,30144,30144,37163,37163,37163,46086,46086,46086,47422,47423,47424,55741,55741,291017,291017,291017,322697,322697,421747,421747,421747,421747,426078,426484,428271,443659,443659,443659,443659,443659,448489,510569,510671,532614,532614,532614,532614,532614,532614,532614,532614,532703,532955,532958,533644,533762,533762,533762,533973,534966,534974,534975,535868,536138,536498,536498,536498,536515,536586,536752,536856,551151,551416,551417,551760,700091,700092,991462,991463,991464,999561,1000880,1000881,1000882,1016690,1016690,1019475,1019476,1019477,1019478,1019479,1019480,1041025,1041025,1041025,1041025,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069190,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069191,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069192,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069193,1069194,1069194,1069194,1069194,1069194,1069194,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069195,1069196,1069196,1069196,1069196,1069196,1069196,1069196,1069196,1069196,1069196,1069196,1069197,1069197,1069197,1069197,1069197,1069197,1069197,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069198,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069199,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069201,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069202,1069203,1069204,1069204,1069204,1069204,1069204,1069204,1069205,1069205,1069205,1069205,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1069206,1072143,1072143,1072143,1249112,1249112,1249112,1249112,1249112,1249112}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[433508] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 433508 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:08.450 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 54ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:08.450 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 433508 
2023-11-16 09:00:08.469 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [?:?] : Time taken(ms) for query: [44, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (181948,185560,185267,196401,179658,139844,34143,2858,471990,837350,1111302,596028,263192)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:08.469 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 44ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:08.474 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_176350
2023-11-16 09:00:08.474 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_548976
2023-11-16 09:00:08.474 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 3ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_548976
2023-11-16 09:00:08.474 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_176350
2023-11-16 09:00:08.478 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [49, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (75792,270,152723,434095,434109,434160,434441,435035,435363,436348,436387,436391,436415,144203,75804,989842,434966,435729,435293,434883,990131,989253,989424,436382,435855,989389,990052,990739,75811,1028992,1038736,1063019,436219,433688,989609,989149,990409,1139788)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:08.479 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 49ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:08.479 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_176350
2023-11-16 09:00:08.480 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_176350
2023-11-16 09:00:08.485 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_548976
2023-11-16 09:00:08.485 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 10ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:08.486 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 5ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:08.494 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 9ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:08.496 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 548976 
2023-11-16 09:00:08.589 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.606 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 433508
2023-11-16 09:00:08.606 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 156ms : for accumlator : {}
2023-11-16 09:00:08.607 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 433508 
2023-11-16 09:00:08.612 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_433508
2023-11-16 09:00:08.612 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 5ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_433508
2023-11-16 09:00:08.612 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.620 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [31, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (75792,270,152723,434095,434109,434160,434441,435035,435363,436348,436387,436391,436415,144203,75804,989842,434966,435729,435293,434883,990131,989253,989424,436382,435855,989389,990052,990739,75811,1028992,1038736,1063019,436219,433688,989609,989149,990409,1139788)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:08.621 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 32ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:08.625 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_31
2023-11-16 09:00:08.625 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_31
2023-11-16 09:00:08.630 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_31
2023-11-16 09:00:08.631 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 5ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_31
2023-11-16 09:00:08.636 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:08.640 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 173042
2023-11-16 09:00:08.641  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 173042
2023-11-16 09:00:08.641 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 173042 
2023-11-16 09:00:08.641 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.641 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 433508 and total_cpns != '{}' and site_private_id = any('{12426250,12426459,12426630,12427647,12428534,12428789,12428790,12429646,12429825,12430171,12431677,12431678,12431679,12432813,12433219,12433766,12433868,12434154,12434272,12435026,12435061,12435176,12435427,12435428,12435983,12435984,12435985,12436295,12436829,12436869,12436906,12437048,12438594,12439205,12439206,12439207,12439208,12439209,12762818,12765018,12765019,12765020,13604354,13604355,13701891,13863683,13863684,13863685,13863686,13863687,13863688,14622216,23566185,51226571,51227057,51227058,51227414,51228563,51228564,51228565,51228566,51228568,51229398,51229399,51230629,51230630,51230822,51233035,51233744,51233860,51234591,51245482,51254486}')] 
2023-11-16 09:00:08.648 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_433508
2023-11-16 09:00:08.648 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 36ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:08.648 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.675 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 173042 and es.event_id = 19868355 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:08.675 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 33ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:08.680 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_173042
2023-11-16 09:00:08.680 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 4ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_173042
2023-11-16 09:00:08.684 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 4ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:08.685 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 173042 
2023-11-16 09:00:08.690 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with SITEID as( select * from ( select unnest(array[12431677,12762818,12431679,12431678,12437048,51233035,23566185,12432813,51234591,12439209,12439208,51228568,12436906,12439205,12765018,51228565,12765019,51228564,12439207,12439206,51227414,51228566,12765020,51228563,51245482,51230629,51230630,12435985,12435984,12435983,12426250,12436869,12426630,12429825,51227057,51227058,12427647,51226571,12428789,12435061,51233860,12428534,12428790,13604355,13604354,13863683,13701891,13863687,12435176,13863686,13863685,12434154,13863684,14622216,51254486,12435428,51229399,12433766,13863688,51229398,12434272,51233744,12435427,12436829,12426459,12430171,51230822,12435026,12433868,12429646,12436295,12433219,12438594]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:08.691 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 42ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:08.697 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_433508
2023-11-16 09:00:08.697 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 48ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_433508
2023-11-16 09:00:08.713 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_433508
2023-11-16 09:00:08.713 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 16ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:08.713 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 433508
2023-11-16 09:00:08.722 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 433508 
2023-11-16 09:00:08.722 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 433508 
2023-11-16 09:00:08.722 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 433508 
2023-11-16 09:00:08.722 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.769 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868356 and tenant_id = 433508] 
2023-11-16 09:00:08.769 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 47ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:08.821 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_433508
2023-11-16 09:00:08.822 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_433508
2023-11-16 09:00:08.824  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 176350
2023-11-16 09:00:08.824 DEBUG 1 --- [6_103335_176350] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:08.836 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_433508
2023-11-16 09:00:08.836 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 14ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:08.838  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 173042
2023-11-16 09:00:08.839 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 173042 
2023-11-16 09:00:08.844 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 173042 
2023-11-16 09:00:08.844  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): false, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:08.844 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 173042 
2023-11-16 09:00:08.844 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 173042
2023-11-16 09:00:08.850 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 13ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:08.851 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 433508 
2023-11-16 09:00:08.859 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (181948,185560,185267,196401,179658,139844,34143,2858,471990,837350,1111302,596028,263192) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:08.865 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_176350
2023-11-16 09:00:08.865 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 40ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:08.870 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 4ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:09.017  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 31
2023-11-16 09:00:09.017 DEBUG 1 --- [99446_103335_31] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.055 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (75792,270,152723,434095,434109,434160,434441,435035,435363,436348,436387,436391,436415,144203,75804,989842,434966,435729,435293,434883,990131,989253,989424,436382,435855,989389,990052,990739,75811,1028992,1038736,1063019,436219,433688,989609,989149,990409,1139788) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:09.059 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_31
2023-11-16 09:00:09.059 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 41ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:09.062 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:09.445 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[148705, 101869, 133638, 96141, 123736, 288621, 148722, 100623, 148732, 266495, 148719, 235286, 95394, 103090, 154722, 111620, 148689, 235237, 173278, 148706, 148704, 148728, 153972, 150491, 206113, 133922, 132982, 148724, 102383, 249450, 148735, 148709, 148725, 148720, 272820, 148736, 103089, 148708, 107536, 148729, 148669, 182481, 102442, 133322, 150788, 148716, 148739, 150790, 102500, 145727]
2023-11-16 09:00:09.445 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 600ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:09.445 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 50 for customer 173042
2023-11-16 09:00:09.445 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[148705, 101869, 133638, 96141, 123736, 288621, 148722, 100623, 148732, 266495, 148719, 235286, 95394, 103090, 154722, 111620, 148689, 235237, 173278, 148706, 148704, 148728, 153972, 150491, 206113, 133922, 132982, 148724, 102383, 249450, 148735, 148709, 148725, 148720, 272820, 148736, 103089, 148708, 107536, 148729, 148669, 182481, 102442, 133322, 150788, 148716, 148739, 150790, 102500, 145727]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}173042
2023-11-16 09:00:09.460 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[148705, 101869, 133638, 96141, 123736, 288621, 148722, 100623, 148732, 266495, 148719, 235286, 95394, 103090, 154722, 111620, 148689, 235237, 173278, 148706, 148704, 148728, 153972, 150491, 206113, 133922, 132982, 148724, 102383, 249450, 148735, 148709, 148725, 148720, 272820, 148736, 103089, 148708, 107536, 148729, 148669, 182481, 102442, 133322, 150788, 148716, 148739, 150790, 102500, 145727]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}173042
2023-11-16 09:00:09.460 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 14ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:09.460 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 173042 99446 user with No pref [148705, 101869, 133638, 96141, 123736, 288621, 148722, 100623, 148732, 266495, 148719, 235286, 95394, 103090, 154722, 111620, 148689, 235237, 173278, 148706, 148704, 148728, 153972, 150491, 206113, 133922, 132982, 148724, 102383, 249450, 148735, 148709, 148725, 148720, 272820, 148736, 103089, 148708, 107536, 148729, 148669, 182481, 102442, 133322, 150788, 148716, 148739, 150790, 102500, 145727]
2023-11-16 09:00:09.474 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 13ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:09.475 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 173042 99446 [54839, 96139, 101861, 101867, 101868, 101921, 102253, 103895, 107358, 133304, 134851, 140460, 145739, 148710, 148711, 148713, 148718, 148721, 148726, 148727, 148730, 148737, 155748, 234979, 235998, 248789]
2023-11-16 09:00:09.475 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  173042 99446 
2023-11-16 09:00:09.475 DEBUG 1 --- [     Thread-417] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 173042 99446 [54839, 96139, 101861, 101867, 101868, 101921, 102253, 103895, 107358, 133304, 134851, 140460, 145739, 148710, 148711, 148713, 148718, 148721, 148726, 148727, 148730, 148737, 155748, 234979, 235998, 248789]
2023-11-16 09:00:09.484 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  173042 99446 
2023-11-16 09:00:09.484 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 8ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:09.484 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 173042 99446 [101921, 234979, 134851, 148737, 148710, 148711, 155748, 145739, 96139, 101867, 148713, 102253, 148718, 101868, 140460, 148726, 148727, 103895, 248789, 54839, 148730, 133304, 235998]
2023-11-16 09:00:09.487 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 548976
2023-11-16 09:00:09.489 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 173042 99446 [101921, 234979, 148737, 148710, 155748, 145739, 96139, 101867, 102253, 148718, 101868, 140460, 148726, 148727, 103895, 248789, 54839, 148730, 133304]
2023-11-16 09:00:09.489 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 5ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:09.489 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 173042 99446 [101921, 234979, 148737, 148710, 155748, 145739, 96139, 101867, 102253, 148718, 101868, 140460, 148726, 148727, 103895, 248789, 54839, 148730, 133304]
2023-11-16 09:00:09.491 DEBUG 1 --- [     Thread-417] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 173042 99446 [54839, 96139, 101861, 101867, 101868, 101921, 102253, 103895, 107358, 133304, 134851, 140460, 145739, 148710, 148711, 148713, 148718, 148721, 148726, 148727, 148730, 148737, 155748, 234979, 235998, 248789]
2023-11-16 09:00:09.491 DEBUG 1 --- [     Thread-417] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 16ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:09.539 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 173042 99446 [234979, 148710, 155748, 101867, 101868, 140460]
2023-11-16 09:00:09.539 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 49ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:09.539 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 173042 99446 [234979, 148710, 155748, 101867, 101868, 140460]
2023-11-16 09:00:09.540 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 173042 99446 [234979, 148710, 155748, 101867, 101868, 140460]
2023-11-16 09:00:09.540 DEBUG 1 --- [     Thread-416] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:09.540 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 173042 and eventId 99446 and userIds [234979, 148710, 155748, 101867, 101868, 140460]
2023-11-16 09:00:09.540 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 173042 and eventId : 99446 
2023-11-16 09:00:09.540 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:09.547 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 6
2023-11-16 09:00:09.547 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 7ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:09.547 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 173042 99446
2023-11-16 09:00:09.547 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 173042
2023-11-16 09:00:09.547  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 173042
2023-11-16 09:00:09.547 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:09.548 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [173042] 
2023-11-16 09:00:09.553 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:09.553 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 5ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:09.553  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 173042, isUpdateAlert : true
2023-11-16 09:00:09.553  INFO 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:09.554 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:09.554  INFO 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:09.554 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"fbafc629-f68b-423c-8619-bc058b85dbc0","eventId":19868355,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:09.556  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868355, tenantId : 173042
2023-11-16 09:00:09.556 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"fbafc629-f68b-423c-8619-bc058b85dbc0","eventId":19868355,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41804
2023-11-16 09:00:09.556  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:09.556  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [1369, 127984, 7794, 3335] 
2023-11-16 09:00:09.556 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.605 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [48, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (1369,127984,7794,3335)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:09.605 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 48ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:09.676 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.715 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 548976
2023-11-16 09:00:09.716  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 548976
2023-11-16 09:00:09.716 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 548976 
2023-11-16 09:00:09.716 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 439ms : for accumulator : {}
2023-11-16 09:00:09.716 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 176350
2023-11-16 09:00:09.716 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (1369,127984,7794,3335)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:09.717 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 40ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:09.721 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_173042
2023-11-16 09:00:09.721 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_173042
2023-11-16 09:00:09.721 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:09.721 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 548976 
2023-11-16 09:00:09.721  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 548976
2023-11-16 09:00:09.721 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 548976 
2023-11-16 09:00:09.722 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 548976 
2023-11-16 09:00:09.722 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.725 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_173042
2023-11-16 09:00:09.725 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_173042
2023-11-16 09:00:09.730 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:09.740 DEBUG 1 --- [6_103335_176350] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 176350
2023-11-16 09:00:09.740 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 258ms : for accumulator : {}
2023-11-16 09:00:09.741 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 31
2023-11-16 09:00:09.741  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 176350
2023-11-16 09:00:09.741  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:09.742 DEBUG 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[2858],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [2858]
2023-11-16 09:00:09.743 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[2858],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22856
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_176350] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 176350, Took : 22s
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 485929 
2023-11-16 09:00:09.743  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:09.744 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:09.758 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, with SITE_IDS as(select unnest('{25153644,25153758,25153900,25154708,25887081,25888426,25891149,26575815,26835662,26836313,26842121,26842500,26842845,31546534,31550257,31550553,46674029,46674459,46674591,46674989,46676359,46677062,46677397,46677495,46678433,46679247,46679437,46679585,46679944,46680408,46681302,46681389,46681698,46681709,77712773,83661173,83661681,83662700,83663067,83663793,83665173,83668707,83669037,83669724,83672882}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[548976] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:09.758 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 36ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:09.758 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 548976
2023-11-16 09:00:09.776 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 433508
2023-11-16 09:00:09.793 DEBUG 1 --- [99446_103335_31] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 31
2023-11-16 09:00:09.794  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 31
2023-11-16 09:00:09.794  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:09.794 DEBUG 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[270,75792,75811,75804],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:09.796  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [270, 75792, 75811, 75804]
2023-11-16 09:00:09.796 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[270,75792,75811,75804],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22857
2023-11-16 09:00:09.797  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:09.797  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:09.797  INFO 1 --- [99446_103335_31] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 31, Took : 21s
2023-11-16 09:00:09.797  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1191400 
2023-11-16 09:00:09.797  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:09.798 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:09.836  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 173042
2023-11-16 09:00:09.836 DEBUG 1 --- [6_103335_173042] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.840 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 433508
2023-11-16 09:00:09.841  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 433508
2023-11-16 09:00:09.841 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 433508 
2023-11-16 09:00:09.846 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:09.846 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 433508 
2023-11-16 09:00:09.846  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 433508
2023-11-16 09:00:09.846 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 433508 
2023-11-16 09:00:09.846 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 433508 
2023-11-16 09:00:09.846 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.877 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (1369,127984,7794,3335) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:09.881 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_173042
2023-11-16 09:00:09.881 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 44ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:09.884 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:09.893 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [47, with SITE_IDS as(select unnest('{32749,40308,40310,44573,63635,69853,109691,1204813,1371403,1850678,1857151,1857502,1881386,2288516,2381972,3216862,3217411,3611810,3611899,3612151,3612154,3612838,3612956,3613167,3614160,3614168,3614169,3615062,3615332,3615692,3615709,3615780,3615946,3616050,3854922,3857334,3857335,3858772,5030579,5030580,12452139,12452172,12452366,12769668,12773288,12779961,12780551,13706313,13887224,13887225,13887226,13887227,13887228,13887229,14648911,23222710,23222918,23222932,23223172,23223354,23223813,23224130,23224666,23224920,23225277,23225555,23225727,23226117,23226157,23226226,23226794,23466170,31421438}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[433508] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:09.893 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 47ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:09.894 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 433508
2023-11-16 09:00:09.948 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 203ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:09.948 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:09.992 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [44, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 485929 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 485929), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =485929 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{533762,1649920,1649921,1659227,1659242,1659470,2343490}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 485929 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:09.994 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 45ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:09.994 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 485929 
2023-11-16 09:00:09.994 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.027 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, with SITE_IDS as ( select unnest('{533762,1649920,1649921,1659227,1659242,1659470,2343490}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 485929 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:10.029 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 485929
2023-11-16 09:00:10.029 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 34ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:10.086 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_548976
2023-11-16 09:00:10.086 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_548976
2023-11-16 09:00:10.086 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.118 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_433508
2023-11-16 09:00:10.119 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_433508
2023-11-16 09:00:10.119 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.122 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 81ms : for accumulator : {}
2023-11-16 09:00:10.122 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 173042
2023-11-16 09:00:10.130 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, with SITEID as( select * from ( select unnest(array[26836313,46679944,26842845,46679437,25891149,31546534,46679247,83661173,83661681,83663793,46677062,83672882,46676359,26842121,31550257,46680408,83662700,83669037,26575815,25153644,25153900,46674459,26835662,46674591,26842500,46677397,46681302,83668707,83669724,25153758,25888426,25887081,77712773,46674029,46674989,46681389,46681709,83663067,46678433,46679585,83665173,46681698,25154708,31550553,46677495]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:10.130 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 43ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:10.133 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_548976
2023-11-16 09:00:10.134 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 47ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_548976
2023-11-16 09:00:10.143 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_548976
2023-11-16 09:00:10.144 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 9ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:10.144 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 548976 
2023-11-16 09:00:10.144  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 548976
2023-11-16 09:00:10.158 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 485929, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:10.158 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868357 and EventDetID : 99446 
2023-11-16 09:00:10.158 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 485929
2023-11-16 09:00:10.158 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868357
2023-11-16 09:00:10.158 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.159 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868357 and Event_Details ID : 99446 
2023-11-16 09:00:10.159 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.159 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.159 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.160 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with SITEID as( select * from ( select unnest(array[3616050,3857334,3857335,14648911,23226226,3612838,63635,3615780,3611810,12452139,13706313,44573,23225727,1371403,23224130,31421438,2288516,13887227,13887226,1850678,13887225,3612956,13887224,13887229,13887228,2381972,12452366,23225555,3217411,1881386,23224666,23224920,3612151,1857502,12780551,12769668,23226794,3611899,3612154,23226157,3615332,23222710,3613167,23223354,69853,23466170,1204813,23225277,3615062,1857151,23222918,23223172,3614160,23223813,23226117,3615709,12773288,32749,3614169,3858772,3216862,3614168,3854922,12452172,40308,40310,23222932,5030580,109691,12779961,3615692,3615946,5030579]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:10.160 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 41ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:10.163 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_433508
2023-11-16 09:00:10.163 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 44ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_433508
2023-11-16 09:00:10.166 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 485929 -- Resulted rows -- [1]
2023-11-16 09:00:10.166 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 6ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:10.166 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 485929 : false : false : 19868357 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 485929
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 485929
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 485929
2023-11-16 09:00:10.171  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 485929
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 485929 
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 485929 
2023-11-16 09:00:10.171 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.172 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_433508
2023-11-16 09:00:10.172 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 8ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:10.172 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 433508 
2023-11-16 09:00:10.172  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 433508
2023-11-16 09:00:10.176 DEBUG 1 --- [6_103335_173042] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 173042
2023-11-16 09:00:10.177  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 173042
2023-11-16 09:00:10.177  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:10.177 DEBUG 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[7794,1369,127984,3335],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:10.179  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [7794, 1369, 127984, 3335]
2023-11-16 09:00:10.179  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.179  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.179 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[7794,1369,127984,3335],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22858
2023-11-16 09:00:10.179  INFO 1 --- [6_103335_173042] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 173042, Took : 4s
2023-11-16 09:00:10.179  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1286506 
2023-11-16 09:00:10.179  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.180 DEBUG 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.186 DEBUG 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 6ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.186 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1286506, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1286506
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868360
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.187 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.188 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.188 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.190 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1286506 -- Resulted rows -- [1]
2023-11-16 09:00:10.190 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.190 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1286506 : null : null : 19868360 : Update published
2023-11-16 09:00:10.192 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1286506
2023-11-16 09:00:10.192 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.192 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1286506
2023-11-16 09:00:10.192  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1286506
2023-11-16 09:00:10.192  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1286506 
2023-11-16 09:00:10.192 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.193 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1286506] 
2023-11-16 09:00:10.195 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.195 DEBUG 1 --- [_103335_1286506] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.195 DEBUG 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1286506 
2023-11-16 09:00:10.195 DEBUG 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1286506 
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286506] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1286506, Took : 0s
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1286542 
2023-11-16 09:00:10.195  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.196 DEBUG 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 1ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 6ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1286542, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1286542
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868361
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.203 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.204 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.204 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.206 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1286542 -- Resulted rows -- [1]
2023-11-16 09:00:10.206 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.206 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1286542 : null : null : 19868361 : Update published
2023-11-16 09:00:10.207 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (485929,832227,6236) and event_details_id = 99446] 
2023-11-16 09:00:10.208 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1286542
2023-11-16 09:00:10.208 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.208 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1286542
2023-11-16 09:00:10.208  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1286542
2023-11-16 09:00:10.208  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1286542 
2023-11-16 09:00:10.208 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.208 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1286542] 
2023-11-16 09:00:10.210 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.210 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_485929
2023-11-16 09:00:10.210 DEBUG 1 --- [_103335_1286542] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.210 DEBUG 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1286542 
2023-11-16 09:00:10.210 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 485929
2023-11-16 09:00:10.211 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 39ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:10.211 DEBUG 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1286542 
2023-11-16 09:00:10.211  INFO 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [485929]
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1286542] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1286542, Took : 0s
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1287258 
2023-11-16 09:00:10.211  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.212  INFO 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Site Anchors Ids for tenantId - [485929]
2023-11-16 09:00:10.212 DEBUG 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.212 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 485929 
2023-11-16 09:00:10.212 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 485929 
2023-11-16 09:00:10.212 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.214 DEBUG 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 2ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.214 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1287258, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.214 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.214 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1287258
2023-11-16 09:00:10.215 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868362
2023-11-16 09:00:10.215 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.215 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.215 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.215 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.216 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.218 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1287258 -- Resulted rows -- [1]
2023-11-16 09:00:10.218 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.218 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1287258 : null : null : 19868362 : Update published
2023-11-16 09:00:10.219 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1287258
2023-11-16 09:00:10.220 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.220 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1287258
2023-11-16 09:00:10.220  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1287258
2023-11-16 09:00:10.220  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1287258 
2023-11-16 09:00:10.220 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.220 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1287258] 
2023-11-16 09:00:10.221 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 548976 
2023-11-16 09:00:10.222 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.222 DEBUG 1 --- [_103335_1287258] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.222 DEBUG 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1287258 
2023-11-16 09:00:10.222 DEBUG 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1287258 
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287258] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1287258, Took : 0s
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1287256 
2023-11-16 09:00:10.222  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.223 DEBUG 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.225 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:10.225 DEBUG 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 2ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.226 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 548976 
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1287256, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1287256
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868363
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.226 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.227 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.227 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.229 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1287256 -- Resulted rows -- [1]
2023-11-16 09:00:10.229 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 1ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.229 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1287256 : null : null : 19868363 : Update published
2023-11-16 09:00:10.231 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1287256
2023-11-16 09:00:10.231 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 1ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.231 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1287256
2023-11-16 09:00:10.231  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1287256
2023-11-16 09:00:10.231  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1287256 
2023-11-16 09:00:10.231 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.231 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1287256] 
2023-11-16 09:00:10.234 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.234 DEBUG 1 --- [_103335_1287256] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.234 DEBUG 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1287256 
2023-11-16 09:00:10.234 DEBUG 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1287256 
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287256] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1287256, Took : 0s
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1287266 
2023-11-16 09:00:10.234  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.234 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 548976
2023-11-16 09:00:10.235 DEBUG 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 3ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1287266, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1287266
2023-11-16 09:00:10.239 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [27, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 485929 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (1649920,1649921,2343490)] 
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868364
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.239 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.240 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.240 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.240 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 485929
2023-11-16 09:00:10.241 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 28ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:10.241 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 433508 
2023-11-16 09:00:10.243 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1287266 -- Resulted rows -- [1]
2023-11-16 09:00:10.243 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.243 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1287266 : null : null : 19868364 : Update published
2023-11-16 09:00:10.246 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1287266
2023-11-16 09:00:10.246 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.246 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1287266
2023-11-16 09:00:10.246  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1287266
2023-11-16 09:00:10.246  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1287266 
2023-11-16 09:00:10.246 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.246 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1287266] 
2023-11-16 09:00:10.247 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:10.247 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 433508 
2023-11-16 09:00:10.249 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.250 DEBUG 1 --- [_103335_1287266] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.250 DEBUG 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1287266 
2023-11-16 09:00:10.250 DEBUG 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1287266 
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287266] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1287266, Took : 0s
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1287287 
2023-11-16 09:00:10.250  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.251 DEBUG 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [checkForExistingCustomer:892]: Time taken : 0ms : for query : select distinct es.id from event_shareable es inner join event_site esite on esite.is_deleted = false and es.is_deleted = false and es.event_details_id = ? and es.tenant_id = ? and es.id =esite.event_id and es.tenant_id = esite.tenant_id
2023-11-16 09:00:10.253 DEBUG 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchors:928]: Time taken : 2ms : for query : select distinct site_anchor_id from site_private where is_deleted = false and tenant_id = ? and site_anchor_id = ANY('{%s}'::BIGINT[])
2023-11-16 09:00:10.253 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1287287, isWhatIf : false, isALert : false, hasSites : true, isupdate : true
2023-11-16 09:00:10.253 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:00:10.253 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1287287
2023-11-16 09:00:10.254 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868365
2023-11-16 09:00:10.254 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.254 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:00:10.254 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.255 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.255 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.258 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 433508
2023-11-16 09:00:10.258 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1287287 -- Resulted rows -- [1]
2023-11-16 09:00:10.258 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set  SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false,   is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:00:10.258 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1287287 : null : null : 19868365 : Update published
2023-11-16 09:00:10.261 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1287287
2023-11-16 09:00:10.262 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.262 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1287287
2023-11-16 09:00:10.262  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1287287
2023-11-16 09:00:10.262  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1287287 
2023-11-16 09:00:10.262 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:00:10.262 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1287287] 
2023-11-16 09:00:10.265 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:10.265 DEBUG 1 --- [_103335_1287287] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:10.265 DEBUG 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1287287 
2023-11-16 09:00:10.266 DEBUG 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1287287 
2023-11-16 09:00:10.266  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:00:10.266  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:10.266  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:10.266  INFO 1 --- [_103335_1287287] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1287287, Took : 0s
2023-11-16 09:00:10.286 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [getSiteAnchorsForUpdate:853]: Time taken : 487ms : for query : with site_private_data as( select sp.id, sp.site_anchor_id from site_private sp where is_deleted = false and tenant_id = ? and site_anchor_id = any('{%s}'::bigint[])) select distinct sp.site_anchor_id from site_private_data sp left join event_site es on es.is_deleted = false and es.event_id = ? and es.tenant_id = ? and es.site_private_id = sp.id and es.created_date <( select publish_date from event_writeup ew where ew.event_details_id = ? and ew.selected_sites != '{}' order by publish_date desc limit 1) where es.event_id is null;
2023-11-16 09:00:10.286 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.299 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.326 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = 1191400 union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = 1191400), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =1191400 and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{30144,37163,45227,45989,46086,300111,300113,300114,322705,654391,743408,1069774,1657571,1657954,2450494}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 1191400 and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId] 
2023-11-16 09:00:10.328 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerSiteDs:960]: Time taken : 42ms : for query : with normalized_tenants as ( select distinct normalized_tenant_id tenant_id, is_deleted from rcm_subtier rs where (is_deleted = false or is_deleted is null) and customer_tenant_id = %s union select distinct company_provided_tenant_id tenant_id, is_deleted from resilinc_company_mapping rcm where (is_deleted = false or is_deleted is null) and resilinc_company_name = %s), SITE_IDS as (select array_agg(distinct site_anchor_id) as value, is_deleted from site_shareable where is_deleted = false and tenant_id =%s and protected_by_eventwatch = true and case when source_id = 1 then true else best_original_row = true end and site_anchor_id = any('{%s}'::bigint[]) group by is_deleted) select distinct on (SP.ID) SP.ID as siteId, SP.TENANT_ID as tenantId, sp.site_anchor_id as siteAnchorId from SITE_PRIVATE as SP inner join ( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = any(SITE_IDS.VALUE) inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id ) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID = TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID inner join site_shareable ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_anchor_id = sp.site_anchor_id and ss.protected_by_eventwatch=true and case when ss.source_id = 1 then true else best_original_row = true end inner join normalized_tenants nt on nt.is_deleted = false and nt.tenant_id = sp.tenant_id order by siteId, tenantId
2023-11-16 09:00:10.328 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:974]: executing query to get sub tier site anchors shared with customers and tier ones for tenant_id : 1191400 
2023-11-16 09:00:10.328 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.345 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, WITH SITE_IDS AS( SELECT UNNEST('{1649920,1649921,2343490}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[485929] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 485929 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:10.346 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 47ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:10.346 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 485929 
2023-11-16 09:00:10.367 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [39, with SITE_IDS as ( select unnest('{30144,37163,45227,45989,46086,300111,300113,300114,322705,654391,743408,1069774,1657571,1657954,2450494}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = 1191400 and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID] 
2023-11-16 09:00:10.369 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:987]: Done : executing query to get sub tier site anchors shared with customers and tier ones  for tenant_id : 1191400
2023-11-16 09:00:10.369 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteDs:991]: Time taken : 40ms : for query : with SITE_IDS as ( select unnest('{%s}'::bigint[]) as value, false as IS_DELETED) select distinct SP.SITE_ANCHOR_ID as SITE_ANCHOR_ID from SITE_PRIVATE as SP inner join( select distinct sp.site_owner_tenant_id, sp.SITE_ANCHOR_ID as SITE_ANCHOR_ID from site_private sp inner join SITE_IDS on sp.is_deleted = false and sp.tenant_id = %s and sp.SITE_ANCHOR_ID = SITE_IDS.VALUE inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = sp.tenant_id and ss.site_private_id = sp.id) as TEMP_S on SP.is_deleted = false and SP.TENANT_ID != TEMP_S.site_owner_tenant_id and SP.SITE_ANCHOR_ID = TEMP_S.SITE_ANCHOR_ID
2023-11-16 09:00:10.446 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 485929
2023-11-16 09:00:10.446 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 99ms : for accumlator : {}
2023-11-16 09:00:10.446 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 485929 
2023-11-16 09:00:10.450 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_485929
2023-11-16 09:00:10.450 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_485929
2023-11-16 09:00:10.450 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.492 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1191400, isWhatIf : false, isALert : false, hasSites : false, isupdate : true
2023-11-16 09:00:10.492 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : 19868359 and EventDetID : 99446 
2023-11-16 09:00:10.492 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1191400
2023-11-16 09:00:10.493 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868359
2023-11-16 09:00:10.493 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.493 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : 19868359 and Event_Details ID : 99446 
2023-11-16 09:00:10.493 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 485929 and total_cpns != '{}' and site_private_id = any('{52275929,52275930,69811888}')] 
2023-11-16 09:00:10.494 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:00:10.494 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:00:10.495 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: false, eventShareable.isSendPartnerImpactNotification: true, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): [polygon]eventShareable.getSeverity(): High
2023-11-16 09:00:10.497 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_485929
2023-11-16 09:00:10.498 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 47ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:10.498 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.498 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1191400 -- Resulted rows -- [1]
2023-11-16 09:00:10.498 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set SEND_CUSTOMER_IMPACT_NOTIFICATION = true, CUSTOMER_IMPACT_NOTIFICATION_SENT = false, SEND_PARTNER_IMPACT_NOTIFICATION = true, PARTNER_IMPACT_NOTIFICATION_SENT = false, event_modified_date = now(), SEVERITY= case when EVENT_SHAREABLE.overridden_severity = true then EVENT_SHAREABLE.SEVERITY ELSE ?::event_severity END, is_alert = ?, is_deleted = false , status = case when EVENT_SHAREABLE.status = 'Closed' then 'New' ELSE event_shareable.status END where id = ? and tenant_id = ?
2023-11-16 09:00:10.498 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1191400 : false : false : 19868359 : WarRoom Updated : New Regions/Sites added
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1191400
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 4ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventShareableForExistingTenant:367]: Event Timeline is WARROOM_UPDATED because previouse state is_alert = false and new state is_alert =false are same for event_id 99446 and tenant_id 1191400
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1191400
2023-11-16 09:00:10.503  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1191400
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1053]: Replicating Customer entities for tenant_id : 1191400 
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1092]: executing query to get event detail as Spark View for tenant_id : 1191400 
2023-11-16 09:00:10.503 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.526 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [28, with SITEID as( select * from ( select unnest(array[52275929,52275930,69811888]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:10.526 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 28ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:10.530 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_485929
2023-11-16 09:00:10.530 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 32ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_485929
2023-11-16 09:00:10.543 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_485929
2023-11-16 09:00:10.543 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 13ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:10.544 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 485929
2023-11-16 09:00:10.546 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [43, select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (1191400) and event_details_id = 99446] 
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_DETAIL_99446_1191400
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1110]: Done : executing query to get event detail as Spark View for tenant_id : 1191400
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventDetailViewForCustomer:1113]: Time taken : 46ms : for query : select distinct tenant_id, id as event_id from event_shareable where is_deleted = false and tenant_id in (%s) and event_details_id = %s
2023-11-16 09:00:10.550  INFO 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Site Anchors Ids for tenantId - [1191400]
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1126]: Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 1191400 
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1167]: executing query to get customer site_anchor_id(s) as Ds for tenant_id : 1191400 
2023-11-16 09:00:10.550 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.552 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 485929 
2023-11-16 09:00:10.552 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 485929 
2023-11-16 09:00:10.552 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 485929 
2023-11-16 09:00:10.552 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.576 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [25, select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = 1191400 AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (300114,1069774,45989,1657954,1657571,322705,37163,743408,300111,654391,46086,30144,300113,45227)] 
2023-11-16 09:00:10.577 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1175]: Done : executing query to get customer site_anchor_id(s) as Ds for tenant_id : 1191400
2023-11-16 09:00:10.577 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerAnchorIdDs:1179]: Time taken : 27ms : for query : select site_anchor_id as site_anchor_id from site_shareable ss where is_deleted = false and tenant_id = %s AND case when ss.source_id = 1 then true else ss.best_original_row = true end and ss.protected_by_eventwatch = true and site_anchor_id in (%s)
2023-11-16 09:00:10.586 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868357 and tenant_id = 485929] 
2023-11-16 09:00:10.586 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 34ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:10.633 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.638 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 548976
2023-11-16 09:00:10.639  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 548976
2023-11-16 09:00:10.639 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 548976 
2023-11-16 09:00:10.639 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.660 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_485929
2023-11-16 09:00:10.660 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 4ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_485929
2023-11-16 09:00:10.672 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_485929
2023-11-16 09:00:10.672 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 11ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:10.674 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [34, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 548976 and es.event_id = 19868358 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:10.674 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 34ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:10.675 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, WITH SITE_IDS AS( SELECT UNNEST('{30144,37163,45227,45989,46086,300111,300113,300114,322705,654391,743408,1069774,1657571,1657954}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, 157408::bigint AS created_by_id, 157408::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[1191400] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = 1191400 AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID] 
2023-11-16 09:00:10.675 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDs:1204]: Time taken : 42ms : for query : WITH SITE_IDS AS( SELECT UNNEST('{%s}'::bigint[]) AS site_anchor_id, FALSE AS IS_DELETED) SELECT DISTINCT SP.Id AS SITE_ID, CS.COMPANY_PRIVATE_ID AS COMPANY_ID, SP.SITE_ANCHOR_ID AS SITE_ANCHOR_ID, SP.TENANT_ID, cs.owner_tenant_id, 'weeks'::time_unit AS down_time_unit, %s::bigint AS created_by_id, %s::bigint AS last_modified_by_id, 'Potential'::event_impact_status AS impact_status, 'Pending'::impact_notification_status AS impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate FROM SITE_IDS INNER JOIN SITE_PRIVATE SP ON SITE_IDS.is_deleted = FALSE AND sp.is_deleted = FALSE AND sp.tenant_id = %s AND sp.SITE_ANCHOR_ID = SITE_IDS.site_anchor_id INNER JOIN SITE_SUMMARY SS ON SS.IS_DELETED = FALSE AND SS.TENANT_ID = SP.TENANT_ID AND SS.SITE_PRIVATE_ID = SP.ID INNER JOIN COMPANY_SUMMARY CS ON CS.IS_DELETED = FALSE AND CS.TENANT_ID = SS.TENANT_ID AND CS.ID = SS.COMPANY_SUMMARY_ID AND cs.COMPANY_PRIVATE_ID = SS.COMPANY_PRIVATE_ID
2023-11-16 09:00:10.675 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1218]: executing query of getting customer site Ids Dataset for tenant_id : 1191400 
2023-11-16 09:00:10.678 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_548976
2023-11-16 09:00:10.678 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_548976
2023-11-16 09:00:10.681 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:10.683 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 548976 
2023-11-16 09:00:10.686 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 14ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:10.690 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 485929 
2023-11-16 09:00:10.731  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 548976
2023-11-16 09:00:10.731 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 548976 
2023-11-16 09:00:10.738 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 548976 
2023-11-16 09:00:10.738  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:10.738 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 548976 
2023-11-16 09:00:10.738 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 548976
2023-11-16 09:00:10.816 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1236]: executing query of getting customer site Ids Dataset for tenant_id : 1191400
2023-11-16 09:00:10.816 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerSiteList:1239]: Time taken : 140ms : for accumlator : {}
2023-11-16 09:00:10.817 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1254]: Creating Views required for all entities of Customer for tenant_id : 1191400 
2023-11-16 09:00:10.821 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_CUSTOMER_DATA_SET_99446_1191400
2023-11-16 09:00:10.821 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1263]: Time taken : 4ms : for Sparkview : EVENT_CUSTOMER_DATA_SET_99446_1191400
2023-11-16 09:00:10.821 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.863 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 433508
2023-11-16 09:00:10.864  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 433508
2023-11-16 09:00:10.864 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 433508 
2023-11-16 09:00:10.864 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.868 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [46, select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = 1191400 and total_cpns != '{}' and site_private_id = any('{87836814,87836950,87837155,87837236,87837241,87838247,87838248,87838249,87838373,87839612,87840122,87840268,87840497,87840526}')] 
2023-11-16 09:00:10.873 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_WITH_PART_SET_99446_1191400
2023-11-16 09:00:10.873 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1276]: Time taken : 51ms : for query : select distinct ss.site_private_id as site_id, unnest(ss.total_cpns) as customer_part_number_id, tenant_id from site_summary ss where is_deleted = false and tenant_id = %s and total_cpns != '{}' and site_private_id = any('{%s}')
2023-11-16 09:00:10.873 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:10.958 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [84, with SITEID as( select * from ( select unnest(array[87839612,87837241,87840122,87837236,87836950,87840497,87840268,87836814,87840526,87838248,87838249,87838373,87838247,87837155]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:10.958 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 85ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:10.961 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [96, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 433508 and es.event_id = 19868356 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:10.962 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 97ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:10.964 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_SITE_ACTIVITY_SET_99446_1191400
2023-11-16 09:00:10.964 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1286]: Time taken : 91ms : for Sparkview : EVENT_SITE_ACTIVITY_SET_99446_1191400
2023-11-16 09:00:10.967 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_433508
2023-11-16 09:00:10.967 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 4ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_433508
2023-11-16 09:00:10.972 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 4ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:10.972 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 433508 
2023-11-16 09:00:10.984 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_CUSTOMER_VIEW_99446_1191400
2023-11-16 09:00:10.984 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1299]: Time taken : 19ms : for query : SELECT DISTINCT ECD.TENANT_ID, ED.EVENT_ID, ECD.SITE_ID, ECD.COMPANY_ID,ECD.SITE_ANCHOR_ID,ECD.DOWN_TIME_UNIT, ECD.created_by_id, ECD.LAST_MODIFIED_BY_ID, ECD.IMPACT_STATUS,ECD.IMPACT_NOTIFICATION_STATUS,ECD.AFFECTED_COMPANY_ID, ESPD.CUSTOMER_PART_NUMBER_ID, ESAD.RECOVERY_TIME AS DOWN_TIME, ECD.downtimeupdate as downTimeUpdate FROM EVENT_CUSTOMER_DATA_SET_%s_%s AS ECD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON ECD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_SITE_WITH_PART_SET_%s_%s ESPD ON ESPD.TENANT_ID = ECD.TENANT_ID AND ESPD.SITE_ID = ECD.SITE_ID LEFT JOIN EVENT_SITE_ACTIVITY_SET_%s_%s ESAD ON ESAD.SITE_ID = ECD.SITE_ID
2023-11-16 09:00:10.984 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalView:1302]: Done : Creating Views required for all entities of Customer for tenant_id : 1191400
2023-11-16 09:00:10.994 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createCustomerFinalDsAndView:1152]: Done : Creating final Ds and Views of 'event_company' & 'event_site' for Customer for tenant_id : 1191400 
2023-11-16 09:00:10.994 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateCustomerEntities:1077]: Done : Replicating Customer entities for tenant_id : 1191400 
2023-11-16 09:00:10.994 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1341]: Creating 'event_company' Dataset for tenant_id : 1191400 
2023-11-16 09:00:10.994 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:11.020 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [26, select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = 19868359 and tenant_id = 1191400] 
2023-11-16 09:00:11.020 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1397]: Time taken : 26ms : for query : select distinct tenant_id, event_id, company_private_id, overwritten_down_time, down_time, impact_status, down_time_unit from event_company ec where is_deleted = false and event_id = %s and tenant_id = %s
2023-11-16 09:00:11.056 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[195939, 253282, 173467, 205894, 80546, 279759, 177873, 88018, 177893, 193889, 195941, 204799, 191915, 91747, 182320, 182318, 204714, 201340, 177891, 239522, 279761, 213716, 279768, 249866, 174245, 177878, 173465, 249865, 239830, 182321, 205893, 185157, 240074, 246054, 177955, 279767, 279763, 177880, 182326, 177885, 182317, 240250, 173483, 182325, 237999, 199939, 177888, 173490, 204865, 177894, 252042, 177882, 215064, 216525, 182067, 252520, 266486, 173500, 177883, 195940, 235737, 191917, 276144, 279764, 252126, 182319, 242535, 177879, 254019, 173477, 231357]
2023-11-16 09:00:11.056 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 318ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:11.056 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 71 for customer 548976
2023-11-16 09:00:11.057 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[195939, 253282, 173467, 205894, 80546, 279759, 177873, 88018, 177893, 193889, 195941, 204799, 191915, 91747, 182320, 182318, 204714, 201340, 177891, 239522, 279761, 213716, 279768, 249866, 174245, 177878, 173465, 249865, 239830, 182321, 205893, 185157, 240074, 246054, 177955, 279767, 279763, 177880, 182326, 177885, 182317, 240250, 173483, 182325, 237999, 199939, 177888, 173490, 204865, 177894, 252042, 177882, 215064, 216525, 182067, 252520, 266486, 173500, 177883, 195940, 235737, 191917, 276144, 279764, 252126, 182319, 242535, 177879, 254019, 173477, 231357]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}548976
2023-11-16 09:00:11.076 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[195939, 253282, 173467, 205894, 80546, 279759, 177873, 88018, 177893, 193889, 195941, 204799, 191915, 91747, 182320, 182318, 204714, 201340, 177891, 239522, 279761, 213716, 279768, 249866, 174245, 177878, 173465, 249865, 239830, 182321, 205893, 185157, 240074, 246054, 177955, 279767, 279763, 177880, 182326, 177885, 182317, 240250, 173483, 182325, 237999, 199939, 177888, 173490, 204865, 177894, 252042, 177882, 215064, 216525, 182067, 252520, 266486, 173500, 177883, 195940, 235737, 191917, 276144, 279764, 252126, 182319, 242535, 177879, 254019, 173477, 231357]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}548976
2023-11-16 09:00:11.076 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 19ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:11.076 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 548976 99446 user with No pref [195939, 253282, 173467, 205894, 80546, 279759, 177873, 88018, 177893, 193889, 195941, 204799, 191915, 91747, 182320, 182318, 204714, 201340, 177891, 239522, 279761, 213716, 279768, 249866, 174245, 177878, 173465, 249865, 239830, 182321, 205893, 185157, 240074, 246054, 177955, 279767, 279763, 177880, 182326, 177885, 182317, 240250, 173483, 182325, 237999, 199939, 177888, 173490, 204865, 177894, 252042, 177882, 215064, 216525, 182067, 252520, 266486, 173500, 177883, 195940, 235737, 191917, 276144, 279764, 252126, 182319, 242535, 177879, 254019, 173477, 231357]
2023-11-16 09:00:11.078 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:11.078 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 548976 99446 [172592, 173480, 173481, 173482, 173484, 173486, 173489, 173491, 173492, 173493, 173494, 173495, 173504, 174248, 177877, 177881, 177886, 177887, 177892, 177947, 178894, 178945, 179978, 182322, 182323, 182324, 184752, 191950, 205081, 214258, 215413, 230455, 235305, 235736, 235809, 241924, 248064, 249035, 253141]
2023-11-16 09:00:11.079 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  548976 99446 
2023-11-16 09:00:11.079 DEBUG 1 --- [     Thread-419] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 548976 99446 [172592, 173480, 173481, 173482, 173484, 173486, 173489, 173491, 173492, 173493, 173494, 173495, 173504, 174248, 177877, 177881, 177886, 177887, 177892, 177947, 178894, 178945, 179978, 182322, 182323, 182324, 184752, 191950, 205081, 214258, 215413, 230455, 235305, 235736, 235809, 241924, 248064, 249035, 253141]
2023-11-16 09:00:11.083 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  548976 99446 
2023-11-16 09:00:11.083 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:?] : [calculateUserDetailwithEventType:1152]: Time taken : 4ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:11.083 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 548976 99446 [173504, 241924, 179978, 249035, 178894, 253141, 177947, 205081, 177881, 177886, 235809, 177892, 173482, 173480, 174248, 235305, 173486, 173484, 173491, 182323, 214258, 172592, 173494, 230455, 173495, 173492, 215413, 173493]
2023-11-16 09:00:11.090 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 548976 99446 [173504, 241924, 179978, 249035, 178894, 253141, 177947, 177881, 177886, 235809, 177892, 173482, 173480, 174248, 235305, 173486, 173484, 173491, 182323, 214258, 172592, 173494, 230455, 173495, 173492, 215413, 173493]
2023-11-16 09:00:11.090 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 6ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:11.090 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 548976 99446 [173504, 241924, 179978, 249035, 178894, 253141, 177947, 177881, 177886, 235809, 177892, 173482, 173480, 174248, 235305, 173486, 173484, 173491, 182323, 214258, 172592, 173494, 230455, 173495, 173492, 215413, 173493]
2023-11-16 09:00:11.105 DEBUG 1 --- [     Thread-419] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 548976 99446 [172592, 173480, 173481, 173482, 173484, 173486, 173489, 173491, 173492, 173493, 173494, 173495, 173504, 174248, 177877, 177881, 177886, 177887, 177892, 177947, 178894, 178945, 179978, 182322, 182323, 182324, 184752, 191950, 205081, 214258, 215413, 230455, 235305, 235736, 235809, 241924, 248064, 249035, 253141]
2023-11-16 09:00:11.106 DEBUG 1 --- [     Thread-419] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 26ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:11.241  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 433508
2023-11-16 09:00:11.241 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 433508 
2023-11-16 09:00:11.243 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : GET_EVENT_COMPANY_UPDATE_99446_1191400
2023-11-16 09:00:11.244 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1406]: Time taken : 6ms : for Sparkview : GET_EVENT_COMPANY_UPDATE_99446_1191400
2023-11-16 09:00:11.245 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 433508 
2023-11-16 09:00:11.245  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:11.245 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 433508 
2023-11-16 09:00:11.245 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 433508
2023-11-16 09:00:11.256 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SPARK_QUERY_EVENT_COMPANY_VIEW_99446_1191400
2023-11-16 09:00:11.257 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1422]: Time taken : 12ms : for query : select tenant_id as tenantId, event_id as eventId, company_id as companyId, cast(NULL AS INT) as eventCompanyId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime, downtimeupdate as downTimeUpdate from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, company_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status, downTimeUpdate
2023-11-16 09:00:11.267 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForUpateCustomer:1435]: Time taken : 10ms : for query : select distinct GEC.company_private_id as eventCompanyId, FCV.companyId as companyId, FCV.eventId as eventId, FCV.tenantId as tenantId, FCV.sharedCustomers as sharedCustomers, FCV.sourceId as sourceId, FCV.userId as userId, FCV.impactNotificationStatus as impactNotificationStatus, case when GEC.company_private_id is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then GEC.impact_status when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.impactstatus when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.impact_status else FCV.impactstatus end else FCV.impactstatus end as impactStatus, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.down_time > FCV.downTime then GEC.down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.down_time else FCV.downTime end when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then case when GEC.impact_status = 'Potential' and FCV.impactstatus = 'Potential' then case when GEC.overwritten_down_time > FCV.downTime then GEC.overwritten_down_time else FCV.downTime end when GEC.impact_status = 'No Impact' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Restored' and FCV.impactstatus = 'Potential' then FCV.downTime when GEC.impact_status = 'Confirmed' and FCV.impactstatus = 'Potential' then GEC.overwritten_down_time else FCV.downTime end else FCV.downTime end as downTime, case when GEC.company_private_id is not null and GEC.overwritten_down_time is null then 'downTime' when GEC.company_private_id is not null and GEC.overwritten_down_time is not null then 'overWrittenDownTime' else 'downTime' end as downTimeUpdate from SPARK_QUERY_EVENT_COMPANY_VIEW_%s_%s as FCV left join GET_EVENT_COMPANY_UPDATE_%s_%s as GEC on FCV.companyId = GEC.company_private_id and FCV.tenantId = GEC.tenant_id and FCV.eventId = GEC.event_id
2023-11-16 09:00:11.269 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyDsForCustomer:1349]: Done : final dataset for 'event_company' for tenant_id : 1191400 
2023-11-16 09:00:11.471 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[192505, 191894, 148125, 135732, 250045, 191893, 241176, 217157]
2023-11-16 09:00:11.471 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 226ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:11.471 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 8 for customer 433508
2023-11-16 09:00:11.472 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[192505, 191894, 148125, 135732, 250045, 191893, 241176, 217157]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}433508
2023-11-16 09:00:11.476 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[192505, 191894, 148125, 135732, 250045, 191893, 241176, 217157]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}433508
2023-11-16 09:00:11.476 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 4ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:11.476 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 433508 99446 user with No pref [192505, 191894, 148125, 135732, 250045, 191893, 241176, 217157]
2023-11-16 09:00:11.478 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:11.479 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 433508 99446 [5357, 148054, 148055, 148056, 148123, 191895, 241177, 241178]
2023-11-16 09:00:11.479 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  433508 99446 
2023-11-16 09:00:11.479 DEBUG 1 --- [     Thread-421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 433508 99446 [5357, 148054, 148055, 148056, 148123, 191895, 241177, 241178]
2023-11-16 09:00:11.482 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  433508 99446 
2023-11-16 09:00:11.483 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 3ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:11.486 DEBUG 1 --- [     Thread-421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 433508 99446 [5357, 148054, 148055, 148056, 148123, 191895, 241177, 241178]
2023-11-16 09:00:11.488 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 433508 99446 [191895, 241177, 5357]
2023-11-16 09:00:11.488 DEBUG 1 --- [     Thread-421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 8ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:11.490 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 433508 99446 [191895, 241177, 5357]
2023-11-16 09:00:11.490 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 2ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:11.490 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 433508 99446 [191895, 241177, 5357]
2023-11-16 09:00:11.499 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 433508 99446 [191895, 5357]
2023-11-16 09:00:11.499 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 9ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:11.499 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 433508 99446 [191895, 5357]
2023-11-16 09:00:11.502 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 433508 99446 [191895]
2023-11-16 09:00:11.502 DEBUG 1 --- [     Thread-420] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 2ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:11.503 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 433508 and eventId 99446 and userIds [191895]
2023-11-16 09:00:11.503 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 433508 and eventId : 99446 
2023-11-16 09:00:11.503 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:11.507 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 1
2023-11-16 09:00:11.507 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 3ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:11.507 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 433508 99446
2023-11-16 09:00:11.507 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 433508
2023-11-16 09:00:11.507  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 433508
2023-11-16 09:00:11.508 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:11.508 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [433508] 
2023-11-16 09:00:11.511 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:11.511 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:11.511  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 433508, isUpdateAlert : true
2023-11-16 09:00:11.511  INFO 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:11.512 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:11.512  INFO 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:11.512 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"35a18871-0559-441f-aafb-34d4d3ee397b","eventId":19868356,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:11.514  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868356, tenantId : 433508
2023-11-16 09:00:11.514  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:11.514 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"35a18871-0559-441f-aafb-34d4d3ee397b","eventId":19868356,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41805
2023-11-16 09:00:11.514  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [1375, 1099, 7837, 292, 1449, 1388, 2177, 8979, 152724, 273, 293, 1404, 12844, 151133, 111, 192034, 192052, 178827, 150001, 131459, 90, 192401, 192448, 22682, 592, 190972, 190987, 2281, 192, 37128, 198844, 231667, 440511, 440544, 440740, 5963, 167553, 442931, 443521, 2833, 451208, 5798, 311, 2956, 156914, 160425, 237, 150727, 148401, 440803, 167672, 5755] 
2023-11-16 09:00:11.514 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:11.552 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [38, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (1375,1099,7837,292,1449,1388,2177,8979,152724,273,293,1404,12844,151133,111,192034,192052,178827,150001,131459,90,192401,192448,22682,592,190972,190987,2281,192,37128,198844,231667,440511,440544,440740,5963,167553,442931,443521,2833,451208,5798,311,2956,156914,160425,237,150727,148401,440803,167672,5755)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:11.552 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 38ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:11.751 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:11.785 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (1375,1099,7837,292,1449,1388,2177,8979,152724,273,293,1404,12844,151133,111,192034,192052,178827,150001,131459,90,192401,192448,22682,592,190972,190987,2281,192,37128,198844,231667,440511,440544,440740,5963,167553,442931,443521,2833,451208,5798,311,2956,156914,160425,237,150727,148401,440803,167672,5755)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:11.785 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 33ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:11.788 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_433508
2023-11-16 09:00:11.788 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_433508
2023-11-16 09:00:11.791 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_433508
2023-11-16 09:00:11.791 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 2ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_433508
2023-11-16 09:00:11.795 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 3ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:11.885 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 485929
2023-11-16 09:00:11.922 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 485929
2023-11-16 09:00:11.923  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 485929
2023-11-16 09:00:11.924 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 485929 
2023-11-16 09:00:11.929 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:11.929 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 485929 
2023-11-16 09:00:11.929  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 485929
2023-11-16 09:00:11.929 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 485929 
2023-11-16 09:00:11.929 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1560]: executing query of getting Partner anchor Ids Dataset for tenant_id : 485929 
2023-11-16 09:00:11.929 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:11.980 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [50, with SITE_IDS as(select unnest('{52276632,52277133,69812426}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,157408::bigint as created_by_id,157408::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[485929] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id] 
2023-11-16 09:00:11.981 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1571]: Time taken : 51ms : for query : with SITE_IDS as(select unnest('{%s}'::bigint[]) as site_private_id, false as IS_DELETED) select DISTINCT SBP.SITE_PRIVATE_ID as site_id, CP.id as company_id, sbp.site_anchor_id as site_anchor_id, sbp.tenant_id as tenant_id, sbp.tenant_id as owner_tenant_id, 'weeks'::time_unit as down_time_unit,%s::bigint as created_by_id,%s::bigint as last_modified_by_id,'Potential'::event_impact_status as impact_status,'Pending'::impact_notification_status as impact_notification_status, ARRAY[%s] as affected_company_id, 'downTime' as downTimeUpdate from SITE_IDS inner join SITE_BY_PATH SBP on SITE_IDS.IS_DELETED = false and SBP.IS_DELETED = false and SBP.SITE_PRIVATE_ID = SITE_IDS.SITE_PRIVATE_ID inner join SITE_SHAREABLE SS on SS.IS_DELETED = false and ss.site_anchor_id = sbp.site_anchor_id and ss.tenant_id = sbp.tenant_id and case when SS.source_id = 1 then true else SS.best_original_row = true end and SS.PROTECTED_BY_EVENTWATCH = true inner join COMPANY_BY_PATH CBP on CBP.IS_DELETED = false and CBP.ID = SBP.COMPANY_ID and CBP.TENANT_ID = SBP.TENANT_ID inner join company_private cp on cp.is_deleted = false and cp.tenant_id = cbp.tenant_id and cp.id = cbp.company_private_id
2023-11-16 09:00:11.981 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerAnchorIdDs:1574]: Done : executing query of getting Partner anchor Ids Dataset for tenant_id : 485929
2023-11-16 09:00:12.118  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 433508
2023-11-16 09:00:12.118 DEBUG 1 --- [6_103335_433508] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:12.176 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [57, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (1375,1099,7837,292,1449,1388,2177,8979,152724,273,293,1404,12844,151133,111,192034,192052,178827,150001,131459,90,192401,192448,22682,592,190972,190987,2281,192,37128,198844,231667,440511,440544,440740,5963,167553,442931,443521,2833,451208,5798,311,2956,156914,160425,237,150727,148401,440803,167672,5755) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:12.180 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_433508
2023-11-16 09:00:12.180 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 62ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:12.183 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:12.206 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:444]: Writing Customer details to 'event_company' -- for Customer tenant_id -- 1191400
2023-11-16 09:00:12.230 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_DATA_SET_99446_485929
2023-11-16 09:00:12.230 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1596]: Time taken : 4ms : for Sparkview : EVENT_PARTNER_DATA_SET_99446_485929
2023-11-16 09:00:12.230 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:12.272 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [41, with SITEID as( select * from ( select unnest(array[52277133,69812426,52276632]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id] 
2023-11-16 09:00:12.272 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createDownTimeDs:1324]: Time taken : 42ms : for query : with SITEID as( select * from ( select unnest(array[%s]::bigint[]) site_private_id) tmp) select MAX(GET_DOWN_TIME_IN_WEEKS(SA.RECOVERY_TIME, SA.RECOVERY_TIME_UNIT, true)) as RECOVERY_TIME, SBP.site_private_id as site_id from SITE_BY_PATH SBP inner join SITEID on SBP.is_deleted = false and SITEID.site_private_id = SBP.site_private_id left join SITE_ACTIVITY SA on SA.is_deleted = false and SA.PRIMARY_SITE_ID = SBP.ID and SA.TENANT_ID = SBP.TENANT_ID and SA.BEST_ORIGINAL_ROW = true group by sbp.site_private_id
2023-11-16 09:00:12.276 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_485929
2023-11-16 09:00:12.276 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1607]: Time taken : 46ms : for Sparkview : EVENT_PARTNER_SITE_ACTIVITY_SET_99446_485929
2023-11-16 09:00:12.286 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventCompanyForCustomer:449]: Done Writing Customer details to 'event_company' -- for Customer tenant_id -- 1191400
2023-11-16 09:00:12.287  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:372]: Done replicating event_company for customer for tenant_id : 1191400
2023-11-16 09:00:12.287 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1461]: Creating 'event_site' Dataset for tenant_id : 1191400 
2023-11-16 09:00:12.287 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : FINAL_PARTNER_VIEW_99446_485929
2023-11-16 09:00:12.287 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createFinalViewForPartner:1621]: Time taken : 10ms : for query : SELECT DISTINCT EPD.TENANT_ID, ED.EVENT_ID, EPD.SITE_ID, EPD.COMPANY_ID,EPD.SITE_ANCHOR_ID,EPD.DOWN_TIME_UNIT, EPD.created_by_id, EPD.LAST_MODIFIED_BY_ID, EPD.IMPACT_STATUS,EPD.IMPACT_NOTIFICATION_STATUS,EPD.AFFECTED_COMPANY_ID, EPSAD.RECOVERY_TIME AS DOWN_TIME, downtimeupdate as downTimeUpdate FROM EVENT_PARTNER_DATA_SET_%s_%s AS EPD INNER JOIN EVENT_DETAIL_%s_%s AS ED ON EPD.TENANT_ID = ED.TENANT_ID LEFT JOIN EVENT_PARTNER_SITE_ACTIVITY_SET_%s_%s EPSAD ON EPSAD.SITE_ID = EPD.SITE_ID
2023-11-16 09:00:12.287 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1542]: Done : create 'event_site' dataset & view for Partners for tenant_id : 485929 
2023-11-16 09:00:12.287  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : true for this customer : 99446 and event : 485929
2023-11-16 09:00:12.292 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1473]: Time taken : 5ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_CUSTOMER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:12.293 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForCustomer:1476]: Done : final dataset for 'event_site' for tenant_id : 1191400 
2023-11-16 09:00:12.293  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:377]: Done replicating event_site for customer for tenant_id : 1191400
2023-11-16 09:00:12.293 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createPartnerFinalDsAndView:1518]: create 'event_site' dataset & view for Partners for tenant_id : 1191400 
2023-11-16 09:00:12.293  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicatePartnerEntities:730]: PartnerDetail Exist : false for this customer : 99446 and event : 1191400
2023-11-16 09:00:12.293 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 1191400
2023-11-16 09:00:12.366 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1491]: Creating 'event_site' Dataset for Partner for tenant_id : 485929 
2023-11-16 09:00:12.370 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1501]: Time taken : 4ms : for query : select tenant_id as tenantId, event_id as eventId, site_id as siteId, site_id as eventSiteId, affected_company_id as sharedCustomers, created_by_id as userId, tenant_id as sourceId, impact_status as impactStatus, impact_notification_status as impactNotificationStatus, MAX(down_time) as downTime from FINAL_PARTNER_VIEW_%s_%s group by tenant_id, event_id, site_id, affected_company_id, created_by_id, down_time_unit, impact_status, impact_notification_status
2023-11-16 09:00:12.371 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventSiteDsForPartner:1504]: Done : final dataset for 'event_site' for Partner for tenant_id : 485929 
2023-11-16 09:00:12.380 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:602]: Writing records into 'event_site' -- for Customer tenant_id -- 485929
2023-11-16 09:00:12.439 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 1191400
2023-11-16 09:00:12.440  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 1191400
2023-11-16 09:00:12.440 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 1191400 
2023-11-16 09:00:12.440 DEBUG 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:12.477 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [37, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 1191400 and es.event_id = 19868359 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:12.478 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 37ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:12.481 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_1191400
2023-11-16 09:00:12.481 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_1191400
2023-11-16 09:00:12.484 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 2ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:12.484 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 1191400 
2023-11-16 09:00:12.553  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 1191400
2023-11-16 09:00:12.553 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1191400 
2023-11-16 09:00:12.556 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1191400 
2023-11-16 09:00:12.556  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): false, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:12.556 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 1191400 
2023-11-16 09:00:12.556 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 1191400
2023-11-16 09:00:12.575 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[154990, 289284, 298194, 301973, 293944, 298193, 289285, 289286, 293943, 301971, 293925, 301972]
2023-11-16 09:00:12.575 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 19ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:12.576 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 12 for customer 1191400
2023-11-16 09:00:12.576 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[154990, 289284, 298194, 301973, 293944, 298193, 289285, 289286, 293943, 301971, 293925, 301972]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1191400
2023-11-16 09:00:12.610 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[154990, 289284, 298194, 301973, 293944, 298193, 289285, 289286, 293943, 301971, 293925, 301972]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}1191400
2023-11-16 09:00:12.610 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 34ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:12.610 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 1191400 99446 user with No pref [154990, 289284, 298194, 301973, 293944, 298193, 289285, 289286, 293943, 301971, 293925, 301972]
2023-11-16 09:00:12.612 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:12.612 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 1191400 99446 [262755, 293945, 298195]
2023-11-16 09:00:12.612 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  1191400 99446 
2023-11-16 09:00:12.612 DEBUG 1 --- [     Thread-423] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 1191400 99446 [262755, 293945, 298195]
2023-11-16 09:00:12.614 DEBUG 1 --- [     Thread-423] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 1191400 99446 [262755, 293945, 298195]
2023-11-16 09:00:12.614 DEBUG 1 --- [     Thread-423] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 1ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:12.615 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  1191400 99446 
2023-11-16 09:00:12.615 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:12.615 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 1191400 99446 [262755, 298195, 293945]
2023-11-16 09:00:12.616 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 1191400 99446 [262755, 298195, 293945]
2023-11-16 09:00:12.616 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 1ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:12.616 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 1191400 99446 [262755, 298195, 293945]
2023-11-16 09:00:12.619 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 1191400 99446 [262755]
2023-11-16 09:00:12.620 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 3ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:12.620 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 1191400 99446 [262755]
2023-11-16 09:00:12.620 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 1191400 99446 [262755]
2023-11-16 09:00:12.620 DEBUG 1 --- [     Thread-422] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:12.620 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 1191400 and eventId 99446 and userIds [262755]
2023-11-16 09:00:12.620 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 1191400 and eventId : 99446 
2023-11-16 09:00:12.620 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 1
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 2ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 1191400 99446
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 1191400
2023-11-16 09:00:12.623  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 1191400
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:12.623 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1191400] 
2023-11-16 09:00:12.625 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:12.626 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:12.626  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 1191400, isUpdateAlert : true
2023-11-16 09:00:12.626  INFO 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:12.626 DEBUG 1 --- [_103335_1191400] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:12.627  INFO 1 --- [_103335_1191400] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:12.627 DEBUG 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"3324fa1c-c2ff-47be-9fb6-1bc656ee1f3d","eventId":19868359,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868359, tenantId : 1191400
2023-11-16 09:00:12.629 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"3324fa1c-c2ff-47be-9fb6-1bc656ee1f3d","eventId":19868359,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41806
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): false, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [] 
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:12.629  INFO 1 --- [_103335_1191400] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1191400, Took : 2s
2023-11-16 09:00:12.760 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventSite:607]: Done Writing records into 'event_site' -- for Customer tenant_id -- 485929
2023-11-16 09:00:12.762  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:387]: Done replicating event_site for partner for tenant_id : 485929
2023-11-16 09:00:12.762 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1682]: Creating 'event_customer_part_number' Dataset for tenant_id : 485929 
2023-11-16 09:00:12.762 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:12.772 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 122ms : for accumulator : {}
2023-11-16 09:00:12.772 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 433508
2023-11-16 09:00:12.802 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [40, with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = 485929 and es.event_id = 19868357 group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null] 
2023-11-16 09:00:12.803 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1743]: Time taken : 40ms : for query : with cpn_data as( select distinct es.tenant_id as internal_tenant_id, es.event_id, unnest(total_cpns) as customer_part_number_id, case when MAX(ES.OVERWRITTEN_DOWN_TIME) is not null then MAX(ES.OVERWRITTEN_DOWN_TIME) else coalesce(MAX(ES.DOWN_TIME), 52) end as DOWN_TIME, 'weeks'::time_unit as DOWN_TIME_UNIT, 'Potential'::EVENT_IMPACT_STATUS as impact_status, false as is_deleted, es.created_by_id as internal_created_by_id, es.last_modified_by_id as internal_last_modified_by_id from site_summary ss inner join event_site es on es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id and ss.total_cpns != '{}' and es.tenant_id = %s and es.event_id = %s group by 1, 2, 3, 5, 6, 8, 9) select distinct cd.internal_tenant_id as tenantId, cd.internal_created_by_id as userId, cd.customer_part_number_id as customerPartId, cd.event_id as eventId, cd.impact_status as impactStatus, cd.DOWN_TIME :: numeric as downTime from cpn_data cd left join event_customer_part_number ecpn on cd.customer_part_number_id = ecpn.customer_part_number_id and ecpn.event_id = cd.event_id and ecpn.tenant_id = cd.internal_tenant_id where ecpn.event_id is null or ecpn.customer_part_number_id is null
2023-11-16 09:00:12.806 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : SELECT_EVENT_CPN_UPDATE_99446_485929
2023-11-16 09:00:12.806 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1754]: Time taken : 3ms : for sparkView : SELECT_EVENT_CPN_UPDATE_99446_485929
2023-11-16 09:00:12.809 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createECPNDsForUpdate:1766]: Time taken : 3ms : for query : select tenantId as tenantId, eventId as eventId, customerPartId as customerPartId, userId as userId, impactStatus as impactStatus, MAX(downTime) as downTime from SELECT_EVENT_CPN_UPDATE_%s_%s where customerPartId is not null group by tenantId, eventId, customerPartId, userId, impactStatus
2023-11-16 09:00:12.809 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [replicateEventCustomerPart:1690]: Done : final dataset for 'event_customer_part_number' for tenant_id : 485929 
2023-11-16 09:00:12.885  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:393]: Done replicating event_customer_part_number for tenant_id : 485929
2023-11-16 09:00:12.885 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 485929 
2023-11-16 09:00:12.888 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 485929 
2023-11-16 09:00:12.888  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : true, eventShareable.hasNoSites() : false, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : false 
2023-11-16 09:00:12.888 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:912]: Creating a data Set for event_user for this event_id 99446 and tenant_id 485929 
2023-11-16 09:00:12.888 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1409]: Calculating user with no pref for customer 485929
2023-11-16 09:00:12.906 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1435]: Calculating user with no pref user[168262, 168256, 88018, 236029, 166301]
2023-11-16 09:00:12.906 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithNoPref:1437]: Time taken : 17ms : for query : select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( select distinct US.USER_ANCHOR_ID from USER_PART_CATEGORY as UPC inner join PART_CATEGORY_SHAREABLE PCS on UPC.is_deleted = false and PCS.is_deleted = false and upc.tenant_id = ? and upc.tenant_id = pcs.tenant_id and PCS.ID = UPC.PART_CATEGORY_ID inner join PART_CATEGORY as PC on PC.is_deleted = false and pc.tenant_id = pcs.tenant_id and UPC.PART_CATEGORY_ID = PC.PART_CATEGORY_SHAREABLE_ID inner join user_shareable US on US.is_deleted = false and us.tenant_id = pc.tenant_id and US.USER_ANCHOR_ID = UPC.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and us.tenant_id = USER_ROLES.tenant_id and US.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect select distinct up.user_anchor_id as user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in( with uta_data as ( select distinct UTA.USER_ANCHOR_ID USER_ANCHOR_ID, uta.tenant_id, uta.is_deleted from USER_TENANT_ACCESS UTA inner join company_summary as cs on UTA.is_deleted = false and cs.is_deleted = false and uta.tenant_id = ? and cs.tenant_id = uta.tenant_id and Cs.OWNER_TENANT_ID = UTA.ALLOWED_TENANT_ID) select distinct ud.USER_ANCHOR_ID from USER_SHAREABLE US inner join uta_data ud on US.is_deleted = false and ud.is_deleted = false and US.USER_ANCHOR_ID = ud.USER_ANCHOR_ID and ud.tenant_id = us.tenant_id and us.best_original_row = true inner join PUBLIC.USER_ROLES on PUBLIC.USER_ROLES.is_deleted = false and ud.tenant_id = USER_ROLES.tenant_id and ud.USER_ANCHOR_ID = USER_ROLES.USER_ANCHOR_ID inner join PUBLIC.ROLES on PUBLIC.ROLES.is_deleted = false and USER_ROLES.ROLE_ID = ROLES.ID and ROLE_NAME in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and USER_ROLE.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM' and value ->> 'eventTypes' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'WARROOM_USER_SETTING' and module = 'EVENTWAR_ROOM')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE' and value ->> 'countries' = '[]' inner join USER_PRIVATE UP on UP.is_deleted = false and UP.tenant_id = US.tenant_id and up.user_anchor_id = us.user_anchor_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and module = 'USER_PREFERENCE')) intersect (select distinct us.user_anchor_id as user_anchor_id from app_config inner join user_shareable US on app_config.is_deleted = false and US.is_deleted = false and us.tenant_id = ? and us.tenant_id = app_config.tenant_id and US.USER_ANCHOR_ID = app_config.USER_ANCHOR_ID inner join PUBLIC.USER_ROLES as USER_ROLE on USER_ROLE.is_deleted = false and user_role.tenant_id = us.tenant_id and US.USER_ANCHOR_ID = USER_ROLE.USER_ANCHOR_ID inner join PUBLIC.ROLES as role on role.is_deleted = false and USER_ROLE.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE' and value = '{}' inner join USER_PRIVATE UP on UP.is_deleted = false and up.user_anchor_id = us.user_anchor_id and UP.tenant_id = US.tenant_id and UP.active = true union select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.is_deleted = false and ur.is_deleted = false and up.active = true and up.tenant_id = ? and up.tenant_id = ur.tenant_id and up.user_anchor_id = ur.user_anchor_id inner join PUBLIC.ROLES as role on role.is_deleted = false and UR.ROLE_ID = ROLE.ID and ROLE_name in ('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and up.user_anchor_id not in ( select USER_ANCHOR_ID from app_config where (is_deleted = false or is_deleted is null) and tenant_id = ? and category = 'CUSTOM_ATTRIBUTE_SETTING' and module = 'USER_PREFERENCE'));
2023-11-16 09:00:12.906 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:916]: Done Calculating user with no pref size 5 for customer 485929
2023-11-16 09:00:12.906 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[168262, 168256, 88018, 236029, 166301]> [insertEventUserForCustomers:1503]: inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}485929
2023-11-16 09:00:12.918 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : <[168262, 168256, 88018, 236029, 166301]> [insertEventUserForCustomers:1524]: Done inserting records into 'event_user' -- for tenantId {} --  userWithoutPref {}485929
2023-11-16 09:00:12.918 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserForCustomers:1528]: Time taken : 11ms : for query : with NEW_VALUES as( select distinct es.tenant_id as TENANT_ID, es.id as event_id, ? as created_by_id, ? as last_modified_by_id, ?::bigint[] as user_anchor_id from event_shareable es where es.tenant_id = ? and es.event_details_id = ?) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, event_notification_status) select EVENT_ID, unnest(USER_ANCHOR_ID), CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, ? from NEW_VALUES on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = '{}'::bigint[], affected_categories = '{}'::bigint[], event_notification_status = ?;
2023-11-16 09:00:12.918 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:942]: Creating user setting with prefernce 485929 99446 user with No pref [168262, 168256, 88018, 236029, 166301]
2023-11-16 09:00:12.920 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:959]: Time taken : 1ms : for query : select distinct up.user_anchor_id from user_private up inner join user_roles ur on up.tenant_id = ?::BIGINT and ur.tenant_id = up.tenant_id and ur.is_deleted = false and up.is_deleted = false and up.user_anchor_id = ur.user_anchor_id and up.active = true %s inner join roles r on r.is_deleted = false and r.role_name in('EVENT_LEAD', 'COMMODITY_MANAGER', 'EXECUTIVE') and r.id = ur.role_id;
2023-11-16 09:00:12.920 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:964]: user with pref details 485929 99446 [166244, 168257, 168258, 168259, 168260, 168261, 168263, 168264]
2023-11-16 09:00:12.920 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1125]: Calculate user setting data on basis of Event-Type  485929 99446 
2023-11-16 09:00:12.920 DEBUG 1 --- [     Thread-425] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1233]: Calculate user setting data on basis of UDA Setting 485929 99446 [166244, 168257, 168258, 168259, 168260, 168261, 168263, 168264]
2023-11-16 09:00:12.922 DEBUG 1 --- [     Thread-425] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1256]: Done Calculate user setting data on basis of UDA Setting 485929 99446 [166244, 168257, 168258, 168259, 168260, 168261, 168263, 168264]
2023-11-16 09:00:12.922 DEBUG 1 --- [     Thread-425] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithUDA:1259]: Time taken : 1ms : for query : with affected_uda_user as(select distinct app.user_anchor_id, app.tenant_id,(select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false) as event_id from app_config app where app.is_deleted = false and app.tenant_id = ? and app.user_anchor_id = any(?::BIGINT[]) and category = 'CUSTOM_ATTRIBUTE_SETTING') select DISTINCT user_anchor_id, coalesce(filter_by_custom_attribute(tenant_id, user_anchor_id, event_id, (select array_agg(site_private_id) from event_site where event_id = affected_uda_user.event_id and is_deleted= false)), '{}') as affectedSites from affected_uda_user;
2023-11-16 09:00:12.922 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1149]: Done Calculate user setting data on basis of Event-Type  485929 99446 
2023-11-16 09:00:12.922 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithEventType:1152]: Time taken : 2ms : for query : with user_details as( select unnest(?::BIGINT[]) as id, false as is_deleted, ? ::BIGINT as tenant_id) , app_config_details as( select distinct ud.id as user_anchor_id, ud.tenant_id from user_details ud left join app_config app on app.tenant_id = ? and app.is_deleted = false and app.user_anchor_id = ud.id and CATEGORY = 'WARROOM_USER_SETTING' where case when app.value ->> 'eventTypes'::text is null then true when app.value ->> 'eventTypes'::text = '[]'::text then true when app.VALUE @> '{"eventTypes": ["%s"]}' then true else false end) , site_details as( select es.tenant_id, ess.event_id, ARRAY_AGG(distinct ess.site_private_id) as event_sites from event_details ed inner join event_shareable es on ed.is_deleted = false and es.is_deleted = false and ed.id = ? and es.event_details_id = ed.id and es.tenant_id = ? inner join event_site ess on ess.is_deleted = false and ess.tenant_id = es.tenant_id and ess.event_id = es.id inner join site_summary ss on ss.is_deleted = false and ss.tenant_id = ess.tenant_id and ss.site_private_id = ess.site_private_id group by 1, 2 ) select distinct app_config_details.user_anchor_id, event_sites as affectedSites from site_details inner join app_config_details on app_config_details.tenant_id = site_details.tenant_id;	
2023-11-16 09:00:12.922 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1174]: Calculate user setting data on basis of Country Setting 485929 99446 [168258, 168259, 168257, 168263, 166244, 168260, 168261, 168264]
2023-11-16 09:00:12.924 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1203]: Done Calculate user setting data on basis of Country Setting 485929 99446 [168258, 168259, 168257, 168263, 166244, 168260, 168261, 168264]
2023-11-16 09:00:12.924 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCountry:1206]: Time taken : 1ms : for query : with affected_country_users as(select replace(replace(coalesce((value -> 'countries')::text, '[]'::text), '[', '{'), ']', '}')::int[] as country_id, user_anchor_id, tenant_id, is_deleted from app_config where (is_deleted = false or is_deleted is null) and app_config.tenant_id = ? and category = 'COUNTRY_SETTING' and app_config.user_anchor_id = any(?::bigint[]) and module = 'USER_PREFERENCE' and coalesce((value ->> 'countries'),'[]'::text) != '[]'), site_user as (select array_agg(distinct ss.site_private_id) as affectedSites, user_anchor_id from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join affected_country_users on ss.country_code_id = any(country_id) group by 2) select affected_country_users.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_country_users left join site_user on affected_country_users.user_anchor_id = site_user.user_anchor_id
2023-11-16 09:00:12.924 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1361]: Calculate user setting data on basis of Partner Setting 485929 99446 [168258, 168259, 168257, 168263, 166244, 168260, 168261, 168264]
2023-11-16 09:00:12.929 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 485929 99446 [168258, 168257, 166244, 168261, 168264]
2023-11-16 09:00:12.929 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 4ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:12.929 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 485929 99446 [168258, 168257, 166244, 168261, 168264]
2023-11-16 09:00:12.929 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 485929 99446 [168258, 168257, 166244, 168261, 168264]
2023-11-16 09:00:12.929 DEBUG 1 --- [     Thread-424] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 0ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:12.929 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 485929 and eventId 99446 and userIds [168258, 168257, 166244, 168261, 168264]
2023-11-16 09:00:12.929 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 485929 and eventId : 99446 
2023-11-16 09:00:12.930 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:12.935 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 5
2023-11-16 09:00:12.935 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 5ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:12.935 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 485929 99446
2023-11-16 09:00:12.935 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 485929
2023-11-16 09:00:12.935  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 485929
2023-11-16 09:00:12.935 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:12.936 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [485929] 
2023-11-16 09:00:12.938 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:12.938 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:12.938  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 485929, isUpdateAlert : true
2023-11-16 09:00:12.939  INFO 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:12.939 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:12.939  INFO 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:12.940 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"2e06e732-f926-47dd-942e-0e8cd0d171a5","eventId":19868357,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:12.942  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868357, tenantId : 485929
2023-11-16 09:00:12.942 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"2e06e732-f926-47dd-942e-0e8cd0d171a5","eventId":19868357,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41807
2023-11-16 09:00:12.942  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:12.942  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [832227, 6236] 
2023-11-16 09:00:12.942 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:12.992 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [50, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (832227,6236)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:12.993 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 51ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:13.081 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:13.116 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [35, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (832227,6236)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:13.116 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 35ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:13.120 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_485929
2023-11-16 09:00:13.120 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 3ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_485929
2023-11-16 09:00:13.124 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_485929
2023-11-16 09:00:13.124 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_485929
2023-11-16 09:00:13.128 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 4ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:13.243 DEBUG 1 --- [6_103335_433508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 433508
2023-11-16 09:00:13.244  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 433508
2023-11-16 09:00:13.244  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:13.245 DEBUG 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[293,156914,237,5798,1099,150727,2177,131459,160425,192034,592,7837,5755,1388,1449,1404,111,198844,292,2956,22682,148401,1375,167672,90,150001,311,152724,37128,12844,273,2833],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:13.245  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [293, 156914, 237, 5798, 1099, 150727, 2177, 131459, 160425, 192034, 592, 7837, 5755, 1388, 1449, 1404, 111, 198844, 292, 2956, 22682, 148401, 1375, 167672, 90, 150001, 311, 152724, 37128, 12844, 273, 2833]
2023-11-16 09:00:13.245  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:13.246  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:13.245 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[293,156914,237,5798,1099,150727,2177,131459,160425,192034,592,7837,5755,1388,1449,1404,111,198844,292,2956,22682,148401,1375,167672,90,150001,311,152724,37128,12844,273,2833],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22859
2023-11-16 09:00:13.246  INFO 1 --- [6_103335_433508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 433508, Took : 7s
2023-11-16 09:00:13.264  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 485929
2023-11-16 09:00:13.264 DEBUG 1 --- [6_103335_485929] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:13.299 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [34, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (832227,6236) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:13.303 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_485929
2023-11-16 09:00:13.303 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:671]: Time taken : 39ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:13.306 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 2ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:13.512 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 92ms : for accumulator : {}
2023-11-16 09:00:13.512 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 485929
2023-11-16 09:00:13.545 DEBUG 1 --- [6_103335_485929] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 485929
2023-11-16 09:00:13.546  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 485929
2023-11-16 09:00:13.546  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:13.546 DEBUG 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[6236],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:13.547  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [6236]
2023-11-16 09:00:13.547  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:13.547  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:13.547 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[6236],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22860
2023-11-16 09:00:13.547  INFO 1 --- [6_103335_485929] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 485929, Took : 3s
2023-11-16 09:00:17.932 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1390]: Done Calculate user setting data on basis of Partner Setting 548976 99446 [249035, 178894, 177947, 177892, 173482, 173480, 235305, 172592]
2023-11-16 09:00:17.933 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithPartner:1393]: Time taken : 6842ms : for query : with affected_partner_user as(select distinct user_anchor_id from user_tenant_access uta where is_deleted= false and tenant_id= ? and tenant_id != allowed_tenant_id and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, UTA.USER_ANCHOR_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join company_summary cs on cs.is_deleted = false and cs.tenant_id = ss.tenant_id and cs.id = ss.company_summary_id inner join user_tenant_access uta on uta.is_deleted = false and uta.tenant_id = cs.tenant_id and uta.user_anchor_id in (select affected_partner_user.user_anchor_id from affected_partner_user) and uta.allowed_tenant_id = cs.owner_tenant_id GROUP BY UTA.USER_ANCHOR_ID) select affected_partner_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites from affected_partner_user left join site_user on affected_partner_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:17.933 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1288]: Calculate user setting data on basis of Category Setting 548976 99446 [249035, 178894, 177947, 177892, 173482, 173480, 235305, 172592]
2023-11-16 09:00:17.934 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1325]: Done Calculate user setting data on basis of Category Setting 548976 99446 [178894, 177892, 173482, 173480, 235305, 172592]
2023-11-16 09:00:17.934 DEBUG 1 --- [     Thread-418] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserDetailwithCateogry:1328]: Time taken : 1ms : for query : with affected_category_user as(select distinct user_anchor_id from user_part_category upc where is_deleted= false and tenant_id= ? and user_anchor_id = any(?::bigint[])) , site_user as (SELECT array_agg(DISTINCT ss.site_private_id) AS affectedsites, array_agg(distinct pcs.id) as totalcategories, upc.TENANT_ID, upc.USER_ANCHOR_ID, ES.EVENT_ID from event_details ed inner join event_shareable esh on ed.is_deleted = false and esh.is_deleted = false and ed.id = ? and ed.id = esh.event_details_id and esh.tenant_id = ? inner join event_site es on es.is_deleted = false and es.tenant_id = esh.tenant_id and es.event_id = esh.id inner join site_summary ss on ss.is_deleted = false and es.tenant_id = ss.tenant_id and es.site_private_id = ss.site_private_id inner join part_category_shareable pcs on pcs.is_deleted = false and pcs.tenant_id = ss.tenant_id and pcs.id = any(ss.total_categories) inner join user_part_category upc on upc.is_deleted = false and upc.tenant_id = pcs.tenant_id and pcs.id =upc.part_category_id and upc.user_anchor_id in (select affected_category_user.user_anchor_id from affected_category_user) GROUP BY 3,4,5) select affected_category_user.user_anchor_id, coalesce(site_user.affectedSites, '{}'::bigint[]) as affectedsites, coalesce(site_user.totalcategories, '{}'::bigint[]) as affectedCategories, tenant_id, event_id from affected_category_user left join site_user on affected_category_user.user_anchor_id = site_user.user_anchor_id;
2023-11-16 09:00:17.934 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:995]: Done calculating user final list : user found with pref for this tenant Id 548976 and eventId 99446 and userIds [178894, 177892, 173482, 173480, 235305, 172592]
2023-11-16 09:00:17.935 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1000]: Time taken : 0ms : for calculating user final list : tenant Id : 548976 and eventId : 99446 
2023-11-16 09:00:17.935 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1062]: Inserting event_user with pref
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1098]: Done Inserting event_user with pref 6
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertEventUserPrefWithCustomer:1100]: Time taken : 10ms : for query : with event_detail_data as( select id from event_shareable es where event_details_id = ? and tenant_id = ? and is_deleted = false) insert into EVENT_USER(EVENT_ID, USER_ANCHOR_ID, CREATED_BY_ID, LAST_MODIFIED_BY_ID, TENANT_ID, affected_sites, affected_categories, event_notification_status) values(( select id from event_detail_data), ?, ?, ?, ?, ?::bigint[], ?::bigint[], ?) on conflict(TENANT_ID, EVENT_ID, USER_ANCHOR_ID) do update set affected_sites = ?::bigint[], affected_categories = ?::bigint[], event_notification_status = ?;
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [calculateUserWithPref:1018]: Done user setting with prefernce 548976 99446
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForCustomer:922]: Done Creating a data Set for event_users for this event_id 99446 and tenant_id 548976
2023-11-16 09:00:17.945  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendNotifications:476]: Done replicating event_user for customer with tenant_id : 548976
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 5, metaData : null
2023-11-16 09:00:17.945 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [548976] 
2023-11-16 09:00:17.949 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:00:17.949 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:00:17.949  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1914]: Sending Customer Impact Notification for tenantId : 548976, isUpdateAlert : true
2023-11-16 09:00:17.949  INFO 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:17.950 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [getUniquieIds:305] : Time taken(ms) for query: [0, SELECT UNIQUE_ID,E.ID FROM TENANT JOIN EVENT_SHAREABLE as E ON TENANT.id=E.tenant_id and e.event_details_id=? AND tenant.ID IN (%s) WHERE (TENANT.is_deleted = false OR TENANT.is_deleted IS NULL) AND (E.is_deleted = false OR E.is_deleted IS NULL)] 
2023-11-16 09:00:17.950  INFO 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logInfo:21] : Done fetching Unique tenant Ids for eventId - [99446]
2023-11-16 09:00:17.951 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendCustomerImpactNotification:1929]: CIN KafkaObject : {"uniqueId":"ca512e5f-2ca4-4a8c-bf11-7d63954e6004","eventId":19868358,"emailType":"customerImpactNotification","isUpdate":true}
2023-11-16 09:00:17.952  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendCustomerImpactNotification:1936]: Done Sending Customer Impact Notification for eventId : 19868358, tenantId : 548976
2023-11-16 09:00:17.953  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:497]: Starting sentSupplierImapct() with details : CollectionUtils.isNotEmpty(eventDetail.getAffectedPartners()): true, MapUtils.isNotEmpty(replicationService.getEventPartnerCustomerMap()) : true 
2023-11-16 09:00:17.952 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"uniqueId":"ca512e5f-2ca4-4a8c-bf11-7d63954e6004","eventId":19868358,"emailType":"customerImpactNotification","isUpdate":true}' partition 0 with offset=41808
2023-11-16 09:00:17.953  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:514]: supplierIdToSentImpact: [142062, 535085, 8089, 33399, 559589, 559971, 559150, 440213, 568216, 567907, 568399, 567890, 261215, 208107, 698, 46268, 482548, 564687, 559047, 136135, 559771, 560010, 559657, 559136, 33124, 568096, 564626, 565265, 228807, 124499, 568404, 565027, 559742, 269, 35622, 256247, 39042, 1108833, 1063207, 32542, 10337, 1108649, 1108665, 277453] 
2023-11-16 09:00:17.953 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:17.989 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [36, select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = 99446 and tenant_id in (142062,535085,8089,33399,559589,559971,559150,440213,568216,567907,568399,567890,261215,208107,698,46268,482548,564687,559047,136135,559771,560010,559657,559136,33124,568096,564626,565265,228807,124499,568404,565027,559742,269,35622,256247,39042,1108833,1063207,32542,10337,1108649,1108665,277453)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp] 
2023-11-16 09:00:17.989 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:550]: Time taken : 36ms : for query : select distinct on(event_id) tmp.tenant_id as TENANTID, event_id as EVENTID, max as downTime, 'weeks' as downTimeUnit, impact_status as impactStatus from ( select tenant_id, event_id, max(GET_DOWN_TIME_IN_WEEKS(down_time, down_time_unit, false)), impact_status, case when impact_status = 'Confirmed' then 3 when impact_status = 'Potential' then 2 when impact_status = 'No Impact' then 1 end as status_order from event_site where event_id in ( select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and is_deleted = false group by 1, 2, 4, 5 order by 5 desc) tmp
2023-11-16 09:00:18.057 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:18.086 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [29, select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = 99446 and tenant_id in (142062,535085,8089,33399,559589,559971,559150,440213,568216,567907,568399,567890,261215,208107,698,46268,482548,564687,559047,136135,559771,560010,559657,559136,33124,568096,564626,565265,228807,124499,568404,565027,559742,269,35622,256247,39042,1108833,1063207,32542,10337,1108649,1108665,277453)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3] 
2023-11-16 09:00:18.087 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:562]: Time taken : 30ms : for query : select tmp.tenant_id as TENANTID, tmp.id as companyPrivateId, tmp.userId as userId, array_agg(distinct affected_customer) as affectedCompaniesId from(select distinct cp.tenant_id, cp.id, unnest(affected_companies_id) affected_customer, 1::bigint as userId from event_site es inner join company_private cp on es.is_deleted = false and cp.is_deleted = false and es.event_id in (select id from event_shareable where event_details_id = %s and tenant_id in (%s)) and cp.tenant_id = es.tenant_id and cp.owner_tenant_id = cp.tenant_id) tmp group by 1,2,3
2023-11-16 09:00:18.091 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EXISITING_EVENT_SITE_FOR_PARTNER_99446_548976
2023-11-16 09:00:18.092 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:572]: Time taken : 4ms : for Sparkview : EXISITING_EVENT_SITE_FOR_PARTNER_99446_548976
2023-11-16 09:00:18.096 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : AFFECTED_CUSTOMERS_EVENT_SITE_99446_548976
2023-11-16 09:00:18.096 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:582]: Time taken : 4ms : for Saprkview : AFFECTED_CUSTOMERS_EVENT_SITE_99446_548976
2023-11-16 09:00:18.103 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventCompanyForPartner:593]: Time taken : 6ms : for query : SELECT distinct v1.TENANTID as tenantId, v1.EVENTID as eventId, v1.downTime as downTime, v1.impactStatus as impactStatus,companyPrivateId as companyId, companyPrivateId as eventCompanyId, v1.tenantId as sourceId, affectedCompaniesId as sharedCustomers, V2.userId as userId, 'Pending' as impactNotificationStatus, 'weeks' as downTimeUpdate  FROM EXISITING_EVENT_SITE_FOR_PARTNER_%s_%s AS V1 INNER JOIN AFFECTED_CUSTOMERS_EVENT_SITE_%s_%s AS V2 ON V1.TENANTID = V2.TENANTID
2023-11-16 09:00:18.317  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:518]: Done replicating event_company for partner with tenant_id : 548976
2023-11-16 09:00:18.317 DEBUG 1 --- [6_103335_548976] c.r.s.streaming.helper.LoggingHelper     [logDebug:53] : Executing Query from queryDataset2
2023-11-16 09:00:18.351 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ReplicationHelper         [queryDataset:121] : Time taken(ms) for query: [33, select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, 157408::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =99446 and E.tenant_id in (142062,535085,8089,33399,559589,559971,559150,440213,568216,567907,568399,567890,261215,208107,698,46268,482548,564687,559047,136135,559771,560010,559657,559136,33124,568096,564626,565265,228807,124499,568404,565027,559742,269,35622,256247,39042,1108833,1063207,32542,10337,1108649,1108665,277453) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID] 
2023-11-16 09:00:18.355 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.ApplicationHelper         [logDebug:407] : EVENT_USER_FOR_PARTNER_99446_548976
2023-11-16 09:00:18.356 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [?:?] : [createEventUserForPartner:671]: Time taken : 38ms : for query : select distinct on(US.USER_ANCHOR_ID,ec.tenant_id) US.USER_ANCHOR_ID as USERID, ec.tenant_id as tenant_id, ec.event_id as event_id, %s::bigint as id from EVENT_SHAREABLE as E inner join USER_SHAREABLE as US on E.is_deleted = false and US.is_deleted = false and E.TENANT_ID = US.TENANT_ID and E.event_details_id =%s and E.tenant_id in (%s) and US.TENANT_ID = US.OWNER_TENANT_ID and US.BEST_ORIGINAL_ROW = true inner join USER_ROLES as UR on UR.is_deleted = false and UR.TENANT_ID = US.TENANT_ID and UR.USER_ANCHOR_ID = US.USER_ANCHOR_ID and US.USER_ANCHOR_ID is not null inner join ROLES on ROLES.is_deleted = false and UR.ROLE_ID = ROLES.ID and ROLES.ROLE_NAME in ('CRISIS_MANAGER') inner join EVENT_COMPANY as EC on EC.is_deleted = false and E.ID = EC.EVENT_ID inner join COMPANY_BY_PATH as CBP on CBP.is_deleted = false and CBP.COMPANY_PRIVATE_ID = EC.company_private_id and CBP.RELATIONSHIP_TYPE = 'self' order by US.USER_ANCHOR_ID
2023-11-16 09:00:18.359 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:680]: Time taken : 3ms : for query : select distinct tenant_id as tenantId, tenant_id as sourceId, event_id as eventId, USERID as userId, id as id from EVENT_USER_FOR_PARTNER_%s_%s
2023-11-16 09:00:18.590 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createEventUserForPartner:697]: Time taken : 87ms : for accumulator : {}
2023-11-16 09:00:18.590 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1764]: Writing records into 'event_user' -- for Customer tenant_id -- 548976
2023-11-16 09:00:18.677 DEBUG 1 --- [6_103335_548976] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventUserForPartner:1769]: Done Writing records into 'event_user' -- for Customer tenant_id -- 548976
2023-11-16 09:00:18.678  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sentSupplierImapct:524]: Done replicating event_user for partner with tenant_id : 548976
2023-11-16 09:00:18.678  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:624]: Sending Supplier Impact Notification for event_id : 99446 and writeupId : 103335
2023-11-16 09:00:18.678 DEBUG 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [sendPartnerImpact:631]: SIN KafkaObject : {"eventId":99446,"affectedPartners":[32542,142062,8089,10337,33399,46268,269,35622,33124,698,39042],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}
2023-11-16 09:00:18.679  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [sendPartnerImpact:635]: Done Sending Supplier Impact Notification for event_id : 99446 with no. of Supplier(s) [32542, 142062, 8089, 10337, 33399, 46268, 269, 35622, 33124, 698, 39042]
2023-11-16 09:00:18.679  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:00:18.679  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:00:18.679 DEBUG 1 --- [ad | producer-1] c.r.s.s.configuration.KafkaHelper        [handleLogs:286] : [onSuccess:132]: Sent message='{"eventId":99446,"affectedPartners":[32542,142062,8089,10337,33399,46268,269,35622,33124,698,39042],"emailType":"supplierImpactNotification","writeupId":103335,"isUpdate":true}' partition 0 with offset=22861
2023-11-16 09:00:18.679  INFO 1 --- [6_103335_548976] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 548976, Took : 12s
2023-11-16 09:00:18.680  INFO 1 --- [    event_99446] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [eventReplicationProcess:221]: final sizes of Map -> Customer & Partner {99446={}} and Re-triggering 0
2023-11-16 09:00:18.680 DEBUG 1 --- [    event_99446] c.r.s.s.helper.ReTriggeringHelper        [handleLogs:286] : [updateStatusforRetriggering:62]: Collecting details to update status 
2023-11-16 09:00:18.680 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2155]: updateEventDetails -- input params :: eventDetailId : 5, status : null, metaData : 99446
2023-11-16 09:00:18.685 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2177]: updateEventDetails -- ended with result as : 1
2023-11-16 09:00:18.686 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2180]: Time taken : 5ms : for query : update event_details set status = ?, event_metadata = ?::jsonb where id = ?
2023-11-16 09:00:18.686 DEBUG 1 --- [    event_99446] c.r.s.s.helper.ReTriggeringHelper        [handleLogs:286] : [updateStatusforRetriggering:115]: Done -- Collecting details to update status
2023-11-16 09:00:18.686 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [closeSparkSession:94]: Clearing/Closing cached data of Spark Session : org.apache.spark.sql.SparkSession@183fb90d 
2023-11-16 09:00:18.686 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [closeSparkSession:108]: Removed sparkSession.stop()
2023-11-16 09:00:18.686 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [closeSparkSession:111]: Done Clearing/Closing cached data of Spark Session : org.apache.spark.sql.SparkSession@183fb90d 
2023-11-16 09:00:18.686  INFO 1 --- [    event_99446] c.r.s.s.l.EventReplicationKafkaListener  [replicationProcess:124] : Done Replicating Full Event Tables for event_details_id , Took : [99446, 195]s
2023-11-16 09:00:18.686  INFO 1 --- [    event_99446] c.r.s.s.l.EventReplicationKafkaListener  [listen:104] : Leaving EventReplicaton Kafka Listener -> listenMessages
2023-11-16 09:01:31.189  INFO 1 --- [nio-9200-exec-1] c.c.c.ConfigServicePropertySourceLocator [locate:80] : Fetching config from server at: http://infrastructureconfigserver.marathon.l4lb.thisdcos.directory:8240
2023-11-16 09:01:32.136  INFO 1 --- [nio-9200-exec-1] c.c.c.ConfigServicePropertySourceLocator [locate:94] : Located environment: name=event-replication, profiles=[dcos], label=configuration, version=16537, state=null
2023-11-16 09:06:48.177  INFO 1 --- [nio-9200-exec-3] c.c.c.ConfigServicePropertySourceLocator [locate:80] : Fetching config from server at: http://infrastructureconfigserver.marathon.l4lb.thisdcos.directory:8240
2023-11-16 09:06:49.127  INFO 1 --- [nio-9200-exec-3] c.c.c.ConfigServicePropertySourceLocator [locate:94] : Located environment: name=event-replication, profiles=[dcos], label=configuration, version=16537, state=null
2023-11-16 09:11:36.796  INFO 1 --- [ent_replication] c.r.s.s.l.EventReplicationKafkaListener  [listen:87] : Started EventReplicaton Kafka Listener -> listenMessages
2023-11-16 09:11:36.796  INFO 1 --- [ent_replication] o.a.k.clients.consumer.ConsumerConfig    [logAll:178] : ConsumerConfig values: 
	metric.reporters = []
	metadata.max.age.ms = 300000
	partition.assignment.strategy = [org.apache.kafka.clients.consumer.RangeAssignor]
	reconnect.backoff.ms = 50
	sasl.kerberos.ticket.renew.window.factor = 0.8
	max.partition.fetch.bytes = 26214400
	bootstrap.servers = [dc6:9092]
	ssl.keystore.type = JKS
	enable.auto.commit = false
	sasl.mechanism = GSSAPI
	interceptor.classes = null
	exclude.internal.topics = true
	ssl.truststore.password = null
	client.id = 
	ssl.endpoint.identification.algorithm = null
	max.poll.records = 1
	check.crcs = true
	request.timeout.ms = 40000
	heartbeat.interval.ms = 3000
	auto.commit.interval.ms = 5000
	receive.buffer.bytes = 65536
	ssl.truststore.type = JKS
	ssl.truststore.location = null
	ssl.keystore.password = null
	fetch.min.bytes = 1
	send.buffer.bytes = 131072
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	group.id = consumer-event-stream-offsets
	retry.backoff.ms = 100
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	ssl.trustmanager.algorithm = PKIX
	ssl.key.password = null
	fetch.max.wait.ms = 500
	sasl.kerberos.min.time.before.relogin = 60000
	connections.max.idle.ms = 540000
	session.timeout.ms = 30000
	metrics.num.samples = 2
	key.deserializer = class org.apache.kafka.common.serialization.IntegerDeserializer
	ssl.protocol = TLS
	ssl.provider = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.1, TLSv1]
	ssl.keystore.location = null
	ssl.cipher.suites = null
	security.protocol = PLAINTEXT
	ssl.keymanager.algorithm = SunX509
	metrics.sample.window.ms = 30000
	auto.offset.reset = earliest

2023-11-16 09:11:36.798  INFO 1 --- [ent_replication] o.a.k.clients.consumer.ConsumerConfig    [logAll:178] : ConsumerConfig values: 
	metric.reporters = []
	metadata.max.age.ms = 300000
	partition.assignment.strategy = [org.apache.kafka.clients.consumer.RangeAssignor]
	reconnect.backoff.ms = 50
	sasl.kerberos.ticket.renew.window.factor = 0.8
	max.partition.fetch.bytes = 26214400
	bootstrap.servers = [dc6:9092]
	ssl.keystore.type = JKS
	enable.auto.commit = false
	sasl.mechanism = GSSAPI
	interceptor.classes = null
	exclude.internal.topics = true
	ssl.truststore.password = null
	client.id = consumer-17
	ssl.endpoint.identification.algorithm = null
	max.poll.records = 1
	check.crcs = true
	request.timeout.ms = 40000
	heartbeat.interval.ms = 3000
	auto.commit.interval.ms = 5000
	receive.buffer.bytes = 65536
	ssl.truststore.type = JKS
	ssl.truststore.location = null
	ssl.keystore.password = null
	fetch.min.bytes = 1
	send.buffer.bytes = 131072
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	group.id = consumer-event-stream-offsets
	retry.backoff.ms = 100
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	ssl.trustmanager.algorithm = PKIX
	ssl.key.password = null
	fetch.max.wait.ms = 500
	sasl.kerberos.min.time.before.relogin = 60000
	connections.max.idle.ms = 540000
	session.timeout.ms = 30000
	metrics.num.samples = 2
	key.deserializer = class org.apache.kafka.common.serialization.IntegerDeserializer
	ssl.protocol = TLS
	ssl.provider = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.1, TLSv1]
	ssl.keystore.location = null
	ssl.cipher.suites = null
	security.protocol = PLAINTEXT
	ssl.keymanager.algorithm = SunX509
	metrics.sample.window.ms = 30000
	auto.offset.reset = earliest

2023-11-16 09:11:36.799  INFO 1 --- [ent_replication] o.a.kafka.common.utils.AppInfoParser     [<init>:83] : Kafka version : 0.10.0.1
2023-11-16 09:11:36.799  INFO 1 --- [ent_replication] o.a.kafka.common.utils.AppInfoParser     [<init>:84] : Kafka commitId : a7a17cdec9eaa6c5
2023-11-16 09:11:36.902  INFO 1 --- [ent_replication] o.a.k.c.c.internals.AbstractCoordinator  [handleGroupMetadataResponse:505] : Discovered coordinator dc5:9092 (id: 2147483647 rack: null) for group consumer-event-stream-offsets.
2023-11-16 09:11:36.904 DEBUG 1 --- [ent_replication] c.r.s.s.l.EventReplicationKafkaListener  [listen:93] : kafka propertes as committedOffset, offsets, partitions, topic : [12754, 12754, 0, event_replication2]
2023-11-16 09:11:36.905 DEBUG 1 --- [ent_replication] c.r.s.s.l.EventReplicationKafkaListener  [listen:96] : Sending Manual Ack
2023-11-16 09:11:36.906  INFO 1 --- [    event_99446] c.r.s.s.l.EventReplicationKafkaListener  [replicationProcess:118] : Replicating Full Event Tables for event_details_id : [99446]
2023-11-16 09:11:36.906 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getEventShareableDetails:177]: fetch event_shareable details using event_details_id : 99446 and isRetrigger : false 
2023-11-16 09:11:36.907 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getEventShareableDetails:202]: query : select distinct case when coalesce(ewd.selected_sites::bigint[], '{}'::bigint[]) != '{}'::bigint[] then coalesce(ewd.selected_sites::bigint[], '{}'::bigint[]) else coalesce(ewd.affected_sites::bigint[], '{}'::bigint[]) end as affectedSites, ed.created_by_id as userId, coalesce(ed.is_whatif, false) as isWhatIf, ed.event_what_if_id as whatIfId, t.tenant_name as tenantName, sow.tenant_id as tenantId, sow.tenant_id as sourceId, ed.title as title, event_type as eventType, ed.affected_region as affectedRegion, ewd.selection_Type as selectionTypes, ewd.selected_companies @> array[sow.tenant_id] as selectedCustomer from event_details ed inner join event_writeup ewd on ewd.is_deleted = false and ewd.event_details_id = ed.id and ed.id = ? and ewd.id = ? and ed.status = ? inner join sow on ed.is_deleted = false inner join tenant t on t.is_deleted = false and sow.is_deleted = false and sow.tenant_id = any(ewd.affected_companies) and now() between sow.created_date and sow.end_date and t.id = sow.tenant_id 
2023-11-16 09:11:36.941 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getEventShareableDetails:246]: Done fetch event_shareable details using event_details_id -- 99446 -- resulted records -- 187
2023-11-16 09:11:36.941 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getEventShareableDetails:250]: Time taken : 35ms : for query : select distinct case when coalesce(ewd.selected_sites::bigint[], '{}'::bigint[]) != '{}'::bigint[] then coalesce(ewd.selected_sites::bigint[], '{}'::bigint[]) else coalesce(ewd.affected_sites::bigint[], '{}'::bigint[]) end as affectedSites, ed.created_by_id as userId, coalesce(ed.is_whatif, false) as isWhatIf, ed.event_what_if_id as whatIfId, t.tenant_name as tenantName, sow.tenant_id as tenantId, sow.tenant_id as sourceId, ed.title as title, event_type as eventType, ed.affected_region as affectedRegion, ewd.selection_Type as selectionTypes, ewd.selected_companies @> array[sow.tenant_id] as selectedCustomer from event_details ed inner join event_writeup ewd on ewd.is_deleted = false and ewd.event_details_id = ed.id and ed.id = ? and ewd.id = ? and ed.status = ? inner join sow on ed.is_deleted = false inner join tenant t on t.is_deleted = false and sow.is_deleted = false and sow.tenant_id = any(ewd.affected_companies) and now() between sow.created_date and sow.end_date and t.id = sow.tenant_id 
2023-11-16 09:11:36.941 DEBUG 1 --- [    event_99446] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [eventReplicationProcess:194]: Intial sizes of Map -> Customer & Partner 0 and Re-triggering 0
2023-11-16 09:11:36.942 DEBUG 1 --- [    event_99446] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [eventReplicationProcess:198]: retriggerData: com.resilinc.spark.streaming.model.RetriggerData@7d6ac8b9[sendPartnerImpactNotification=false,sendCustomerImpactNotification=false,isUpdate=true,severity=High,isAlert=true,isRetrigger=false,writeupId=103387]
2023-11-16 09:11:36.942 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2155]: updateEventDetails -- input params :: eventDetailId : 2, status : null, metaData : 99446
2023-11-16 09:11:36.944 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2177]: updateEventDetails -- ended with result as : 1
2023-11-16 09:11:36.944 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventDetails:2180]: Time taken : 2ms : for query : update event_details set status = ?, event_metadata = ?::jsonb where id = ?
2023-11-16 09:11:36.945 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 2, metaData : null
2023-11-16 09:11:36.945 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [780001, 158273, 254683, 158370, 833721, 158129, 1101553, 1245064, 158226, 130878, 200591, 428297, 956478, 231626, 1166738, 180926, 819395, 1046344, 952231, 246030, 991643, 825380, 1039623, 19, 22, 979716, 158346, 158311, 159421, 158845, 158115, 1188301, 184508, 158377, 158117, 958345, 127468, 1122802, 158375, 6, 1186930, 158126, 1145812, 1086179, 779992, 451204, 465416, 1183236, 158131, 1183235, 158376, 1145809, 451834, 825365, 201460, 1188796, 158225, 444163, 1202335, 1031842, 160447, 158844, 449937, 1080765, 495639, 545593, 158847, 160438, 480895, 958346, 18, 396909, 37, 992178, 143322, 158272, 1043337, 814173, 158372, 158373, 589448, 832493, 1163388, 477106, 496142, 960462, 158269, 129675, 158116, 249321, 1002099, 825379, 584930, 158374, 396369, 396313, 480648, 450379, 158003, 158130, 1101797, 1002243, 25, 1145810, 570814, 158310, 1248949, 430946, 796742, 614709, 1108003, 1145808, 1033976, 807936, 812762, 158313, 248121, 28, 975428, 143291, 1126057, 1145811, 1145820, 964962, 396917, 1179652, 1038173, 130009, 1037376, 1221314, 1076844, 495643, 158312, 1007397, 988061, 815176, 480856, 1003059, 1053500, 1145806, 957039, 952338, 201461, 832990, 240830, 3, 158308, 1160168, 565620, 158843, 158371, 32, 397511, 158224, 545592, 1100997, 248170, 1145805, 1210151, 176350, 200401, 16, 1106153, 31, 158309, 779990, 475791, 158270, 1239562, 130478, 940989, 158314, 129783, 200919, 832215, 480334, 173042, 433508, 548976, 485929, 1191400, 1286506, 1286542, 1287258, 1287256, 1287266, 1287287] 
2023-11-16 09:11:36.977 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 187
2023-11-16 09:11:36.977 DEBUG 1 --- [    event_99446] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 32ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.977 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [createSparkSession:76]: Instantiate Spark Session with spark Config : spark.app.name=Event-Replication
spark.cores.max=8
spark.driver.memory=6g
spark.dynamicAllocation.enabled=true
spark.dynamicAllocation.initialExecutors=3
spark.dynamicAllocation.maxExecutors=4
spark.dynamicAllocation.minExecutors=1
spark.executor.cores=2
spark.executor.instances=1
spark.executor.memory=6g
spark.master=spark://dc36:7077
spark.num.paritions=10
spark.scheduler.mode=FAIR
spark.shuffle.service.enabled=true 
2023-11-16 09:11:36.978 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [createSparkSession:79]: Adding Jars to Spark Cluster  
2023-11-16 09:11:36.978 DEBUG 1 --- [    event_99446] c.r.s.streaming.resource.SparkHelper     [handleLogs:286] : [createSparkSession:83]: resulted sparkSession : org.apache.spark.sql.SparkSession@3fa53fa1
2023-11-16 09:11:36.978 DEBUG 1 --- [    event_99446] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [createParallelStreamOfCustomers:279]: Replicating tables for all Customers with batch size : 5 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 780001 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158273 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.978 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 780001, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.978 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158273, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158370 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 833721 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 254683 
2023-11-16 09:11:36.978 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.978 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.978 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158273
2023-11-16 09:11:36.978  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 833721, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158370, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 780001
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 254683, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 833721
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158370
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.979 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 254683
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868179
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868183
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868180
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868184
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868186
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 1ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.980 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:36.981 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:36.982 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:36.982 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:36.984 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 780001 -- Resulted rows -- [1]
2023-11-16 09:11:36.984 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:36.984 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 780001 : null : null : 19868184 : Update published
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158273 -- Resulted rows -- [1]
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 833721 -- Resulted rows -- [1]
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158370 -- Resulted rows -- [1]
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158273 : null : null : 19868180 : Update published
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 833721 : null : null : 19868183 : Update published
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158370 : null : null : 19868179 : Update published
2023-11-16 09:11:36.985 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 254683 -- Resulted rows -- [1]
2023-11-16 09:11:36.986 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:36.986 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 254683 : null : null : 19868186 : Update published
2023-11-16 09:11:36.989 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 780001
2023-11-16 09:11:36.989 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:36.989 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 780001
2023-11-16 09:11:36.989  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 780001
2023-11-16 09:11:36.989  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 780001 
2023-11-16 09:11:36.989 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:36.989 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [780001] 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 833721
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 254683
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 833721
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158370
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158273
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 833721
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 254683
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 833721 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 5ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 254683
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158273
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158370
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 254683 
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158273
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [833721] 
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158370
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158273 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [254683] 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:36.991  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158370 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158273] 
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:36.991 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158370] 
2023-11-16 09:11:36.992 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:36.993 DEBUG 1 --- [6_103387_780001] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.993 DEBUG 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 780001 
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_833721] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 833721 
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_254683] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.994 DEBUG 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 254683 
2023-11-16 09:11:36.994  INFO 1 --- [6_103387_780001] o.s.jetty.server.handler.ContextHandler  [doStart:921] : Started o.s.j.s.ServletContextHandler@5d696caf{/SQL,null,AVAILABLE,@Spark}
2023-11-16 09:11:36.995  INFO 1 --- [6_103387_780001] o.s.jetty.server.handler.ContextHandler  [doStart:921] : Started o.s.j.s.ServletContextHandler@4c9c5006{/SQL/json,null,AVAILABLE,@Spark}
2023-11-16 09:11:36.995  INFO 1 --- [6_103387_780001] o.s.jetty.server.handler.ContextHandler  [doStart:921] : Started o.s.j.s.ServletContextHandler@79fe0e47{/SQL/execution,null,AVAILABLE,@Spark}
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158273] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 4ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158370] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 4ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158273 
2023-11-16 09:11:36.995 DEBUG 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158370 
2023-11-16 09:11:36.996  INFO 1 --- [6_103387_780001] o.s.jetty.server.handler.ContextHandler  [doStart:921] : Started o.s.j.s.ServletContextHandler@74055600{/SQL/execution/json,null,AVAILABLE,@Spark}
2023-11-16 09:11:36.996  INFO 1 --- [6_103387_780001] o.s.jetty.server.handler.ContextHandler  [doStart:921] : Started o.s.j.s.ServletContextHandler@290f98fd{/static/sql,null,AVAILABLE,@Spark}
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 254683 
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 780001 
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158370 
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158273 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 833721 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158370] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158370, Took : 0s
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_254683] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 254683, Took : 0s
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_780001] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 780001, Took : 0s
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158129 
2023-11-16 09:11:36.998  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1245064 
2023-11-16 09:11:36.998  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1101553 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158273] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158273, Took : 0s
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:36.998  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.998 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158129, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_833721] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 833721, Took : 0s
2023-11-16 09:11:36.998 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1245064, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.999  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 130878 
2023-11-16 09:11:36.999  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158129
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 130878, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.998 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1101553, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.998  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158226 
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.999  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 130878
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1245064
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158226, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1101553
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158226
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868185
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868188
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868181
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:36.999 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868187
2023-11-16 09:11:36.999 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868182
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.000 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.001 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.001 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.003 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 130878 -- Resulted rows -- [1]
2023-11-16 09:11:37.003 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.003 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 130878 : null : null : 19868188 : Update published
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158226 -- Resulted rows -- [1]
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158226 : null : null : 19868187 : Update published
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1101553 -- Resulted rows -- [1]
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158129 -- Resulted rows -- [1]
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1101553 : null : null : 19868181 : Update published
2023-11-16 09:11:37.005 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158129 : null : null : 19868185 : Update published
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1245064 -- Resulted rows -- [1]
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.005 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1245064 : null : null : 19868182 : Update published
2023-11-16 09:11:37.006 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 130878
2023-11-16 09:11:37.006 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.006 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 130878
2023-11-16 09:11:37.006  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 130878
2023-11-16 09:11:37.006  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 130878 
2023-11-16 09:11:37.006 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.006 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [130878] 
2023-11-16 09:11:37.008 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158226
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1101553
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.008 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1245064
2023-11-16 09:11:37.008 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158226
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1101553
2023-11-16 09:11:37.008  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158226
2023-11-16 09:11:37.008  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1101553
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.008  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158226 
2023-11-16 09:11:37.008  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1101553 
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1245064
2023-11-16 09:11:37.008 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.008 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158226] 
2023-11-16 09:11:37.008  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1245064
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1101553] 
2023-11-16 09:11:37.008  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1245064 
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.008 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1245064] 
2023-11-16 09:11:37.009 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.009 DEBUG 1 --- [6_103387_130878] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 130878 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158129
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 130878 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 4ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158129
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158129
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_130878] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 130878, Took : 0s
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158129 
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 200591 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.010  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 200591, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158129] 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.010 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 200591
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868189
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_158226] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158226 
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1101553] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1101553 
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158226 
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1245064] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1245064 
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1101553 
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.011 DEBUG 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1245064 
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_158226] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158226, Took : 0s
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 428297 
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1101553] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1101553, Took : 0s
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 956478 
2023-11-16 09:11:37.011 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 428297, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.011  INFO 1 --- [_103387_1245064] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1245064, Took : 0s
2023-11-16 09:11:37.011  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.012  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 231626 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 956478, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.012  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 428297
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 231626, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 956478
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 231626
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868190
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868191
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.012 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868192
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_158129] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158129 
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158129 
2023-11-16 09:11:37.013  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.013  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.013  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.013  INFO 1 --- [6_103387_158129] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158129, Took : 0s
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.013  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1166738 
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.013  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.013 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1166738, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.013 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.013 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1166738
2023-11-16 09:11:37.013 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.014 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.014 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.014 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19867810
2023-11-16 09:11:37.014 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.014 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.014 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.015 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.015 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 200591 -- Resulted rows -- [1]
2023-11-16 09:11:37.015 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.015 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 200591 : null : null : 19868189 : Update published
2023-11-16 09:11:37.015 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.016 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 428297 -- Resulted rows -- [1]
2023-11-16 09:11:37.016 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.016 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 231626 -- Resulted rows -- [1]
2023-11-16 09:11:37.016 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 428297 : null : null : 19868190 : Update published
2023-11-16 09:11:37.017 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.017 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 231626 : null : null : 19868192 : Update published
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 956478 -- Resulted rows -- [1]
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 200591
2023-11-16 09:11:37.018 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1166738 -- Resulted rows -- [1]
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 956478 : null : null : 19868191 : Update published
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 200591
2023-11-16 09:11:37.018 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.018  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 200591
2023-11-16 09:11:37.018 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1166738 : null : null : 19867810 : Update published
2023-11-16 09:11:37.018  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 200591 
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.018 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [200591] 
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 231626
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 428297
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 231626
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 428297
2023-11-16 09:11:37.019  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 231626
2023-11-16 09:11:37.019  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 428297
2023-11-16 09:11:37.019  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 231626 
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.019  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 428297 
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [231626] 
2023-11-16 09:11:37.019 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [428297] 
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.021 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1166738
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 956478
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_200591] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.021 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 200591 
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.021 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1166738
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 956478
2023-11-16 09:11:37.021  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1166738
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 956478
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 200591 
2023-11-16 09:11:37.021  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1166738 
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 956478 
2023-11-16 09:11:37.021 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.021 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1166738] 
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [956478] 
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_200591] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 200591, Took : 0s
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 180926 
2023-11-16 09:11:37.021  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 180926, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.021 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 180926
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868194
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_428297] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_231626] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 428297 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 231626 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:?] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 428297 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 231626 
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_231626] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 231626, Took : 0s
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_428297] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 428297, Took : 0s
2023-11-16 09:11:37.022  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1046344 
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 819395 
2023-11-16 09:11:37.022  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.022  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 819395, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.022 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1046344, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.022 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.022 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 819395
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1046344
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868195
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868196
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_956478] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1166738] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 956478 
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1166738 
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.023 DEBUG 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1166738 
2023-11-16 09:11:37.023 DEBUG 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 956478 
2023-11-16 09:11:37.023  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.024  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.024  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_956478] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 956478, Took : 0s
2023-11-16 09:11:37.024  INFO 1 --- [_103387_1166738] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1166738, Took : 0s
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 246030 
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 952231 
2023-11-16 09:11:37.024 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.024  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 246030, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 952231, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 246030
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 952231
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 1ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.024 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868198
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868197
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.024 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 180926 -- Resulted rows -- [1]
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 180926 : null : null : 19868194 : Update published
2023-11-16 09:11:37.025 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.027 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1046344 -- Resulted rows -- [1]
2023-11-16 09:11:37.027 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.027 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1046344 : null : null : 19868196 : Update published
2023-11-16 09:11:37.027 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 819395 -- Resulted rows -- [1]
2023-11-16 09:11:37.027 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.027 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 819395 : null : null : 19868195 : Update published
2023-11-16 09:11:37.028 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 180926
2023-11-16 09:11:37.028 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.028 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 180926
2023-11-16 09:11:37.028  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 180926
2023-11-16 09:11:37.028  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 180926 
2023-11-16 09:11:37.028 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.028 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [180926] 
2023-11-16 09:11:37.030 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 819395
2023-11-16 09:11:37.030 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.030 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1046344
2023-11-16 09:11:37.030 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 819395
2023-11-16 09:11:37.030  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 819395
2023-11-16 09:11:37.030 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.030  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 819395 
2023-11-16 09:11:37.030 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.030 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1046344
2023-11-16 09:11:37.030 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [819395] 
2023-11-16 09:11:37.030  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1046344
2023-11-16 09:11:37.030  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1046344 
2023-11-16 09:11:37.030 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.030 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1046344] 
2023-11-16 09:11:37.031 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.031 DEBUG 1 --- [6_103387_180926] c.r.s.s.helper.EventReplicationHelper    [?:?] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.031 DEBUG 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 180926 
2023-11-16 09:11:37.031 DEBUG 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 180926 
2023-11-16 09:11:37.031  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.031  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.031  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.031  INFO 1 --- [6_103387_180926] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 180926, Took : 0s
2023-11-16 09:11:37.032  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 991643 
2023-11-16 09:11:37.032  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 991643, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 991643
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868200
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.032 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.032 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 952231 -- Resulted rows -- [1]
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 246030 -- Resulted rows -- [1]
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1046344] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 7ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 7ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1046344 
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 952231 : null : null : 19868197 : Update published
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_819395] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 246030 : null : null : 19868198 : Update published
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 819395 
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1046344 
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 819395 
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1046344] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1046344, Took : 0s
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 825380 
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_819395] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 819395, Took : 0s
2023-11-16 09:11:37.033  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1039623 
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 825380, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.033  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1039623, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 825380
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.033 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1039623
2023-11-16 09:11:37.033 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.034 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868199
2023-11-16 09:11:37.034 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.034 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868201
2023-11-16 09:11:37.034 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.034 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.034 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.034 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.034 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.034 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.034 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.035 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.035 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.036 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 246030
2023-11-16 09:11:37.036 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.036 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 246030
2023-11-16 09:11:37.036  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 246030
2023-11-16 09:11:37.036  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 246030 
2023-11-16 09:11:37.036 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.036 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [246030] 
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 952231
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 4ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 991643 -- Resulted rows -- [1]
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 952231
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.037  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 952231
2023-11-16 09:11:37.037  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 952231 
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 991643 : null : null : 19868200 : Update published
2023-11-16 09:11:37.037 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.038 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [952231] 
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.039 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1039623 -- Resulted rows -- [1]
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_246030] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.039 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 246030 
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 825380 -- Resulted rows -- [1]
2023-11-16 09:11:37.039 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1039623 : null : null : 19868201 : Update published
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 246030 
2023-11-16 09:11:37.039 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 825380 : null : null : 19868199 : Update published
2023-11-16 09:11:37.039  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.039  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.039  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.039  INFO 1 --- [6_103387_246030] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 246030, Took : 0s
2023-11-16 09:11:37.039  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 19 
2023-11-16 09:11:37.039  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.039 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 19, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.039 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.039 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 19
2023-11-16 09:11:37.040 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868202
2023-11-16 09:11:37.040 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.040 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.040 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 991643
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_952231] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 952231 
2023-11-16 09:11:37.040 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 991643
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 991643
2023-11-16 09:11:37.040 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.041 DEBUG 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 952231 
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 991643 
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.041 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.041 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [991643] 
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.041  INFO 1 --- [6_103387_952231] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 952231, Took : 0s
2023-11-16 09:11:37.041  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 22 
2023-11-16 09:11:37.041  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 22, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 22
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868203
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.041 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.042 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.042 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.042 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1039623
2023-11-16 09:11:37.042 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.042 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 825380
2023-11-16 09:11:37.042 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.042 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1039623
2023-11-16 09:11:37.042  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1039623
2023-11-16 09:11:37.042 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 825380
2023-11-16 09:11:37.042  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1039623 
2023-11-16 09:11:37.042  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 825380
2023-11-16 09:11:37.042 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.042  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 825380 
2023-11-16 09:11:37.042 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1039623] 
2023-11-16 09:11:37.042 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.042 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.042 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [825380] 
2023-11-16 09:11:37.043 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.043 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 19 -- Resulted rows -- [1]
2023-11-16 09:11:37.043 DEBUG 1 --- [6_103387_991643] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.043 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.044 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 19 : null : null : 19868202 : Update published
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 991643 
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 991643 
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_991643] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 991643, Took : 0s
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 979716 
2023-11-16 09:11:37.044  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 979716, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 979716
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868204
2023-11-16 09:11:37.044 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_825380] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.045 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 22 -- Resulted rows -- [1]
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 825380 
2023-11-16 09:11:37.045 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.045 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.045 DEBUG 1 --- [_103387_1039623] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 825380 
2023-11-16 09:11:37.045 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 22 : null : null : 19868203 : Update published
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.045 DEBUG 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1039623 
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.045 DEBUG 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1039623 
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_825380] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 825380, Took : 0s
2023-11-16 09:11:37.045  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.045  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158346 
2023-11-16 09:11:37.045  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.045  INFO 1 --- [_103387_1039623] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1039623, Took : 0s
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158346, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158311 
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.045  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158346
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158311, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.045 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158311
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868205
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868207
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.046 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 19
2023-11-16 09:11:37.046 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.046 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 19
2023-11-16 09:11:37.046  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 19
2023-11-16 09:11:37.046  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 19 
2023-11-16 09:11:37.046 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.046 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [19] 
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.046 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.047 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.048 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 22
2023-11-16 09:11:37.048 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 979716 -- Resulted rows -- [1]
2023-11-16 09:11:37.048 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.048 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.048 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 22
2023-11-16 09:11:37.048 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 979716 : null : null : 19868204 : Update published
2023-11-16 09:11:37.048  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 22
2023-11-16 09:11:37.048  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 22 
2023-11-16 09:11:37.048 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.048 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [22] 
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158346 -- Resulted rows -- [1]
2023-11-16 09:11:37.049 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.049 DEBUG 1 --- [99446_103387_19] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158311 -- Resulted rows -- [1]
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.049 DEBUG 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 19 
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158346 : null : null : 19868205 : Update published
2023-11-16 09:11:37.049 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158311 : null : null : 19868207 : Update published
2023-11-16 09:11:37.049 DEBUG 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 19 
2023-11-16 09:11:37.049  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.049  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.049  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.050  INFO 1 --- [99446_103387_19] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 19, Took : 0s
2023-11-16 09:11:37.050  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 159421 
2023-11-16 09:11:37.050  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 159421, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 159421
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868206
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.050 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.051 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.051 DEBUG 1 --- [99446_103387_22] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 979716
2023-11-16 09:11:37.051 DEBUG 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 22 
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 979716
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.051 DEBUG 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 22 
2023-11-16 09:11:37.051  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 979716
2023-11-16 09:11:37.051  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 979716 
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [979716] 
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.051  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.051  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.051  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.051  INFO 1 --- [99446_103387_22] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 22, Took : 0s
2023-11-16 09:11:37.051  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158845 
2023-11-16 09:11:37.051  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158845, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.051 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158845
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868208
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158346
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158311
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158346
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158311
2023-11-16 09:11:37.052  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158346
2023-11-16 09:11:37.052  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158346 
2023-11-16 09:11:37.052  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158311
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.052  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158311 
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158346] 
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158311] 
2023-11-16 09:11:37.052 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 159421 -- Resulted rows -- [1]
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_979716] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 159421 : null : null : 19868206 : Update published
2023-11-16 09:11:37.053 DEBUG 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 979716 
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 979716 
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_979716] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 979716, Took : 0s
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158115 
2023-11-16 09:11:37.054  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158115, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158115
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868209
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.054 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158311] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158346] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158311 
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158346 
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158311 
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158346 
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158311] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158311, Took : 0s
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.055  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1188301 
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_158346] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158346, Took : 0s
2023-11-16 09:11:37.055  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 184508 
2023-11-16 09:11:37.055 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1188301, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.055  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.055 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 184508, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.055 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1188301
2023-11-16 09:11:37.055 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 184508
2023-11-16 09:11:37.056 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868210
2023-11-16 09:11:37.056 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868211
2023-11-16 09:11:37.056 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.056 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 159421
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158845 -- Resulted rows -- [1]
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.056 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 159421
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158845 : null : null : 19868208 : Update published
2023-11-16 09:11:37.056 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.056  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 159421
2023-11-16 09:11:37.056  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 159421 
2023-11-16 09:11:37.057 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.057 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [159421] 
2023-11-16 09:11:37.057 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.057 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.058 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158115 -- Resulted rows -- [1]
2023-11-16 09:11:37.058 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.058 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158115 : null : null : 19868209 : Update published
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_159421] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 184508 -- Resulted rows -- [1]
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 159421 
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158845
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 184508 : null : null : 19868211 : Update published
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 159421 
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158845
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158845
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158845 
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_159421] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 159421, Took : 0s
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.059 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158845] 
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158377 
2023-11-16 09:11:37.059  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158377, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158377
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868212
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158115
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.060 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.060 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1188301 -- Resulted rows -- [1]
2023-11-16 09:11:37.061 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158115
2023-11-16 09:11:37.061 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 3ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.061  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158115
2023-11-16 09:11:37.061 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1188301 : null : null : 19868210 : Update published
2023-11-16 09:11:37.061  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158115 
2023-11-16 09:11:37.061 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.061 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158115] 
2023-11-16 09:11:37.061 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.061 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 184508
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_158845] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 184508
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158845 
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 184508
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 184508 
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158845 
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [184508] 
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158845] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158845, Took : 0s
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158117] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 158117 
2023-11-16 09:11:37.062  INFO 1 --- [6_103387_158117] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.062 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 158117, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 158117
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868213
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.063 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 1188301
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158115] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.063 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158377 -- Resulted rows -- [1]
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158115 
2023-11-16 09:11:37.063 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 1188301
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.063  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 1188301
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158115 
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.063  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 1188301 
2023-11-16 09:11:37.063 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158377 : null : null : 19868212 : Update published
2023-11-16 09:11:37.063 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.063  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.064 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [1188301] 
2023-11-16 09:11:37.064  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.064  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.064  INFO 1 --- [6_103387_158115] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158115, Took : 0s
2023-11-16 09:11:37.064  INFO 1 --- [6_103387_958345] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 958345 
2023-11-16 09:11:37.064  INFO 1 --- [6_103387_958345] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 958345, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 958345
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868214
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.064 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_184508] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 184508 
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 184508 
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_184508] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 184508, Took : 0s
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_127468] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 127468 
2023-11-16 09:11:37.065  INFO 1 --- [6_103387_127468] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 127468, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.065 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 127468
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868217
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.066 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.066 DEBUG 1 --- [_103387_1188301] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 2ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.066 DEBUG 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 1188301 
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.066 DEBUG 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 1188301 
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 158117 -- Resulted rows -- [1]
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 158117 : null : null : 19868213 : Update published
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1188301] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 1188301, Took : 0s
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1122802] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:291]: Replicating tables for customer with tenant_id : 1122802 
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.067  INFO 1 --- [_103387_1122802] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:328]: Before replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:271]: Writing into 'event_shareable' -- for tenant_id : 1122802, isWhatIf : false, isALert : true, hasSites : true, isupdate : true
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:290]: For updated events : ID : null and EventDetID : 99446 
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1824]: checking event exist with params : eventDetailId : 99446, tenantId : 1122802
2023-11-16 09:11:37.066 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158377
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 3ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158377
2023-11-16 09:11:37.067  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158377
2023-11-16 09:11:37.067  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158377 
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.067 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158377] 
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1832]: Resulted event_id : 19868215
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [checkEventExist:1834]: Time taken : 0ms : for query : select id from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.067 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:294]: For updated - Event Already Exists : Event_Shareable ID : null and Event_Details ID : 99446 
2023-11-16 09:11:37.068 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1852]: fetching is_alert value for event params : 99446
2023-11-16 09:11:37.068 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [getIsAlertFromEvent:1859]: Time taken : 0ms : for query : select is_alert from event_shareable where event_details_id = ? and tenant_id = ? and is_deleted = false
2023-11-16 09:11:37.068 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 958345 -- Resulted rows -- [1]
2023-11-16 09:11:37.068 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.068 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 958345 : null : null : 19868214 : Update published
2023-11-16 09:11:37.068 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2085]: flag values : hasNoSites: true, eventShareable.isSendPartnerImpactNotification: false, eventShareable.getAffectedRegion(): SRID=4326;MULTIPOLYGON(((35.14575672140135 30.23268504820912,35.145313748560596 30.228150195020174,35.15590507125859 30.108153141699137,35.111593490600626 30.01522742837303,35.07927526092533 29.948178397376356,35.09058196640017 29.895589867896494,35.0413036785126 29.80972401131604,35.01941111660004 29.735764264942826,35.01601793622972 29.69578163051015,35.02256109213829 29.66981830962408,35.01759292399885 29.640125202221345,34.98214985555412 29.59184425428932,34.9796657714844 29.54115068785875,34.906671875000015 29.497057891553712,34.86674169921876 29.57896344225215,34.66587170410154 30.21842975823892,34.5603630552212 30.421114922909144,34.552153320312506 30.4246665868378,34.555278969126476 30.430881599274002,34.55445037841795 30.432473345978984,34.44852221679686 30.75468390210463,34.17074792480468 31.447438402304034,34.370878906250006 32.19091030751971,34.99962950643395 32.951962770449384,35.046538085937506 33.04684529329276,35.084282485863056 33.05442845154776,35.117949218750006 33.09517934701396,35.28171417236329 33.105245599042895,35.39604064941407 33.073892619033366,35.48736450195313 33.09863076330063,35.505217285156256 33.1204865857114,35.55153561767386 33.25919983124088,35.550830871582015 33.26390651793022,35.55309965532087 33.26388378090734,35.557402343750006 33.27676938891753,35.733183593750006 33.33186138255204,35.826767333984364 33.35356620563527,35.87640576171872 33.23753898180406,35.88779199218748 33.00502227010063,35.850793014526374 32.860677493124925,35.83641339874267 32.819582686512774,35.750622650146475 32.74151328661612,35.61070672607418 32.66008182023258,35.57378762817379 32.61906926131642,35.58081384277341 32.54099935382164,35.567240692138654 32.52888318224268,35.57144044494629 32.492713316486395,35.57014703369139 32.41016572553072,35.58145288085938 32.32557256073629,35.54427880859373 32.05161494826221,35.55379663085938 31.720780495925638,35.44905938720701 31.239513227076134,35.443199096679685 30.99152049901693,35.387900329589854 30.92212006007925,35.331503616333 30.79983469791822,35.231161590576185 30.613592893665928,35.18547671890264 30.431195135364366,35.178243995666556 30.338574285008672,35.14575672140135 30.23268504820912))), eventShareable.getSelectionTypes(): nulleventShareable.getSeverity(): High
2023-11-16 09:11:37.071 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 1122802 -- Resulted rows -- [1]
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 958345
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2231]: updateEventShareable -- ended with result as : 1
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1908]: Done inserting records into 'event_timeline' -- for Customer tenant_id -- 158117
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2130]: Done -- updating records into 'event_shareable' -- for Customer tenant_id -- 127468 -- Resulted rows -- [1]
2023-11-16 09:11:37.071 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 2ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 2ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158377] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2234]: Time taken : 3ms : for query : update event_shareable set event_replication_status = ?, event_replication_metadata = ?::jsonb where event_details_id = ? and tenant_id in (%s)
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1911]: Time taken : 4ms : for query : INSERT INTO EVENT_TIMELINE(event_id, previous_value, new_value, operation, record_name, record_id, record_table_name, updated_by_tenant, created_by_id, last_modified_by_id, tenant_id) values ( ?::BIGINT, ?::text, ?::text, ?:: text, ?::text, ?::BIGINT, ?::text, ?::text, ?::bigint, ?::bigint, ?::bigint)
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareableForCustomer:2133]: Time taken : 4ms : for query : update event_shareable set     is_alert = ?, is_deleted = false  where id = ? and tenant_id = ?
2023-11-16 09:11:37.071 DEBUG 1 --- [_103387_1122802] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 1122802 : null : null : 19868215 : Update published
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 958345
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1837]: Dropping Spark Views & Datasets for tenant_id : 158377 
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [writeToEventShareable:342]: Done Writing into 'event_shareable' -- for tenant_id -- 158117
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_127468] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [insertIntoEventTimeline:1874]: inserting records into 'event_timeline' -- for Customer tenant_id -- 127468 : null : null : 19868217 : Update published
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_958345] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 958345
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158117] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:357]: Done replicating event_shareable for tenant_id : 158117
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:286] : [dropSparkViews:1853]: Done : Dropping Spark Views & Datasets for tenant_id : 158377 
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_958345] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 958345 
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicateEventPerCustomer:339]: After replicationProcess() with details : isUpdateAlert : true, isAlert : false, eventShareable.hasNoSites() : true, CollectionUtils.isEmpty(eventShareable.getAffectedSites()): true, CollectionUtils.isEmpty(eventShareable.getSharedSitesButSubtier()) : true 
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158117] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [replicationProcess:414]: Site details not exists for tenant_id : 158117 
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:444]: Done fetch pending partners: []
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2201]: updateEventShareable -- input params :: status : 4, metaData : null
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_958345] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [958345] 
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [notificationProcess:446]: Checking for new condtion pending partners: false
2023-11-16 09:11:37.071 DEBUG 1 --- [6_103387_158117] c.r.s.s.helper.EventReplicationHelper    [handleLogs:286] : [updateEventShareable:2204]: updateEventShareable -- query params :: eventId : 99446, tenantIds : [158117] 
2023-11-16 09:11:37.071  INFO 1 --- [6_103387_158377] .EventReplicationServiceWithoutBroadcast [handleLogs:291] : [lambda$createParallelStreamOfCustomers$3:300]: Done Replicating tables for customer with tenant_id : 158377, Took : 0s
